import{a as t,p as e,N as Z,O as J,w as W,s as X,t as Y,L as Q,S as K,v as ee,x as te}from"./chunk-NL6KNZEE-BTkWJe7M.js";import{A as oe}from"./App.const-DNoFr9tQ.js";import{B as f,r as ae,i as ne,d as se,D as ie,C as re,S as ce,a as le,g as de,c as N,b as me,l as ue,e as he,I as H,f as O,h as R,E as j,P as ge,j as fe,k as pe,m as xe,n as M,u as z,o as _e,s as Ee}from"./useLoadingPersistStorages-DZq79gEa.js";import{u as Ce,a as Se,M as ve,F as we,b as q,c as w,d as Te,A as Le}from"./shallow-_7vdqvc-.js";import{M as k}from"./ModalNotification-DjXV99oI.js";import{u as Ne}from"./useLocalStorage-C3FLdLLg.js";import"./middleware-XeL71aNN.js";import"./index-D_ImYj8K.js";const je="_Container_utafb_1",De="_ActionButtons_utafb_8",y={Container:je,ActionButtons:De},Ae=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...a},t.createElement("path",{d:"M8 16h8v2H8zm0-4h8v2H8zm6-10H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"})),be=t.memo(Ae),Me=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...a},t.createElement("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zm-1-4-1.41-1.41L13 12.17V4h-2v8.17L8.41 9.59 7 11l5 5 5-5z"})),Ie=t.memo(Me),ke=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",...a},t.createElement("path",{d:"M690-240h190v80H610l80-80Zm-500 80-85-85q-23-23-23.5-57t22.5-58l440-456q23-24 56.5-24t56.5 23l199 199q23 23 23 57t-23 57L520-160H190Zm296-80 314-322-198-198-442 456 64 64h262Zm-6-240Z"})),ye=t.memo(ke),Be=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...a},t.createElement("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11 8 15.01z"})),Fe=t.memo(Be),Pe="_ModalFormBody_97h2b_1",He="_Content_97h2b_10",Oe="_InfoMessageContainer_97h2b_18",Re="_InfoMessageText_97h2b_28",ze="_ErrorMessageContainer_97h2b_37",qe="_ErrorMessageText_97h2b_47",Ve="_ActionButtons_97h2b_56",Ge="_ActionButtonsGroup_97h2b_62",E={ModalFormBody:Pe,Content:He,InfoMessageContainer:Oe,InfoMessageText:Re,ErrorMessageContainer:ze,ErrorMessageText:qe,ActionButtons:Ve,ActionButtonsGroup:Ge};function $e({title:a,informationMessage:o,formFields:n,showResetButton:s=!1,resetButtonLabel:r,validateFormData:d,onCancel:c,cancelButtonLabel:g,submitButtonLabel:m,onSubmit:l}){const i=t.useRef(null);Ce(i,n);const{handleSubmit:u,formValidationErrorMessage:p}=Se({formRef:i,onSubmit:l,formFields:n,validateFormData:d}),_=t.useCallback(()=>{c()},[c]);return e.jsx(ve,{title:a,onHide:_,children:e.jsxs("form",{ref:i,className:E.ModalFormBody,onSubmit:u,children:[e.jsxs("div",{className:E.Content,children:[o&&e.jsx("div",{className:E.InfoMessageContainer,children:e.jsx("div",{className:E.InfoMessageText,children:typeof o=="function"?o():o})}),e.jsx(we,{formFields:n}),p&&e.jsx("div",{className:E.ErrorMessageContainer,role:"alert",children:e.jsx("div",{className:E.ErrorMessageText,children:typeof p=="function"?p():p})})]}),e.jsxs("div",{className:E.ActionButtons,children:[e.jsx(f,{onClick:c,children:g||"cancel"}),e.jsxs("div",{className:E.ActionButtonsGroup,children:[s&&e.jsx(f,{type:"reset",children:r||"reset form"}),e.jsx(f,{type:"submit",primary:!0,children:m||"upload"})]})]})]})})}const Ue=[{name:"storageDataJsonFile",type:"file",required:!0,label:"file",accept:ce}],Ze=({onHide:a,onSuccessImport:o})=>{const n=t.useCallback(()=>{typeof a=="function"&&a()},[a]),s=t.useCallback(async({storageDataJsonFile:c})=>{const g=await ae(c),m=await ne(g);if(m)return m;n(),typeof o=="function"&&o()},[n,o]),r=t.useCallback(({storageDataJsonFile:c})=>{if(!se(c,le))return function(){return e.jsxs(e.Fragment,{children:["File should has"," ",e.jsxs("strong",{children:[".",ie]})," ","or"," ",e.jsxs("strong",{children:[".",re]})," ","file extension"]})}},[]),d=t.useCallback(()=>e.jsxs(e.Fragment,{children:["Warning.",e.jsx("br",{}),"Importing data will replace"," ",e.jsx("strong",{children:"all existing data"})," ","in the storage (indexedBD)"]}),[]);return e.jsx($e,{title:"Importing storage data",informationMessage:d,formFields:Ue,validateFormData:r,onCancel:n,onSubmit:s,submitButtonLabel:"import"})},Je=t.memo(function({onHide:o,onConfirm:n}){const s=t.useMemo(()=>e.jsxs(e.Fragment,{children:["Are you sure you want"," ",e.jsx("strong",{children:"to clear data storage"}),"?",e.jsx("br",{}),"All data will be deleted"]}),[]);return e.jsx(q,{title:s,onHide:o,onConfirm:n,confirmButtonLabel:"clear storage"})}),We=t.memo(function({onHide:o,onConfirm:n}){const s=t.useMemo(()=>e.jsxs(e.Fragment,{children:["Are you sure you want"," ",e.jsx("strong",{children:"to load demo data"}),"?",e.jsx("br",{}),"All existing data will be exported into a file"]}),[]);return e.jsx(q,{title:s,onHide:o,onConfirm:n,confirmButtonLabel:"load demo data"})}),B=5*1e3,D=5*1e3;async function F(){const a=await he(R,O,H);if(a)return N({entityType:j,messages:[()=>e.jsx(e.Fragment,{children:a})],hideTimeout:D,tags:["storage-data-cleanup-failure"],type:"error",title:"Data storage cleanup"}),a}const Xe=t.memo(function(){const{isVisible:o,show:n,hide:s}=w(!1),{isVisible:r,show:d,hide:c}=w(!1),{isVisible:g,show:m,hide:l}=w(!1),{isVisible:i,show:u}=w(!1),p=t.useCallback(function(){window.location.reload()},[]),{isVisible:_,show:T}=w(!1),S=t.useCallback(async function(){const C=await F();if(C)return C;c(),s(),u()},[c,s,u]),A=t.useCallback(async function(){const C=new Date().getTime(),{error:v,indexDBState:I}=await de(R,O,H);if(v)return N({entityType:j,messages:[()=>e.jsx(e.Fragment,{children:v})],hideTimeout:D,tags:["storage-data-export"],type:"error",title:"Export storage data"}),!0;if(!I)return N({entityType:j,messages:[()=>e.jsx(e.Fragment,{children:"Nothing to export"})],hideTimeout:D,tags:["storage-data-export"],type:"info",title:"Export storage data"}),!0;if(await me(I))return!0;N({entityType:j,messages:[()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Storage data was exported into file."}),e.jsxs("div",{children:["Storage data dump was created at"," ",new Date(C).toLocaleString()]})]})],hideTimeout:D,tags:["storage-data-export"],type:"success",title:"Export storage data"})},[]),U=t.useCallback(async function(){await A()||await F()||await ue()},[A]);return t.useEffect(function(){if(!_)return;const C=window.setTimeout(function(){window.location.reload()},B);return function(){window.clearTimeout(C)}},[_]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:y.Container,children:e.jsxs("div",{className:y.ActionButtons,children:[e.jsx(f,{size:"small",noPadding:!0,transparent:!0,onClick:d,title:"clear storage",children:e.jsx(ye,{})}),e.jsx(f,{size:"small",noPadding:!0,transparent:!0,onClick:n,title:"import",children:e.jsx(Fe,{})}),e.jsx(f,{size:"small",noPadding:!0,transparent:!0,onClick:A,title:"export",children:e.jsx(Ie,{})}),e.jsxs(f,{size:"small",noPadding:!0,transparent:!0,onClick:m,title:"load demo data",children:[e.jsx(be,{}),e.jsx("span",{children:"load demo data"})]})]})}),o&&e.jsx(Ze,{onHide:s,onSuccessImport:T}),r&&e.jsx(Je,{onHide:c,onConfirm:S}),g&&e.jsx(We,{onHide:l,onConfirm:U}),i&&e.jsx(k,{title:"storage data was successfully deleted",onHide:p,okButtonLabel:"reload page"}),_&&e.jsx(k,{title:"storage data was successfully imported from file",children:e.jsxs("div",{style:{textAlign:"center",maxHeight:"90%",overflow:"auto"},children:["Page will reload automatically in"," ",Math.ceil(B/1e3)," ","seconds",e.jsx("br",{}),"to use imported storage data"]})})]})}),Ye=[{slug:"/trader/",text:"market"},{slug:`/trader/${ge}`,text:"locations"},{slug:`/trader/${fe}`,text:"map"},{slug:`/trader/${pe}`,text:"products"},{slug:`/trader/${xe}`,text:"moving objects"}],Qe="_Navbar_1loan_1",Ke="_HeaderContainer_1loan_13",et="_Logo_1loan_19",tt="_LinksList_1loan_24",ot="_LinkListItem_1loan_33",at="_NavLink_1loan_37",nt="_Pending_1loan_55",st="_Active_1loan_59",x={Navbar:Qe,HeaderContainer:Ke,Logo:et,LinksList:tt,LinkListItem:ot,NavLink:at,Pending:nt,Active:st};function it(){var a,o,n,s;if(window!=null&&window.matchMedia){if((o=(a=window.matchMedia)==null?void 0:a.call(window,"(prefers-color-scheme: dark)"))!=null&&o.matches)return"dark";if((s=(n=window.matchMedia)==null?void 0:n.call(window,"(prefers-color-scheme: light)"))!=null&&s.matches)return"light"}}const rt=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...a},t.createElement("path",{d:"M9.37 5.51A7.35 7.35 0 0 0 9.1 7.5c0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27A7.014 7.014 0 0 1 12 19c-3.86 0-7-3.14-7-7 0-2.93 1.81-5.45 4.37-6.49zM12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})),ct=t.memo(rt),lt=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...a},t.createElement("path",{d:"M12 9c1.65 0 3 1.35 3 3s-1.35 3-3 3-3-1.35-3-3 1.35-3 3-3m0-2c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 0 0-1.41 0 .996.996 0 0 0 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 0 0-1.41 0 .996.996 0 0 0 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 0 0 0-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 0 0 0-1.41.996.996 0 0 0-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 0 0 0-1.41.996.996 0 0 0-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})),dt=t.memo(lt),mt=a=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",...a},t.createElement("path",{d:"M396-396q-32-32-58.5-67T289-537q-5 14-6.5 28.5T281-480q0 83 58 141t141 58q14 0 28.5-2t28.5-6q-39-22-74-48.5T396-396Zm57-56q51 51 114 87.5T702-308q-40 51-98 79.5T481-200q-117 0-198.5-81.5T201-480q0-65 28.5-123t79.5-98q20 72 56.5 135T453-452Zm290 72q-20-5-39.5-11T665-405q8-18 11.5-36.5T680-480q0-83-58.5-141.5T480-680q-20 0-38.5 3.5T405-665q-8-19-13.5-38T381-742q24-9 49-13.5t51-4.5q117 0 198.5 81.5T761-480q0 26-4.5 51T743-380ZM440-840v-120h80v120h-80Zm0 840v-120h80V0h-80Zm323-706-57-57 85-84 57 56-85 85ZM169-113l-57-56 85-85 57 57-85 84Zm671-327v-80h120v80H840ZM0-440v-80h120v80H0Zm791 328-85-85 57-57 84 85-56 57ZM197-706l-84-85 56-57 85 85-57 57Zm199 310Z"})),ut=t.memo(mt),V="dark",b="ColorThemeDark",P="ColorThemeLight",ht=t.memo(function(){const[o,n]=t.useState(void 0),[s,r]=Ne("prefered-color-scheme",void 0),d=t.useCallback(function(){r("dark")},[r]),c=t.useCallback(function(){r("light")},[r]),g=t.useCallback(function(){r(void 0)},[r]);return t.useEffect(function(){const l=s||o||V;return l==="dark"?window.document.body.classList.add(b):l==="light"&&window.document.body.classList.add(P),function(){window.document.body.classList.remove(b,P)}},[o,s]),t.useEffect(function(){var _,T;if(!window.matchMedia)return;const l=(_=window==null?void 0:window.matchMedia)==null?void 0:_.call(window,"(prefers-color-scheme: dark)");function i(S){if(S.matches){n("dark");return}}const u=(T=window==null?void 0:window.matchMedia)==null?void 0:T.call(window,"(prefers-color-scheme: light)");function p(S){if(S.matches){n("light");return}}return l.addEventListener("change",i),u.addEventListener("change",p),function(){l.removeEventListener("change",i),u.removeEventListener("change",p)}},[n]),t.useEffect(function(){const l=it();n(l)},[n]),e.jsxs(e.Fragment,{children:[!s&&e.jsx(f,{title:"switch to dark theme",onClick:d,size:"small",transparent:!0,noPadding:!0,noBorder:!0,children:e.jsx(ut,{})}),s==="dark"&&e.jsx(f,{title:"switch to light theme",onClick:c,size:"small",transparent:!0,noPadding:!0,noBorder:!0,children:e.jsx(ct,{})}),s==="light"&&e.jsx(f,{title:"switch to system color scheme",onClick:g,size:"small",transparent:!0,noPadding:!0,noBorder:!0,children:e.jsx(dt,{})})]})}),gt=t.memo(function({link:o}){const n=({isActive:s,isPending:r,isTransitioning:d})=>M([x.NavLink,r&&x.Pending,s&&x.Active,d&&x.Transitioning]);return e.jsx("li",{className:x.LinkListItem,children:e.jsx(Z,{to:o.slug,className:n,children:o.text})})}),ft=t.memo(function({pageLinks:o}){return e.jsx("ul",{className:x.LinksList,children:o.map(n=>e.jsx(gt,{link:n},n.slug))})}),pt=t.memo(function(){return e.jsxs("nav",{className:x.Navbar,children:[e.jsxs("div",{className:x.HeaderContainer,children:[e.jsx("div",{className:x.Logo,children:oe}),e.jsx(Xe,{}),e.jsx(ht,{})]}),e.jsx(ft,{pageLinks:Ye})]})}),xt="_NotificationContainer_1dr5s_1",_t={NotificationContainer:xt},Et="_Notification_btia2_25",Ct="_InDisapperState_btia2_41",St="_AnimationSmoothDisappear_btia2_1",vt="_NotificationContent_btia2_45",wt="_NotificationSuccess_btia2_66",Tt="_NotificationFailure_btia2_67",Lt="_NotificationWarning_btia2_85",Nt="_TimeoutProgressBar_btia2_94",jt="_NotificationTitle_btia2_114",Dt="_MessageList_btia2_119",At="_MessageListItem_btia2_126",h={Notification:Et,InDisapperState:Ct,AnimationSmoothDisappear:St,NotificationContent:vt,NotificationSuccess:wt,NotificationFailure:Tt,NotificationWarning:Lt,TimeoutProgressBar:Nt,NotificationTitle:jt,MessageList:Dt,MessageListItem:At};function bt(a){return!(typeof a!="number"||!Number.isFinite(a)||a<=0)}const Mt=t.memo(function({notification:o}){var l;const{type:n,hideTimeout:s}=o,[r,d]=t.useState(!1),c=z(i=>i.delete),g=t.useCallback(function(){d(!0)},[d]),m=t.useCallback(function(u){u.type==="animationend"&&u.animationName===h.AnimationSmoothDisappear&&c(o)},[o,c]);return e.jsxs("div",{className:M([h.Notification,n==="success"&&h.NotificationSuccess,n==="error"&&h.NotificationFailure,n==="warning"&&h.NotificationWarning,n==="info"&&h.NotificationInfo,r&&h.InDisapperState]),onAnimationEnd:m,role:n==="error"?"alert":"log",children:[bt(s)&&e.jsx("div",{className:h.TimeoutProgressBar,style:{animationDuration:`${s}ms`},onAnimationEnd:g}),e.jsxs("div",{className:h.NotificationContent,children:[!!o.title&&e.jsx("div",{className:h.NotificationTitle,children:o.title}),!!o.messages.length&&e.jsx("div",{className:h.MessageList,children:((l=o.messages)==null?void 0:l.length)&&o.messages.map((i,u)=>e.jsx("div",{className:h.MessageListItem,children:typeof i=="function"?i():i},u))})]})]})}),It=t.memo(function(){const o=z(Te(n=>n.items()));return e.jsx("div",{className:_t.NotificationContainer,children:o.map(n=>e.jsx(Mt,{notification:n},n.uuid))})});function G(){return e.jsxs(e.Fragment,{children:[e.jsx(pt,{}),e.jsx(J,{}),e.jsx(It,{})]})}const Gt=W(function({loaderData:o}){return e.jsxs("main",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",gap:"1em"},children:[e.jsx("div",{children:"Loading app..."}),e.jsxs("div",{children:["Loading version"," ",o.version,"..."]})]})}),$t=()=>[{rel:"manifest",href:"/trader/manifest.json"},{rel:"icon",type:"image/svg+xml",href:"/trader/favicon.svg"}];function Ut({children:a}){const o=M([b,V==="light"]);return e.jsxs("html",{lang:"en",children:[e.jsxs("head",{children:[e.jsx("meta",{charSet:"utf-8"}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),e.jsx("meta",{name:"theme-color",content:"#eee"}),e.jsx(Q,{})]}),e.jsxs("body",{className:o,children:[e.jsx("noscript",{children:"You need to enable JavaScript to run this app."}),e.jsx("div",{id:Le,children:a}),e.jsx(K,{}),e.jsx(ee,{})]})]})}function kt(){return e.jsx(G,{})}function yt(){return _e(Ee),e.jsx(G,{})}let $=kt;$=yt;const Zt=X($),Jt=Y(function({error:o}){let n="Error",s="An unexpected error occured";return te(o)&&(n=o.status===404?"404":"Unknown status error",s=o.status===404?"the requested page could not be found":o.statusText||"An unexpected error occured"),e.jsxs("main",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",gap:"1em"},children:[e.jsx("h1",{style:{margin:"0"},children:n}),e.jsx("p",{style:{margin:"0"},children:s}),!1]})});export{Jt as ErrorBoundary,Gt as HydrateFallback,Ut as Layout,Zt as default,$t as links};
