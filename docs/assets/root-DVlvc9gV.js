import{a as t,p as e,N as Z,O as $,w as J,s as W,t as X,L as Y,S as Q,v as K,x as ee}from"./chunk-NL6KNZEE-BTkWJe7M.js";import{A as te}from"./App.const-DTwjj9QA.js";import{B as f,r as oe,i as ne,d as ae,D as se,C as ie,S as re,a as ce,g as le,c as j,b as de,l as me,e as ue,I as H,f as O,E as N,P as he,h as ge,j as fe,k as pe,m as M,u as R,n as xe,s as _e}from"./useLoadingPersistStorages-DU9v21yU.js";import{u as Ee,a as Ce,M as Se,F as ve,b as z,c as w,d as we,A as Le}from"./shallow-z8fWIb1M.js";import{M as k}from"./ModalNotification-DEcZS6Ad.js";import{u as Te}from"./useLocalStorage-C3FLdLLg.js";import"./middleware-XeL71aNN.js";import"./index-D_ImYj8K.js";const je="_Container_utafb_1",Ne="_ActionButtons_utafb_8",y={Container:je,ActionButtons:Ne},be=n=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},t.createElement("path",{d:"M8 16h8v2H8zm0-4h8v2H8zm6-10H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"})),Ae=t.memo(be),De=n=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},t.createElement("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zm-1-4-1.41-1.41L13 12.17V4h-2v8.17L8.41 9.59 7 11l5 5 5-5z"})),Me=t.memo(De),Ie=n=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",...n},t.createElement("path",{d:"M690-240h190v80H610l80-80Zm-500 80-85-85q-23-23-23.5-57t22.5-58l440-456q23-24 56.5-24t56.5 23l199 199q23 23 23 57t-23 57L520-160H190Zm296-80 314-322-198-198-442 456 64 64h262Zm-6-240Z"})),ke=t.memo(Ie),ye=n=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},t.createElement("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11 8 15.01z"})),Fe=t.memo(ye),Be="_ModalFormBody_97h2b_1",Pe="_Content_97h2b_10",He="_InfoMessageContainer_97h2b_18",Oe="_InfoMessageText_97h2b_28",Re="_ErrorMessageContainer_97h2b_37",ze="_ErrorMessageText_97h2b_47",qe="_ActionButtons_97h2b_56",Ve="_ActionButtonsGroup_97h2b_62",E={ModalFormBody:Be,Content:Pe,InfoMessageContainer:He,InfoMessageText:Oe,ErrorMessageContainer:Re,ErrorMessageText:ze,ActionButtons:qe,ActionButtonsGroup:Ve};function Ge({title:n,informationMessage:o,formFields:a,showResetButton:s=!1,resetButtonLabel:c,validateFormData:d,onCancel:l,cancelButtonLabel:h,submitButtonLabel:g,onSubmit:i}){const r=t.useRef(null);Ee(r,a);const{handleSubmit:m,formValidationErrorMessage:p}=Ce({formRef:r,onSubmit:i,formFields:a,validateFormData:d}),_=t.useCallback(()=>{l()},[l]);return e.jsx(Se,{title:n,onHide:_,children:e.jsxs("form",{ref:r,className:E.ModalFormBody,onSubmit:m,children:[e.jsxs("div",{className:E.Content,children:[o&&e.jsx("div",{className:E.InfoMessageContainer,children:e.jsx("div",{className:E.InfoMessageText,children:typeof o=="function"?o():o})}),e.jsx(ve,{formFields:a}),p&&e.jsx("div",{className:E.ErrorMessageContainer,role:"alert",children:e.jsx("div",{className:E.ErrorMessageText,children:typeof p=="function"?p():p})})]}),e.jsxs("div",{className:E.ActionButtons,children:[e.jsx(f,{onClick:l,children:h||"cancel"}),e.jsxs("div",{className:E.ActionButtonsGroup,children:[s&&e.jsx(f,{type:"reset",children:c||"reset form"}),e.jsx(f,{type:"submit",primary:!0,children:g||"upload"})]})]})]})})}const Ue=[{name:"storageDataJsonFile",type:"file",required:!0,label:"file",accept:re}],Ze=({onHide:n,onSuccessImport:o})=>{const a=t.useCallback(()=>{typeof n=="function"&&n()},[n]),s=t.useCallback(async({storageDataJsonFile:l})=>{const{jsonString:h,error:g}=await oe(l);if(!h)return g||"";const i=await ne(h);if(i)return i;a(),typeof o=="function"&&o()},[a,o]),c=t.useCallback(({storageDataJsonFile:l})=>{if(!ae(l,ce))return function(){return e.jsxs(e.Fragment,{children:["File should be in"," ",e.jsxs("strong",{children:[".",se]})," ","or"," ",e.jsxs("strong",{children:[".",ie]})," ","format"]})}},[]),d=t.useCallback(()=>e.jsxs(e.Fragment,{children:["Warning.",e.jsx("br",{}),"Importing data will replace"," ",e.jsx("strong",{children:"all existing data"})," ","in the storage (indexedBD)"]}),[]);return e.jsx(Ge,{title:"Importing storage data",informationMessage:d,formFields:Ue,validateFormData:c,onCancel:a,onSubmit:s,submitButtonLabel:"import"})},$e=t.memo(function({onHide:o,onConfirm:a}){const s=t.useMemo(()=>e.jsxs(e.Fragment,{children:["Are you sure you want"," ",e.jsx("strong",{children:"to clear data storage"}),"?",e.jsx("br",{}),"All data will be deleted"]}),[]);return e.jsx(z,{title:s,onHide:o,onConfirm:a,confirmButtonLabel:"clear storage"})}),Je=t.memo(function({onHide:o,onConfirm:a}){const s=t.useMemo(()=>e.jsxs(e.Fragment,{children:["Are you sure you want"," ",e.jsx("strong",{children:"to load demo data"}),"?",e.jsx("br",{}),"All existing data will be exported into a file"]}),[]);return e.jsx(z,{title:s,onHide:o,onConfirm:a,confirmButtonLabel:"load demo data"})}),F=5*1e3,b=5*1e3;async function B(){const n=await ue(O,H);if(n)return j({entityType:N,messages:[()=>e.jsx(e.Fragment,{children:n})],hideTimeout:b,tags:["storage-data-cleanup-failure"],type:"error",title:"Data storage cleanup"}),n}const We=t.memo(function(){const{isVisible:o,show:a,hide:s}=w(!1),{isVisible:c,show:d,hide:l}=w(!1),{isVisible:h,show:g,hide:i}=w(!1),{isVisible:r,show:m}=w(!1),p=t.useCallback(function(){window.location.reload()},[]),{isVisible:_,show:L}=w(!1),S=t.useCallback(async function(){const C=await B();if(C)return C;l(),s(),m()},[l,s,m]),A=t.useCallback(async function(){const C=new Date().getTime(),{error:v,indexDBState:I}=await le(O,H);if(v)return j({entityType:N,messages:[()=>e.jsx(e.Fragment,{children:v})],hideTimeout:b,tags:["storage-data-export"],type:"error",title:"Export storage data"}),!0;if(!I)return j({entityType:N,messages:[()=>e.jsx(e.Fragment,{children:"Nothing to export"})],hideTimeout:b,tags:["storage-data-export"],type:"info",title:"Export storage data"}),!0;if(await de(I))return!0;j({entityType:N,messages:[()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Storage data was exported into file."}),e.jsxs("div",{children:["Storage data dump was created at"," ",new Date(C).toLocaleString()]})]})],hideTimeout:b,tags:["storage-data-export"],type:"success",title:"Export storage data"})},[]),U=t.useCallback(async function(){await A()||await B()||await me()},[A]);return t.useEffect(function(){if(!_)return;const C=window.setTimeout(function(){window.location.reload()},F);return function(){window.clearTimeout(C)}},[_]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:y.Container,children:e.jsxs("div",{className:y.ActionButtons,children:[e.jsx(f,{size:"small",noPadding:!0,transparent:!0,onClick:d,title:"clear storage",children:e.jsx(ke,{})}),e.jsx(f,{size:"small",noPadding:!0,transparent:!0,onClick:a,title:"import",children:e.jsx(Fe,{})}),e.jsx(f,{size:"small",noPadding:!0,transparent:!0,onClick:A,title:"export",children:e.jsx(Me,{})}),e.jsxs(f,{size:"small",noPadding:!0,transparent:!0,onClick:g,title:"load demo data",children:[e.jsx(Ae,{}),e.jsx("span",{children:"load demo data"})]})]})}),o&&e.jsx(Ze,{onHide:s,onSuccessImport:L}),c&&e.jsx($e,{onHide:l,onConfirm:S}),h&&e.jsx(Je,{onHide:i,onConfirm:U}),r&&e.jsx(k,{title:"storage data was successfully deleted",onHide:p,okButtonLabel:"reload page"}),_&&e.jsx(k,{title:"storage data was successfully imported from file",children:e.jsxs("div",{style:{textAlign:"center",maxHeight:"90%",overflow:"auto"},children:["Page will reload automatically in"," ",Math.ceil(F/1e3)," ","seconds",e.jsx("br",{}),"to use imported storage data"]})})]})}),Xe=[{slug:"",text:"market"},{slug:`${he}`,text:"locations"},{slug:`${ge}`,text:"map"},{slug:`${fe}`,text:"products"},{slug:`${pe}`,text:"moving objects"}],Ye="_Navbar_1loan_1",Qe="_HeaderContainer_1loan_13",Ke="_Logo_1loan_19",et="_LinksList_1loan_24",tt="_LinkListItem_1loan_33",ot="_NavLink_1loan_37",nt="_Pending_1loan_55",at="_Active_1loan_59",x={Navbar:Ye,HeaderContainer:Qe,Logo:Ke,LinksList:et,LinkListItem:tt,NavLink:ot,Pending:nt,Active:at};function st(){var n,o,a,s;if(window!=null&&window.matchMedia){if((o=(n=window.matchMedia)==null?void 0:n.call(window,"(prefers-color-scheme: dark)"))!=null&&o.matches)return"dark";if((s=(a=window.matchMedia)==null?void 0:a.call(window,"(prefers-color-scheme: light)"))!=null&&s.matches)return"light"}}const it=n=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},t.createElement("path",{d:"M9.37 5.51A7.35 7.35 0 0 0 9.1 7.5c0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27A7.014 7.014 0 0 1 12 19c-3.86 0-7-3.14-7-7 0-2.93 1.81-5.45 4.37-6.49zM12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})),rt=t.memo(it),ct=n=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},t.createElement("path",{d:"M12 9c1.65 0 3 1.35 3 3s-1.35 3-3 3-3-1.35-3-3 1.35-3 3-3m0-2c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 0 0-1.41 0 .996.996 0 0 0 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 0 0-1.41 0 .996.996 0 0 0 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 0 0 0-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 0 0 0-1.41.996.996 0 0 0-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 0 0 0-1.41.996.996 0 0 0-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})),lt=t.memo(ct),dt=n=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",...n},t.createElement("path",{d:"M396-396q-32-32-58.5-67T289-537q-5 14-6.5 28.5T281-480q0 83 58 141t141 58q14 0 28.5-2t28.5-6q-39-22-74-48.5T396-396Zm57-56q51 51 114 87.5T702-308q-40 51-98 79.5T481-200q-117 0-198.5-81.5T201-480q0-65 28.5-123t79.5-98q20 72 56.5 135T453-452Zm290 72q-20-5-39.5-11T665-405q8-18 11.5-36.5T680-480q0-83-58.5-141.5T480-680q-20 0-38.5 3.5T405-665q-8-19-13.5-38T381-742q24-9 49-13.5t51-4.5q117 0 198.5 81.5T761-480q0 26-4.5 51T743-380ZM440-840v-120h80v120h-80Zm0 840v-120h80V0h-80Zm323-706-57-57 85-84 57 56-85 85ZM169-113l-57-56 85-85 57 57-85 84Zm671-327v-80h120v80H840ZM0-440v-80h120v80H0Zm791 328-85-85 57-57 84 85-56 57ZM197-706l-84-85 56-57 85 85-57 57Zm199 310Z"})),mt=t.memo(dt),q="dark",D="ColorThemeDark",P="ColorThemeLight",ut=t.memo(function(){const[o,a]=t.useState(void 0),[s,c]=Te("prefered-color-scheme",void 0),d=t.useCallback(function(){c("dark")},[c]),l=t.useCallback(function(){c("light")},[c]),h=t.useCallback(function(){c(void 0)},[c]);return t.useEffect(function(){const i=s||o||q;return i==="dark"?window.document.body.classList.add(D):i==="light"&&window.document.body.classList.add(P),function(){window.document.body.classList.remove(D,P)}},[o,s]),t.useEffect(function(){var _,L;if(!window.matchMedia)return;const i=(_=window==null?void 0:window.matchMedia)==null?void 0:_.call(window,"(prefers-color-scheme: dark)");function r(S){if(S.matches){a("dark");return}}const m=(L=window==null?void 0:window.matchMedia)==null?void 0:L.call(window,"(prefers-color-scheme: light)");function p(S){if(S.matches){a("light");return}}return i.addEventListener("change",r),m.addEventListener("change",p),function(){i.removeEventListener("change",r),m.removeEventListener("change",p)}},[a]),t.useEffect(function(){const i=st();a(i)},[a]),e.jsxs(e.Fragment,{children:[!s&&e.jsx(f,{title:"switch to dark theme",onClick:d,size:"small",transparent:!0,noPadding:!0,noBorder:!0,children:e.jsx(mt,{})}),s==="dark"&&e.jsx(f,{title:"switch to light theme",onClick:l,size:"small",transparent:!0,noPadding:!0,noBorder:!0,children:e.jsx(rt,{})}),s==="light"&&e.jsx(f,{title:"switch to system color scheme",onClick:h,size:"small",transparent:!0,noPadding:!0,noBorder:!0,children:e.jsx(lt,{})})]})}),ht=t.memo(function({link:o}){const a=({isActive:s,isPending:c,isTransitioning:d})=>M([x.NavLink,c&&x.Pending,s&&x.Active,d&&x.Transitioning]);return e.jsx("li",{className:x.LinkListItem,children:e.jsx(Z,{to:o.slug,className:a,children:o.text})})}),gt=t.memo(function({pageLinks:o}){return e.jsx("ul",{className:x.LinksList,children:o.map(a=>e.jsx(ht,{link:a},a.slug))})}),ft=t.memo(function(){return e.jsxs("nav",{className:x.Navbar,children:[e.jsxs("div",{className:x.HeaderContainer,children:[e.jsx("div",{className:x.Logo,children:te}),e.jsx(We,{}),e.jsx(ut,{})]}),e.jsx(gt,{pageLinks:Xe})]})}),pt="_NotificationContainer_1dr5s_1",xt={NotificationContainer:pt},_t="_Notification_btia2_25",Et="_InDisapperState_btia2_41",Ct="_AnimationSmoothDisappear_btia2_1",St="_NotificationContent_btia2_45",vt="_NotificationSuccess_btia2_66",wt="_NotificationFailure_btia2_67",Lt="_NotificationWarning_btia2_85",Tt="_TimeoutProgressBar_btia2_94",jt="_NotificationTitle_btia2_114",Nt="_MessageList_btia2_119",bt="_MessageListItem_btia2_126",u={Notification:_t,InDisapperState:Et,AnimationSmoothDisappear:Ct,NotificationContent:St,NotificationSuccess:vt,NotificationFailure:wt,NotificationWarning:Lt,TimeoutProgressBar:Tt,NotificationTitle:jt,MessageList:Nt,MessageListItem:bt};function At(n){return!(typeof n!="number"||!Number.isFinite(n)||n<=0)}const Dt=t.memo(function({notification:o}){var i;const{type:a,hideTimeout:s}=o,[c,d]=t.useState(!1),l=R(r=>r.delete),h=t.useCallback(function(){d(!0)},[d]),g=t.useCallback(function(m){m.type==="animationend"&&m.animationName===u.AnimationSmoothDisappear&&l(o)},[o,l]);return e.jsxs("div",{className:M([u.Notification,a==="success"&&u.NotificationSuccess,a==="error"&&u.NotificationFailure,a==="warning"&&u.NotificationWarning,a==="info"&&u.NotificationInfo,c&&u.InDisapperState]),onAnimationEnd:g,role:a==="error"?"alert":"log",children:[At(s)&&e.jsx("div",{className:u.TimeoutProgressBar,style:{animationDuration:`${s}ms`},onAnimationEnd:h}),e.jsxs("div",{className:u.NotificationContent,children:[!!o.title&&e.jsx("div",{className:u.NotificationTitle,children:o.title}),!!o.messages.length&&e.jsx("div",{className:u.MessageList,children:((i=o.messages)==null?void 0:i.length)&&o.messages.map((r,m)=>e.jsx("div",{className:u.MessageListItem,children:typeof r=="function"?r():r},m))})]})]})}),Mt=t.memo(function(){const o=R(we(a=>a.items()));return e.jsx("div",{className:xt.NotificationContainer,children:o.map(a=>e.jsx(Dt,{notification:a},a.uuid))})});function V(){return e.jsxs(e.Fragment,{children:[e.jsx(ft,{}),e.jsx($,{}),e.jsx(Mt,{})]})}const Vt=J(function({loaderData:o}){return e.jsxs("main",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",gap:"1em"},children:[e.jsx("div",{children:"Loading app..."}),e.jsxs("div",{children:["Loading version"," ",o.version,"..."]})]})}),Gt=()=>[{rel:"manifest",href:"/trader/manifest.json"},{rel:"icon",type:"image/svg+xml",href:"/trader/favicon.svg"}];function Ut({children:n}){const o=M([D,q==="light"]);return e.jsxs("html",{lang:"en",children:[e.jsxs("head",{children:[e.jsx("meta",{charSet:"utf-8"}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),e.jsx("meta",{name:"theme-color",content:"#eee"}),e.jsx(Y,{})]}),e.jsxs("body",{className:o,children:[e.jsx("noscript",{children:"You need to enable JavaScript to run this app."}),e.jsx("div",{id:Le,children:n}),e.jsx(Q,{}),e.jsx(K,{})]})]})}function It(){return e.jsx(V,{})}function kt(){return xe(_e),e.jsx(V,{})}let G=It;G=kt;const Zt=W(G),$t=X(function({error:o}){let a="Error",s="An unexpected error occured";return ee(o)&&(a=o.status===404?"404":"Unknown status error",s=o.status===404?"the requested page could not be found":o.statusText||"An unexpected error occured"),e.jsxs("main",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",gap:"1em"},children:[e.jsx("h1",{style:{margin:"0"},children:a}),e.jsx("p",{style:{margin:"0"},children:s}),!1]})});export{$t as ErrorBoundary,Vt as HydrateFallback,Ut as Layout,Zt as default,Gt as links};
