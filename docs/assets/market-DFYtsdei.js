import{a as m,q as h,z as ui}from"./chunk-PVWAREVJ-D1PIyzeh.js";import{a as zn,u as Gn,F as Wn,B as K,c as Ut,I as jt,y as ci,z as fi,A as Z,G as J,w as st,H as Kn,J as gt,K as ut,L as _t,M as tt,N as di,O as xt,Q as Ge,R as hi,T as cn,U as fn,V as mi,W as pi,v as Zn,X as yi,Y as gi,Z as _i,_ as xi,$ as bi}from"./useLoadingPersistStorages-BWX3nPU9.js";import{u as nt,D as vi,i as wi,a as Jn,b as tr,T as er,c as nr,d as dn,U as rr,e as ir,f as or,g as sr,h as We,j as Ke,k as Ze,l as Ai,m as Mi,n as ar,o as hn,p as Si,S as Ci}from"./useTableSearch-Ui5oQRZ2.js";import{c as Ti}from"./createPageTitleWithAppName-C6bNgB-9.js";import{u as mt,a as at,g as Lt,c as Ei}from"./getUrlToMapPageWithParams-gLmSAaLz.js";import{M as Ni}from"./Main-D4jU2hau.js";import{i as ie,a as oe,u as se,B as Pi,b as ki,E as _e,c as xe,s as lr,P as ur,F as cr,d as fr,e as dr,L as hr,S as Fi,f as Oi}from"./sortItemsByProductName-BGoQ9pgC.js";import{M as mr,a as pr}from"./ModalConfirmation-BkKL8gix.js";import{M as mn}from"./ModalNotification-4U2xs5uf.js";import{h as yr,g as ae,u as gr,M as _r,a as xr,b as br,c as vr}from"./hasUuid-BkktISKI.js";import{b as wr}from"./ClassNames-CdIKlwZs.js";import{s as Ar,F as Mr,a as Li}from"./setMovingEntityOrLocationOrPlanetarySystemToUrlSearchParams-B36G2HfO.js";import"./App.const-Bym5gJCd.js";import"./InternalStaticLink-rDmjTW4d.js";import"./getUrlToMarketPageWithParams-DdYQKoX-.js";import"./getUrlToProductsPageWithParams-CN44cusc.js";import"./index-D9Tyn9c9.js";const pn="Market";function Ii({productName:t,locationName:e}){const n=[t,!!e&&`in ${e}`].filter(r=>!!r);return n.length?`Search ${n.join(" ")} - ${pn}`:`${pn}`}const $i="_Container_1vczl_1",Bi={Container:$i},yn=t=>[{name:"locationUuid",label:"location",type:"select",options:t,chooseOptionLabel:"choose a location",noOptionsLabel:"no location available",allowToSelectNoValueOption:!0,filterPredicate:(e,n)=>e.locationUuid===n.locationUuid},{type:"row-container",label:"quantity",labelForFieldName:"minQuantity",fields:[{name:"minQuantity",label:"min",type:"number",min:0,max:Number.MAX_SAFE_INTEGER,filterPredicate:(e,n)=>{const r=n.minQuantity;return r===void 0?!0:ie(e)?e.availableQuantity>=r:oe(e)?e.desirableQuantity>=r:!0}},{name:"maxQuantity",label:"max",type:"number",min:0,max:Number.MAX_SAFE_INTEGER,filterPredicate:(e,n)=>{const r=n.maxQuantity;return r===void 0?!0:ie(e)?e.availableQuantity<=r:oe(e)?e.desirableQuantity<=r:!0}}]},{type:"row-container",label:"price",labelForFieldName:"minPrice",fields:[{name:"minPrice",label:"min",type:"number",valueType:"float",pattern:"[0-9]+[.][0-9]{2}",min:0,max:Number.MAX_SAFE_INTEGER,step:"0.01",filterPredicate:(e,n)=>{const r=n.minPrice;return r===void 0?!0:e.price>=r}},{name:"maxPrice",label:"max",type:"number",valueType:"float",pattern:"[0-9]+[.][0-9]{2}",min:0,max:Number.MAX_SAFE_INTEGER,step:"0.01",filterPredicate:(e,n)=>{const r=n.maxPrice;return r===void 0?!0:e.price<=r}}]}],Ri="_DialogEditFormBody_4y502_1",Di="_Content_4y502_16",Ui="_ErrorMessageContainer_4y502_22",ji="_ErrorMessageText_4y502_32",Hi="_ActionButtons_4y502_91",Vi="_ActionButtonsGroup_4y502_97",ct={DialogEditFormBody:Ri,Content:Di,ErrorMessageContainer:Ui,ErrorMessageText:ji,ActionButtons:Hi,ActionButtonsGroup:Vi},Xi=t=>{if(!t)return;const{minPrice:e,maxPrice:n,minQuantity:r,maxQuantity:i}=t;if(typeof e=="number"&&Number.isFinite(e)&&typeof n=="number"&&Number.isFinite(n)&&e>n)return function(){return h.jsxs(h.Fragment,{children:[h.jsx("strong",{children:"Max price"})," ","should be equal or greater then"," ",h.jsx("strong",{children:"min price"}),"."]})};if(typeof r=="number"&&Number.isFinite(r)&&typeof i=="number"&&Number.isFinite(i)&&r>i)return function(){return h.jsxs(h.Fragment,{children:[h.jsx("strong",{children:"Max quantity"})," ","should be equal or greater then"," ",h.jsx("strong",{children:"min quantity"}),"."]})}},Yi=m.memo(function({filterValue:e,onSetFilterValue:n,onHide:r}){const i=m.useRef(null),o=nt([mt]),s=mt(v=>v.items),a=m.useMemo(function(){return yn(o?[]:s)},[s,o]),l=m.useCallback(function(){r()},[r]),u=m.useCallback(function(S){n(S),l()},[l,n]),{handleSubmit:c,formValidationErrorMessage:f}=zn({formRef:i,onSubmit:u,formFields:a,validateFormData:Xi,showErrorWhenAllVisibleFieldsEmpty:!1}),d=m.useCallback(function(){c()},[c]);return Gn(i,a,d),h.jsx(h.Fragment,{children:h.jsx("div",{style:{position:"absolute",top:0,right:0},children:h.jsx(vi,{title:"filter orders",onHide:l,children:h.jsxs("form",{ref:i,className:ct.DialogEditFormBody,onSubmit:c,children:[h.jsxs("div",{className:ct.Content,children:[h.jsx(Wn,{formFields:a,item:e}),f!==void 0&&h.jsx("div",{className:ct.ErrorMessageContainer,children:h.jsx("span",{className:ct.ErrorMessageText,children:typeof f=="function"?f():f})})]}),h.jsxs("div",{className:ct.ActionButtons,children:[h.jsx("div",{className:ct.ActionButtonsGroup,children:h.jsx(K,{type:"reset",children:"reset filter"})}),h.jsx("div",{className:ct.ActionButtonsGroup,children:h.jsx(K,{type:"submit",primary:!0,children:"apply filter"})})]})]})})})})}),qi="_ModalCopyingItemsFormBody_9oqki_1",Qi="_Content_9oqki_10",zi="_ErrorMessageContainer_9oqki_18",Gi="_ErrorMessageText_9oqki_28",Wi="_ActionButtons_9oqki_36",Ki="_ActionButtonsGroup_9oqki_42",St={ModalCopyingItemsFormBody:qi,Content:Qi,ErrorMessageContainer:zi,ErrorMessageText:Gi,ActionButtons:Wi,ActionButtonsGroup:Ki};function Zi(t){if(!t?.length)return[{type:"checkbox-group",name:"uuids",label:"selected items",defaultValue:[],items:[],disabled:!0}];const e=t.map(({uuid:r})=>({value:r,label:"unknown label"}));return[{type:"checkbox-group",name:"uuids",label:"selected items",defaultValue:e.map(({value:r})=>r),items:e}]}function Ji({title:t="copy selected items",itemsToCreate:e,showResetButton:n=!1,resetButtonLabel:r,onCancel:i,cancelButtonLabel:o,saveButtonLabel:s,onBulkCreate:a}){const l="copy items",u=m.useRef(null),c=m.useMemo(()=>Zi(e),[e]);Gn(u,c);const f=m.useCallback(S=>{if(!e?.length)return;const w=e.filter(M=>S.uuids.includes(M.uuid));a(w)},[e,a]),d=m.useCallback(()=>{},[]),{handleSubmit:p,formValidationErrorMessage:g}=zn({formRef:u,onSubmit:f,formFields:c,validateFormData:d}),x=m.useCallback(()=>{i()},[i]),v=m.useMemo(()=>{if(e)return{uuids:e.map(S=>S.uuid),entityType:"approved-items",uuid:"no-uuid"}},[e]);return h.jsx(mr,{title:t,onHide:x,children:h.jsxs("form",{ref:u,className:St.ModalCopyingItemsFormBody,onSubmit:p,children:[h.jsxs("div",{className:St.Content,children:[h.jsx(Wn,{formFields:c,item:v}),g!==void 0&&h.jsx("div",{className:St.ErrorMessageContainer,role:"alert",children:h.jsx("span",{className:St.ErrorMessageText,children:typeof g=="function"?g():g})})]}),h.jsxs("div",{className:St.ActionButtons,children:[h.jsx(K,{onClick:i,children:o||"cancel"}),h.jsxs("div",{className:St.ActionButtonsGroup,children:[n&&h.jsx(K,{children:r||"reset form"}),h.jsx(K,{type:"submit",primary:!0,children:s||l})]})]})]})})}function zt(){return h.jsx(h.Fragment,{})}const to="_Message_fvh5i_1",eo={Message:to};function Sr({items:t,selectedItemsUuids:e,itemTypeName:n="item",itemTypePluralName:r="items",targetTableName:i=void 0,onBulkCopyingIntoTargetTable:o,findSimilarItemInTargetTable:s}){const[a,l]=m.useState(),[u,c]=m.useState([]),{isVisible:f,show:d,hide:p}=Ut(!1),{isVisible:g,show:x,hide:v}=Ut(!1),S=m.useCallback(()=>{const y=t.filter(b=>e.includes(b.uuid)).filter(b=>!s(b));if(!y.length){x(),l(void 0);return}l(y),d()},[t,e,l,d,x,s]),w=m.useCallback(()=>{p(),l(void 0)},[p,l]),{isVisible:M,show:I,hide:C}=Ut(!1),k=m.useCallback(N=>{o(N),c(N),w(),I()},[o,c,w,I]);m.useCallback(()=>{const N=`copy selected ${e.length>1?r:n} ${!!i&&`into ${i}`}`;return h.jsx(h.Fragment,{children:!!e?.length&&h.jsx(K,{noPadding:!0,transparent:!0,title:N,onClick:S,children:h.jsx(jt,{name:"content_copy"})})})},[e,r,n,i,S]),m.useCallback(()=>h.jsx(h.Fragment,{children:f&&h.jsx(Ji,{title:`copy selected items ${i?`into ${i}`:""}`,itemsToCreate:a,onCancel:w,onBulkCreate:k})}),[f,w,k,a,i]),m.useCallback(()=>h.jsx(h.Fragment,{children:g&&h.jsx(mn,{title:"No more items can be added",onHide:v,okButtonLabel:"ok",children:h.jsx("p",{className:eo.Message,children:"there are already a duplicate item for every original item"})})}),[g,v]);const E=m.useCallback(()=>{C(),c([])},[C,c]);return m.useCallback(()=>{const N=u.length>1?"items were added:":"item was added:";return h.jsx(h.Fragment,{children:M&&h.jsx(mn,{title:N,onHide:E,okButtonLabel:"ok",children:h.jsx("ul",{style:{listStyle:"none",padding:0,textAlign:"left",margin:"1em 0",maxHeight:"90%",overflow:"auto"},children:u.map((y,b)=>h.jsxs("li",{style:{padding:0},children:["-"," ",y.entityType," ",y?.name||""]},b))})})})},[M,E,u]),{CopySelectedItemsButton:zt,CopyingDialog:zt,NothingToCopyNotification:zt,ItemsWereCopiedNotification:zt}}function Cr(t,e){if(!e.locationUuid)return!1;if(t.locationUuid===e.locationUuid)return!0;const r=ci(t.locationUuid)?.planetarySystemUuid,i=r?fi(r):void 0;return i?i.uuid===e.locationUuid:!1}const no=t=>[{name:"locationUuid",label:"location",type:"select",options:t,chooseOptionLabel:"choose a location",noOptionsLabel:"no location available",allowToSelectNoValueOption:!0,filterPredicate:Cr},{name:"minQuantity",label:"min quantity",type:"number",min:0,max:Number.MAX_SAFE_INTEGER,filterPredicate:(e,n)=>n.minQuantity===void 0?!0:e.desirableQuantity>=n.minQuantity},{name:"maxQuantity",label:"max quantity",type:"number",min:0,max:Number.MAX_SAFE_INTEGER,filterPredicate:(e,n)=>n.maxQuantity===void 0?!0:e.desirableQuantity<=n.maxQuantity},{name:"minPrice",label:"min price",type:"number",valueType:"float",pattern:"[0-9]+[.][0-9]{2}",min:0,max:Number.MAX_SAFE_INTEGER,step:"0.01",filterPredicate:(e,n)=>n.minPrice===void 0?!0:e.price>=n.minPrice},{name:"maxPrice",label:"max price",type:"number",valueType:"float",pattern:"[0-9]+[.][0-9]{2}",min:0,max:Number.MAX_SAFE_INTEGER,step:"0.01",filterPredicate:(e,n)=>n.maxPrice===void 0?!0:e.price<=n.maxPrice}];function ro(t){ie(t)?Z.getState().delete(t):oe(t)?J.getState().delete(t):console.error("Error. Unknown type of order")}const Tr=m.memo(function({itemToDelete:e,onHideModal:n,onHideParentModal:r}){const i=st([ut,_t,tt,Z,J]),o=nt([at]),s=i||o,a=m.useMemo(function(){return ie(e)?"sell":oe(e)?"buy":""},[e]),l=m.useCallback(function(){n()},[n]),u=m.useCallback(function(){r()},[r]),c=m.useCallback(function(){s||(ro(e),Kn(e.uuid),l(),u())},[e,l,u,s]),f=m.useMemo(function(){const p=!s&&gt(e.productUuid)?.name||"(product without name)",g=!s&&Lt(e.locationUuid)||"(location without name)";return h.jsxs(h.Fragment,{children:["Are you sure you want"," ",h.jsx("strong",{children:"to delete"})," ","the"," ",a," ","order",h.jsx("br",{}),"for"," ",h.jsx("strong",{children:p}),h.jsx("br",{}),"in"," ",h.jsx("strong",{children:g}),"?"]})},[e,s,a]);return h.jsx(pr,{title:f,onHide:l,onConfirm:c,confirmButtonLabel:`delete ${a} order`})}),Er="price-at-marks",io=["uuid","entityType","orderUuid","pricesAtMarks"];di(io);const gn=(t,e)=>[{name:"uuid",type:"hidden"},{name:"entityType",type:"hidden"},{name:"locationUuid",label:"location",type:"select",required:!0,options:e,chooseOptionLabel:"choose a location",noOptionsLabel:"no locations available",allowToSelectNoValueOption:!0},{name:"productUuid",label:"product",type:"select",required:!0,options:t,chooseOptionLabel:"choose a product",noOptionsLabel:"no products available",allowToSelectNoValueOption:!0},{name:"desirableQuantity",label:"stock",type:"number",min:0,max:Number.MAX_SAFE_INTEGER},{name:"price",type:"number",required:!0,valueType:"float",pattern:"[0-9]+[.][0-9]{2}?",step:"0.01",min:0,max:Number.MAX_SAFE_INTEGER}],oo=m.memo(function({itemToEdit:e,filterValue:n,onHideModal:r,onShowDeleteItemConfirmation:i,onCreateItem:o,onUpdateItem:s}){const a=st([J,tt,_t,ut,xt]),l=nt([mt,at,se]),u=a||l,c=J(y=>y.create),f=J(y=>y.update),d=tt(y=>y.create),p=tt(y=>y.update),g=m.useCallback(y=>{d({entityType:Er,orderUuid:y.uuid,pricesAtMarks:[[y.price,y.desirableQuantity]]})},[d]),x=m.useCallback(y=>{const b=[y.price,y.desirableQuantity],_=Ge(y.uuid);if(_){if(_.pricesAtMarks.find(P=>P[0]===b[0]&&P[1]===b[1]))return;p({..._,pricesAtMarks:_.pricesAtMarks.concat([b])})}else g(y)},[p,g]),v=m.useCallback(y=>{const b=c(y);g(b),typeof o=="function"&&o(b)},[c,o,g]),S=m.useCallback(y=>{const b=f(y);b&&(x(b),typeof s=="function"&&s(b))},[f,s,x]),w=m.useCallback(()=>{r()},[r]),M=m.useCallback(y=>{if(yr(y)){const b=ae(y,ki);S(b)}else{const b=ae(y,Pi);b.entityType=_e,v(b)}w()},[w,v,S]),I=m.useCallback(function(b){if(u)return function(){return h.jsx("span",{children:"Loading..."})};const _=hi(b);if(_){const T=gt(_.productUuid)?.name||"(product without name)",P=Lt(_.locationUuid)||"(location without name)";return function(){return h.jsxs("span",{children:["Buy order for"," ",h.jsx("strong",{children:T})," ","in"," ",h.jsx("strong",{children:P})," ","already exists"]})}}},[u]),C=se(y=>y.items),k=mt(y=>y.items),E=m.useMemo(function(){return l?gn([],[]):gn(C,k)},[C,k,l]),N=gr(E,n);return h.jsx(_r,{humanizedItemTypeName:"buy order",itemToEdit:e,formFields:N,validateFormData:I,onCancel:w,onSubmit:M,onDelete:i,deleteItemButtonLabel:"delete buy order"})});function Jt(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function so(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Je(t){let e,n,r;t.length!==2?(e=Jt,n=(a,l)=>Jt(t(a),l),r=(a,l)=>t(a)-l):(e=t===Jt||t===so?t:ao,n=t,r=t);function i(a,l,u=0,c=a.length){if(u<c){if(e(l,l)!==0)return c;do{const f=u+c>>>1;n(a[f],l)<0?u=f+1:c=f}while(u<c)}return u}function o(a,l,u=0,c=a.length){if(u<c){if(e(l,l)!==0)return c;do{const f=u+c>>>1;n(a[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function s(a,l,u=0,c=a.length){const f=i(a,l,u,c-1);return f>u&&r(a[f-1],l)>-r(a[f],l)?f-1:f}return{left:i,center:s,right:o}}function ao(){return 0}function lo(t){return t===null?NaN:+t}const uo=Je(Jt),co=uo.right;Je(lo).center;function _n(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}const fo=Math.sqrt(50),ho=Math.sqrt(10),mo=Math.sqrt(2);function le(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=fo?10:o>=ho?5:o>=mo?2:1;let a,l,u;return i<0?(u=Math.pow(10,-i)/s,a=Math.round(t*u),l=Math.round(e*u),a/u<t&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*s,a=Math.round(t/u),l=Math.round(e/u),a*u<t&&++a,l*u>e&&--l),l<a&&.5<=n&&n<2?le(t,e,n*2):[a,l,u]}function po(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,s]=r?le(e,t,n):le(t,e,n);if(!(o>=i))return[];const a=o-i+1,l=new Array(a);if(r)if(s<0)for(let u=0;u<a;++u)l[u]=(o-u)/-s;else for(let u=0;u<a;++u)l[u]=(o-u)*s;else if(s<0)for(let u=0;u<a;++u)l[u]=(i+u)/-s;else for(let u=0;u<a;++u)l[u]=(i+u)*s;return l}function Ie(t,e,n){return e=+e,t=+t,n=+n,le(t,e,n)[2]}function yo(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Ie(e,t,n):Ie(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function go(t){return t}var Pe=1,ke=2,$e=3,$t=4,xn=1e-6;function _o(t){return"translate("+t+",0)"}function xo(t){return"translate(0,"+t+")"}function bo(t){return e=>+t(e)}function vo(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function wo(){return!this.__axis}function Nr(t,e){var n=[],r=null,i=null,o=6,s=6,a=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=t===Pe||t===$t?-1:1,c=t===$t||t===ke?"x":"y",f=t===Pe||t===$e?_o:xo;function d(p){var g=r??(e.ticks?e.ticks.apply(e,n):e.domain()),x=i??(e.tickFormat?e.tickFormat.apply(e,n):go),v=Math.max(o,0)+a,S=e.range(),w=+S[0]+l,M=+S[S.length-1]+l,I=(e.bandwidth?vo:bo)(e.copy(),l),C=p.selection?p.selection():p,k=C.selectAll(".domain").data([null]),E=C.selectAll(".tick").data(g,e).order(),N=E.exit(),y=E.enter().append("g").attr("class","tick"),b=E.select("line"),_=E.select("text");k=k.merge(k.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),E=E.merge(y),b=b.merge(y.append("line").attr("stroke","currentColor").attr(c+"2",u*o)),_=_.merge(y.append("text").attr("fill","currentColor").attr(c,u*v).attr("dy",t===Pe?"0em":t===$e?"0.71em":"0.32em")),p!==C&&(k=k.transition(p),E=E.transition(p),b=b.transition(p),_=_.transition(p),N=N.transition(p).attr("opacity",xn).attr("transform",function(T){return isFinite(T=I(T))?f(T+l):this.getAttribute("transform")}),y.attr("opacity",xn).attr("transform",function(T){var P=this.parentNode.__axis;return f((P&&isFinite(P=P(T))?P:I(T))+l)})),N.remove(),k.attr("d",t===$t||t===ke?s?"M"+u*s+","+w+"H"+l+"V"+M+"H"+u*s:"M"+l+","+w+"V"+M:s?"M"+w+","+u*s+"V"+l+"H"+M+"V"+u*s:"M"+w+","+l+"H"+M),E.attr("opacity",1).attr("transform",function(T){return f(I(T)+l)}),b.attr(c+"2",u*o),_.attr(c,u*v).text(x),C.filter(wo).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===ke?"start":t===$t?"end":"middle"),C.each(function(){this.__axis=I})}return d.scale=function(p){return arguments.length?(e=p,d):e},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(p){return arguments.length?(n=p==null?[]:Array.from(p),d):n.slice()},d.tickValues=function(p){return arguments.length?(r=p==null?null:Array.from(p),d):r&&r.slice()},d.tickFormat=function(p){return arguments.length?(i=p,d):i},d.tickSize=function(p){return arguments.length?(o=s=+p,d):o},d.tickSizeInner=function(p){return arguments.length?(o=+p,d):o},d.tickSizeOuter=function(p){return arguments.length?(s=+p,d):s},d.tickPadding=function(p){return arguments.length?(a=+p,d):a},d.offset=function(p){return arguments.length?(l=+p,d):l},d}function Ao(t){return Nr($e,t)}function Mo(t){return Nr($t,t)}var So={value:()=>{}};function Pr(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new te(n)}function te(t){this._=t}function Co(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}te.prototype=Pr.prototype={constructor:te,on:function(t,e){var n=this._,r=Co(t+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(t=r[o]).type)&&(i=To(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<s;)if(i=(t=r[o]).type)n[i]=bn(n[i],t.name,e);else if(e==null)for(i in n)n[i]=bn(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new te(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function To(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function bn(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=So,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Be="http://www.w3.org/1999/xhtml";const vn={svg:"http://www.w3.org/2000/svg",xhtml:Be,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function be(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),vn.hasOwnProperty(e)?{space:vn[e],local:t}:t}function Eo(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Be&&e.documentElement.namespaceURI===Be?e.createElement(t):e.createElementNS(n,t)}}function No(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function kr(t){var e=be(t);return(e.local?No:Eo)(e)}function Po(){}function tn(t){return t==null?Po:function(){return this.querySelector(t)}}function ko(t){typeof t!="function"&&(t=tn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=new Array(s),l,u,c=0;c<s;++c)(l=o[c])&&(u=t.call(l,l.__data__,c,o))&&("__data__"in l&&(u.__data__=l.__data__),a[c]=u);return new Y(r,this._parents)}function Fo(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Oo(){return[]}function Fr(t){return t==null?Oo:function(){return this.querySelectorAll(t)}}function Lo(t){return function(){return Fo(t.apply(this,arguments))}}function Io(t){typeof t=="function"?t=Lo(t):t=Fr(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s=e[o],a=s.length,l,u=0;u<a;++u)(l=s[u])&&(r.push(t.call(l,l.__data__,u,s)),i.push(l));return new Y(r,i)}function Or(t){return function(){return this.matches(t)}}function Lr(t){return function(e){return e.matches(t)}}var $o=Array.prototype.find;function Bo(t){return function(){return $o.call(this.children,t)}}function Ro(){return this.firstElementChild}function Do(t){return this.select(t==null?Ro:Bo(typeof t=="function"?t:Lr(t)))}var Uo=Array.prototype.filter;function jo(){return Array.from(this.children)}function Ho(t){return function(){return Uo.call(this.children,t)}}function Vo(t){return this.selectAll(t==null?jo:Ho(typeof t=="function"?t:Lr(t)))}function Xo(t){typeof t!="function"&&(t=Or(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=[],l,u=0;u<s;++u)(l=o[u])&&t.call(l,l.__data__,u,o)&&a.push(l);return new Y(r,this._parents)}function Ir(t){return new Array(t.length)}function Yo(){return new Y(this._enter||this._groups.map(Ir),this._parents)}function ue(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}ue.prototype={constructor:ue,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function qo(t){return function(){return t}}function Qo(t,e,n,r,i,o){for(var s=0,a,l=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new ue(t,o[s]);for(;s<l;++s)(a=e[s])&&(i[s]=a)}function zo(t,e,n,r,i,o,s){var a,l,u=new Map,c=e.length,f=o.length,d=new Array(c),p;for(a=0;a<c;++a)(l=e[a])&&(d[a]=p=s.call(l,l.__data__,a,e)+"",u.has(p)?i[a]=l:u.set(p,l));for(a=0;a<f;++a)p=s.call(t,o[a],a,o)+"",(l=u.get(p))?(r[a]=l,l.__data__=o[a],u.delete(p)):n[a]=new ue(t,o[a]);for(a=0;a<c;++a)(l=e[a])&&u.get(d[a])===l&&(i[a]=l)}function Go(t){return t.__data__}function Wo(t,e){if(!arguments.length)return Array.from(this,Go);var n=e?zo:Qo,r=this._parents,i=this._groups;typeof t!="function"&&(t=qo(t));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],f=i[u],d=f.length,p=Ko(t.call(c,c&&c.__data__,u,r)),g=p.length,x=a[u]=new Array(g),v=s[u]=new Array(g),S=l[u]=new Array(d);n(c,f,x,v,S,p,e);for(var w=0,M=0,I,C;w<g;++w)if(I=x[w]){for(w>=M&&(M=w+1);!(C=v[M])&&++M<g;);I._next=C||null}}return s=new Y(s,r),s._enter=a,s._exit=l,s}function Ko(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Zo(){return new Y(this._exit||this._groups.map(Ir),this._parents)}function Jo(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function ts(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var u=n[l],c=r[l],f=u.length,d=a[l]=new Array(f),p,g=0;g<f;++g)(p=u[g]||c[g])&&(d[g]=p);for(;l<i;++l)a[l]=n[l];return new Y(a,this._parents)}function es(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function ns(t){t||(t=rs);function e(f,d){return f&&d?t(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s=n[o],a=s.length,l=i[o]=new Array(a),u,c=0;c<a;++c)(u=s[c])&&(l[c]=u);l.sort(e)}return new Y(i,this._parents).order()}function rs(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function is(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function os(){return Array.from(this)}function ss(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function as(){let t=0;for(const e of this)++t;return t}function ls(){return!this.node()}function us(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,s=i.length,a;o<s;++o)(a=i[o])&&t.call(a,a.__data__,o,i);return this}function cs(t){return function(){this.removeAttribute(t)}}function fs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ds(t,e){return function(){this.setAttribute(t,e)}}function hs(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ms(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ps(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function ys(t,e){var n=be(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?fs:cs:typeof e=="function"?n.local?ps:ms:n.local?hs:ds)(n,e))}function $r(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function gs(t){return function(){this.style.removeProperty(t)}}function _s(t,e,n){return function(){this.style.setProperty(t,e,n)}}function xs(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function bs(t,e,n){return arguments.length>1?this.each((e==null?gs:typeof e=="function"?xs:_s)(t,e,n??"")):kt(this.node(),t)}function kt(t,e){return t.style.getPropertyValue(e)||$r(t).getComputedStyle(t,null).getPropertyValue(e)}function vs(t){return function(){delete this[t]}}function ws(t,e){return function(){this[t]=e}}function As(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Ms(t,e){return arguments.length>1?this.each((e==null?vs:typeof e=="function"?As:ws)(t,e)):this.node()[t]}function Br(t){return t.trim().split(/^|\s+/)}function en(t){return t.classList||new Rr(t)}function Rr(t){this._node=t,this._names=Br(t.getAttribute("class")||"")}Rr.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Dr(t,e){for(var n=en(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Ur(t,e){for(var n=en(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Ss(t){return function(){Dr(this,t)}}function Cs(t){return function(){Ur(this,t)}}function Ts(t,e){return function(){(e.apply(this,arguments)?Dr:Ur)(this,t)}}function Es(t,e){var n=Br(t+"");if(arguments.length<2){for(var r=en(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Ts:e?Ss:Cs)(n,e))}function Ns(){this.textContent=""}function Ps(t){return function(){this.textContent=t}}function ks(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Fs(t){return arguments.length?this.each(t==null?Ns:(typeof t=="function"?ks:Ps)(t)):this.node().textContent}function Os(){this.innerHTML=""}function Ls(t){return function(){this.innerHTML=t}}function Is(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function $s(t){return arguments.length?this.each(t==null?Os:(typeof t=="function"?Is:Ls)(t)):this.node().innerHTML}function Bs(){this.nextSibling&&this.parentNode.appendChild(this)}function Rs(){return this.each(Bs)}function Ds(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Us(){return this.each(Ds)}function js(t){var e=typeof t=="function"?t:kr(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Hs(){return null}function Vs(t,e){var n=typeof t=="function"?t:kr(t),r=e==null?Hs:typeof e=="function"?e:tn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Xs(){var t=this.parentNode;t&&t.removeChild(this)}function Ys(){return this.each(Xs)}function qs(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Qs(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function zs(t){return this.select(t?Qs:qs)}function Gs(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ws(t){return function(e){t.call(this,e,this.__data__)}}function Ks(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Zs(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Js(t,e,n){return function(){var r=this.__on,i,o=Ws(e);if(r){for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function ta(t,e,n){var r=Ks(t+""),i,o=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,c;l<u;++l)for(i=0,c=a[l];i<o;++i)if((s=r[i]).type===c.type&&s.name===c.name)return c.value}return}for(a=e?Js:Zs,i=0;i<o;++i)this.each(a(r[i],e,n));return this}function jr(t,e,n){var r=$r(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ea(t,e){return function(){return jr(this,t,e)}}function na(t,e){return function(){return jr(this,t,e.apply(this,arguments))}}function ra(t,e){return this.each((typeof e=="function"?na:ea)(t,e))}function*ia(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,s;i<o;++i)(s=r[i])&&(yield s)}var Hr=[null];function Y(t,e){this._groups=t,this._parents=e}function Yt(){return new Y([[document.documentElement]],Hr)}function oa(){return this}Y.prototype=Yt.prototype={constructor:Y,select:ko,selectAll:Io,selectChild:Do,selectChildren:Vo,filter:Xo,data:Wo,enter:Yo,exit:Zo,join:Jo,merge:ts,selection:oa,order:es,sort:ns,call:is,nodes:os,node:ss,size:as,empty:ls,each:us,attr:ys,style:bs,property:Ms,classed:Es,text:Fs,html:$s,raise:Rs,lower:Us,append:js,insert:Vs,remove:Ys,clone:zs,datum:Gs,on:ta,dispatch:ra,[Symbol.iterator]:ia};function wn(t){return typeof t=="string"?new Y([[document.querySelector(t)]],[document.documentElement]):new Y([[t]],Hr)}function sa(t){let e;for(;e=t.sourceEvent;)t=e;return t}function aa(t,e){if(t=sa(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}function nn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Vr(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function qt(){}var Ht=.7,ce=1/Ht,Pt="\\s*([+-]?\\d+)\\s*",Vt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",et="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",la=/^#([0-9a-f]{3,8})$/,ua=new RegExp(`^rgb\\(${Pt},${Pt},${Pt}\\)$`),ca=new RegExp(`^rgb\\(${et},${et},${et}\\)$`),fa=new RegExp(`^rgba\\(${Pt},${Pt},${Pt},${Vt}\\)$`),da=new RegExp(`^rgba\\(${et},${et},${et},${Vt}\\)$`),ha=new RegExp(`^hsl\\(${Vt},${et},${et}\\)$`),ma=new RegExp(`^hsla\\(${Vt},${et},${et},${Vt}\\)$`),An={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};nn(qt,pt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Mn,formatHex:Mn,formatHex8:pa,formatHsl:ya,formatRgb:Sn,toString:Sn});function Mn(){return this.rgb().formatHex()}function pa(){return this.rgb().formatHex8()}function ya(){return Xr(this).formatHsl()}function Sn(){return this.rgb().formatRgb()}function pt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=la.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Cn(e):n===3?new V(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Gt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Gt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ua.exec(t))?new V(e[1],e[2],e[3],1):(e=ca.exec(t))?new V(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=fa.exec(t))?Gt(e[1],e[2],e[3],e[4]):(e=da.exec(t))?Gt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ha.exec(t))?Nn(e[1],e[2]/100,e[3]/100,1):(e=ma.exec(t))?Nn(e[1],e[2]/100,e[3]/100,e[4]):An.hasOwnProperty(t)?Cn(An[t]):t==="transparent"?new V(NaN,NaN,NaN,0):null}function Cn(t){return new V(t>>16&255,t>>8&255,t&255,1)}function Gt(t,e,n,r){return r<=0&&(t=e=n=NaN),new V(t,e,n,r)}function ga(t){return t instanceof qt||(t=pt(t)),t?(t=t.rgb(),new V(t.r,t.g,t.b,t.opacity)):new V}function Re(t,e,n,r){return arguments.length===1?ga(t):new V(t,e,n,r??1)}function V(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}nn(V,Re,Vr(qt,{brighter(t){return t=t==null?ce:Math.pow(ce,t),new V(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Ht:Math.pow(Ht,t),new V(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new V(ht(this.r),ht(this.g),ht(this.b),fe(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Tn,formatHex:Tn,formatHex8:_a,formatRgb:En,toString:En}));function Tn(){return`#${dt(this.r)}${dt(this.g)}${dt(this.b)}`}function _a(){return`#${dt(this.r)}${dt(this.g)}${dt(this.b)}${dt((isNaN(this.opacity)?1:this.opacity)*255)}`}function En(){const t=fe(this.opacity);return`${t===1?"rgb(":"rgba("}${ht(this.r)}, ${ht(this.g)}, ${ht(this.b)}${t===1?")":`, ${t})`}`}function fe(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ht(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function dt(t){return t=ht(t),(t<16?"0":"")+t.toString(16)}function Nn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Q(t,e,n,r)}function Xr(t){if(t instanceof Q)return new Q(t.h,t.s,t.l,t.opacity);if(t instanceof qt||(t=pt(t)),!t)return new Q;if(t instanceof Q)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(e===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-e)/a+2:s=(e-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new Q(s,a,l,t.opacity)}function xa(t,e,n,r){return arguments.length===1?Xr(t):new Q(t,e,n,r??1)}function Q(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}nn(Q,xa,Vr(qt,{brighter(t){return t=t==null?ce:Math.pow(ce,t),new Q(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Ht:Math.pow(Ht,t),new Q(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new V(Fe(t>=240?t-240:t+120,i,r),Fe(t,i,r),Fe(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Q(Pn(this.h),Wt(this.s),Wt(this.l),fe(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=fe(this.opacity);return`${t===1?"hsl(":"hsla("}${Pn(this.h)}, ${Wt(this.s)*100}%, ${Wt(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Pn(t){return t=(t||0)%360,t<0?t+360:t}function Wt(t){return Math.max(0,Math.min(1,t||0))}function Fe(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const rn=t=>()=>t;function ba(t,e){return function(n){return t+n*e}}function va(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function wa(t){return(t=+t)==1?Yr:function(e,n){return n-e?va(e,n,t):rn(isNaN(e)?n:e)}}function Yr(t,e){var n=e-t;return n?ba(t,n):rn(isNaN(t)?e:t)}const de=(function t(e){var n=wa(e);function r(i,o){var s=n((i=Re(i)).r,(o=Re(o)).r),a=n(i.g,o.g),l=n(i.b,o.b),u=Yr(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=t,r})(1);function Aa(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function Ma(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Sa(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=on(t[s],e[s]);for(;s<n;++s)o[s]=e[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}function Ca(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function q(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Ta(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=on(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var De=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Oe=new RegExp(De.source,"g");function Ea(t){return function(){return t}}function Na(t){return function(e){return t(e)+""}}function qr(t,e){var n=De.lastIndex=Oe.lastIndex=0,r,i,o,s=-1,a=[],l=[];for(t=t+"",e=e+"";(r=De.exec(t))&&(i=Oe.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:q(r,i)})),n=Oe.lastIndex;return n<e.length&&(o=e.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?Na(l[0].x):Ea(e):(e=l.length,function(u){for(var c=0,f;c<e;++c)a[(f=l[c]).i]=f.x(u);return a.join("")})}function on(t,e){var n=typeof e,r;return e==null||n==="boolean"?rn(e):(n==="number"?q:n==="string"?(r=pt(e))?(e=r,de):qr:e instanceof pt?de:e instanceof Date?Ca:Ma(e)?Aa:Array.isArray(e)?Sa:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Ta:q)(t,e)}function Pa(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var kn=180/Math.PI,Ue={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Qr(t,e,n,r,i,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*kn,skewX:Math.atan(l)*kn,scaleX:s,scaleY:a}}var Kt;function ka(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Ue:Qr(e.a,e.b,e.c,e.d,e.e,e.f)}function Fa(t){return t==null||(Kt||(Kt=document.createElementNS("http://www.w3.org/2000/svg","g")),Kt.setAttribute("transform",t),!(t=Kt.transform.baseVal.consolidate()))?Ue:(t=t.matrix,Qr(t.a,t.b,t.c,t.d,t.e,t.f))}function zr(t,e,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,c,f,d,p,g){if(u!==f||c!==d){var x=p.push("translate(",null,e,null,n);g.push({i:x-4,x:q(u,f)},{i:x-2,x:q(c,d)})}else(f||d)&&p.push("translate("+f+e+d+n)}function s(u,c,f,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:q(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(u,c,f,d){u!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:q(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,d,p,g){if(u!==f||c!==d){var x=p.push(i(p)+"scale(",null,",",null,")");g.push({i:x-4,x:q(u,f)},{i:x-2,x:q(c,d)})}else(f!==1||d!==1)&&p.push(i(p)+"scale("+f+","+d+")")}return function(u,c){var f=[],d=[];return u=t(u),c=t(c),o(u.translateX,u.translateY,c.translateX,c.translateY,f,d),s(u.rotate,c.rotate,f,d),a(u.skewX,c.skewX,f,d),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,d),u=c=null,function(p){for(var g=-1,x=d.length,v;++g<x;)f[(v=d[g]).i]=v.x(p);return f.join("")}}}var Oa=zr(ka,"px, ","px)","deg)"),La=zr(Fa,", ",")",")"),Ft=0,Bt=0,It=0,Gr=1e3,he,Rt,me=0,yt=0,ve=0,Xt=typeof performance=="object"&&performance.now?performance:Date,Wr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function sn(){return yt||(Wr(Ia),yt=Xt.now()+ve)}function Ia(){yt=0}function pe(){this._call=this._time=this._next=null}pe.prototype=Kr.prototype={constructor:pe,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?sn():+n)+(e==null?0:+e),!this._next&&Rt!==this&&(Rt?Rt._next=this:he=this,Rt=this),this._call=t,this._time=n,je()},stop:function(){this._call&&(this._call=null,this._time=1/0,je())}};function Kr(t,e,n){var r=new pe;return r.restart(t,e,n),r}function $a(){sn(),++Ft;for(var t=he,e;t;)(e=yt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ft}function Fn(){yt=(me=Xt.now())+ve,Ft=Bt=0;try{$a()}finally{Ft=0,Ra(),yt=0}}function Ba(){var t=Xt.now(),e=t-me;e>Gr&&(ve-=e,me=t)}function Ra(){for(var t,e=he,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:he=n);Rt=t,je(r)}function je(t){if(!Ft){Bt&&(Bt=clearTimeout(Bt));var e=t-yt;e>24?(t<1/0&&(Bt=setTimeout(Fn,t-Xt.now()-ve)),It&&(It=clearInterval(It))):(It||(me=Xt.now(),It=setInterval(Ba,Gr)),Ft=1,Wr(Fn))}}function On(t,e,n){var r=new pe;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Da=Pr("start","end","cancel","interrupt"),Ua=[],Zr=0,Ln=1,He=2,ee=3,In=4,Ve=5,ne=6;function we(t,e,n,r,i,o){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;ja(t,n,{name:e,index:r,group:i,on:Da,tween:Ua,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Zr})}function an(t,e){var n=z(t,e);if(n.state>Zr)throw new Error("too late; already scheduled");return n}function rt(t,e){var n=z(t,e);if(n.state>ee)throw new Error("too late; already running");return n}function z(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ja(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Kr(o,0,n.time);function o(u){n.state=Ln,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var c,f,d,p;if(n.state!==Ln)return l();for(c in r)if(p=r[c],p.name===n.name){if(p.state===ee)return On(s);p.state===In?(p.state=ne,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete r[c]):+c<e&&(p.state=ne,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete r[c])}if(On(function(){n.state===ee&&(n.state=In,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=He,n.on.call("start",t,t.__data__,n.index,n.group),n.state===He){for(n.state=ee,i=new Array(d=n.tween.length),c=0,f=-1;c<d;++c)(p=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++f]=p);i.length=f+1}}function a(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=Ve,1),f=-1,d=i.length;++f<d;)i[f].call(t,c);n.state===Ve&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=ne,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function Ha(t,e){var n=t.__transition,r,i,o=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){o=!1;continue}i=r.state>He&&r.state<Ve,r.state=ne,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}o&&delete t.__transition}}function Va(t){return this.each(function(){Ha(this,t)})}function Xa(t,e){var n,r;return function(){var i=rt(this,t),o=i.tween;if(o!==n){r=n=o;for(var s=0,a=r.length;s<a;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Ya(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=rt(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=a;break}l===u&&i.push(a)}o.tween=i}}function qa(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=z(this.node(),n).tween,i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((e==null?Xa:Ya)(n,t,e))}function ln(t,e,n){var r=t._id;return t.each(function(){var i=rt(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return z(i,r).value[e]}}function Jr(t,e){var n;return(typeof e=="number"?q:e instanceof pt?de:(n=pt(e))?(e=n,de):qr)(t,e)}function Qa(t){return function(){this.removeAttribute(t)}}function za(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ga(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttribute(t);return s===i?null:s===r?o:o=e(r=s,n)}}function Wa(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?o:o=e(r=s,n)}}function Ka(t,e,n){var r,i,o;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(t):(s=this.getAttribute(t),l=a+"",s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,a)))}}function Za(t,e,n){var r,i,o;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),l=a+"",s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,a)))}}function Ja(t,e){var n=be(t),r=n==="transform"?La:Jr;return this.attrTween(t,typeof e=="function"?(n.local?Za:Ka)(n,r,ln(this,"attr."+t,e)):e==null?(n.local?za:Qa)(n):(n.local?Wa:Ga)(n,r,e))}function tl(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function el(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function nl(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&el(t,o)),n}return i._value=e,i}function rl(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&tl(t,o)),n}return i._value=e,i}function il(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=be(t);return this.tween(n,(r.local?nl:rl)(r,e))}function ol(t,e){return function(){an(this,t).delay=+e.apply(this,arguments)}}function sl(t,e){return e=+e,function(){an(this,t).delay=e}}function al(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ol:sl)(e,t)):z(this.node(),e).delay}function ll(t,e){return function(){rt(this,t).duration=+e.apply(this,arguments)}}function ul(t,e){return e=+e,function(){rt(this,t).duration=e}}function cl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ll:ul)(e,t)):z(this.node(),e).duration}function fl(t,e){if(typeof e!="function")throw new Error;return function(){rt(this,t).ease=e}}function dl(t){var e=this._id;return arguments.length?this.each(fl(e,t)):z(this.node(),e).ease}function hl(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;rt(this,t).ease=n}}function ml(t){if(typeof t!="function")throw new Error;return this.each(hl(this._id,t))}function pl(t){typeof t!="function"&&(t=Or(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=[],l,u=0;u<s;++u)(l=o[u])&&t.call(l,l.__data__,u,o)&&a.push(l);return new ot(r,this._parents,this._name,this._id)}function yl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l=e[a],u=n[a],c=l.length,f=s[a]=new Array(c),d,p=0;p<c;++p)(d=l[p]||u[p])&&(f[p]=d);for(;a<r;++a)s[a]=e[a];return new ot(s,this._parents,this._name,this._id)}function gl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function _l(t,e,n){var r,i,o=gl(e)?an:rt;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}function xl(t,e){var n=this._id;return arguments.length<2?z(this.node(),n).on.on(t):this.each(_l(n,t,e))}function bl(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function vl(){return this.on("end.remove",bl(this._id))}function wl(t){var e=this._name,n=this._id;typeof t!="function"&&(t=tn(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a=r[s],l=a.length,u=o[s]=new Array(l),c,f,d=0;d<l;++d)(c=a[d])&&(f=t.call(c,c.__data__,d,a))&&("__data__"in c&&(f.__data__=c.__data__),u[d]=f,we(u[d],e,n,d,u,z(c,n)));return new ot(o,this._parents,e,n)}function Al(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Fr(t));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var l=r[a],u=l.length,c,f=0;f<u;++f)if(c=l[f]){for(var d=t.call(c,c.__data__,f,l),p,g=z(c,n),x=0,v=d.length;x<v;++x)(p=d[x])&&we(p,e,n,x,d,g);o.push(d),s.push(c)}return new ot(o,s,e,n)}var Ml=Yt.prototype.constructor;function Sl(){return new Ml(this._groups,this._parents)}function Cl(t,e){var n,r,i;return function(){var o=kt(this,t),s=(this.style.removeProperty(t),kt(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}function ti(t){return function(){this.style.removeProperty(t)}}function Tl(t,e,n){var r,i=n+"",o;return function(){var s=kt(this,t);return s===i?null:s===r?o:o=e(r=s,n)}}function El(t,e,n){var r,i,o;return function(){var s=kt(this,t),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),kt(this,t))),s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,a))}}function Nl(t,e){var n,r,i,o="style."+e,s="end."+o,a;return function(){var l=rt(this,t),u=l.on,c=l.value[o]==null?a||(a=ti(e)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(s,i=c),l.on=r}}function Pl(t,e,n){var r=(t+="")=="transform"?Oa:Jr;return e==null?this.styleTween(t,Cl(t,r)).on("end.style."+t,ti(t)):typeof e=="function"?this.styleTween(t,El(t,r,ln(this,"style."+t,e))).each(Nl(this._id,t)):this.styleTween(t,Tl(t,r,e),n).on("end.style."+t,null)}function kl(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Fl(t,e,n){var r,i;function o(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&kl(t,s,n)),r}return o._value=e,o}function Ol(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Fl(t,e,n??""))}function Ll(t){return function(){this.textContent=t}}function Il(t){return function(){var e=t(this);this.textContent=e??""}}function $l(t){return this.tween("text",typeof t=="function"?Il(ln(this,"text",t)):Ll(t==null?"":t+""))}function Bl(t){return function(e){this.textContent=t.call(this,e)}}function Rl(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Bl(i)),e}return r._value=t,r}function Dl(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Rl(t))}function Ul(){for(var t=this._name,e=this._id,n=ei(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,l,u=0;u<a;++u)if(l=s[u]){var c=z(l,e);we(l,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ot(r,this._parents,t,n)}function jl(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,s){var a={value:s},l={value:function(){--i===0&&o()}};n.each(function(){var u=rt(this,r),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),u.on=e}),i===0&&o()})}var Hl=0;function ot(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function ei(){return++Hl}var it=Yt.prototype;ot.prototype={constructor:ot,select:wl,selectAll:Al,selectChild:it.selectChild,selectChildren:it.selectChildren,filter:pl,merge:yl,selection:Sl,transition:Ul,call:it.call,nodes:it.nodes,node:it.node,size:it.size,empty:it.empty,each:it.each,on:xl,attr:Ja,attrTween:il,style:Pl,styleTween:Ol,text:$l,textTween:Dl,remove:vl,tween:qa,delay:al,duration:cl,ease:dl,easeVarying:ml,end:jl,[Symbol.iterator]:it[Symbol.iterator]};function Vl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Xl={time:null,delay:0,duration:250,ease:Vl};function Yl(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function ql(t){var e,n;t instanceof ot?(e=t._id,t=t._name):(e=ei(),(n=Xl).time=sn(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,l,u=0;u<a;++u)(l=s[u])&&we(l,t,e,u,s,n||Yl(l,e));return new ot(r,this._parents,t,e)}Yt.prototype.interrupt=Va;Yt.prototype.transition=ql;const Xe=Math.PI,Ye=2*Xe,ft=1e-6,Ql=Ye-ft;function ni(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function zl(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return ni;const n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Gl{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?ni:zl(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,s){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,l=r-e,u=i-n,c=s-e,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(d>ft)if(!(Math.abs(f*l-u*c)>ft)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let p=r-s,g=i-a,x=l*l+u*u,v=p*p+g*g,S=Math.sqrt(x),w=Math.sqrt(d),M=o*Math.tan((Xe-Math.acos((x+d-v)/(2*S*w)))/2),I=M/w,C=M/S;Math.abs(I-1)>ft&&this._append`L${e+I*c},${n+I*f}`,this._append`A${o},${o},0,0,${+(f*p>c*g)},${this._x1=e+C*l},${this._y1=n+C*u}`}}arc(e,n,r,i,o,s){if(e=+e,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),l=r*Math.sin(i),u=e+a,c=n+l,f=1^s,d=s?i-o:o-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>ft||Math.abs(this._y1-c)>ft)&&this._append`L${u},${c}`,r&&(d<0&&(d=d%Ye+Ye),d>Ql?this._append`A${r},${r},0,1,${f},${e-a},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:d>ft&&this._append`A${r},${r},0,${+(d>=Xe)},${f},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Wl(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ye(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Ot(t){return t=ye(Math.abs(t)),t?t[1]:NaN}function Kl(t,e){return function(n,r){for(var i=n.length,o=[],s=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(n.substring(i-=a,i+a)),!((l+=a+1)>r));)a=t[s=(s+1)%t.length];return o.reverse().join(e)}}function Zl(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Jl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ge(t){if(!(e=Jl.exec(t)))throw new Error("invalid format: "+t);var e;return new un({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ge.prototype=un.prototype;function un(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}un.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function tu(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var ri;function eu(t,e){var n=ye(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(ri=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+ye(t,Math.max(0,e+o-1))[0]}function $n(t,e){var n=ye(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Bn={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Wl,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>$n(t*100,e),r:$n,s:eu,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Rn(t){return t}var Dn=Array.prototype.map,Un=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function nu(t){var e=t.grouping===void 0||t.thousands===void 0?Rn:Kl(Dn.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Rn:Zl(Dn.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(f){f=ge(f);var d=f.fill,p=f.align,g=f.sign,x=f.symbol,v=f.zero,S=f.width,w=f.comma,M=f.precision,I=f.trim,C=f.type;C==="n"?(w=!0,C="g"):Bn[C]||(M===void 0&&(M=12),I=!0,C="g"),(v||d==="0"&&p==="=")&&(v=!0,d="0",p="=");var k=x==="$"?n:x==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",E=x==="$"?r:/[%p]/.test(C)?s:"",N=Bn[C],y=/[defgprs%]/.test(C);M=M===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function b(_){var T=k,P=E,B,G,H;if(C==="c")P=N(_)+P,_="";else{_=+_;var O=_<0||1/_<0;if(_=isNaN(_)?l:N(Math.abs(_),M),I&&(_=tu(_)),O&&+_==0&&g!=="+"&&(O=!1),T=(O?g==="("?g:a:g==="-"||g==="("?"":g)+T,P=(C==="s"?Un[8+ri/3]:"")+P+(O&&g==="("?")":""),y){for(B=-1,G=_.length;++B<G;)if(H=_.charCodeAt(B),48>H||H>57){P=(H===46?i+_.slice(B+1):_.slice(B))+P,_=_.slice(0,B);break}}}w&&!v&&(_=e(_,1/0));var F=T.length+_.length+P.length,$=F<S?new Array(S-F+1).join(d):"";switch(w&&v&&(_=e($+_,$.length?S-P.length:1/0),$=""),p){case"<":_=T+_+P+$;break;case"=":_=T+$+_+P;break;case"^":_=$.slice(0,F=$.length>>1)+T+_+P+$.slice(F);break;default:_=$+T+_+P;break}return o(_)}return b.toString=function(){return f+""},b}function c(f,d){var p=u((f=ge(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(Ot(d)/3)))*3,x=Math.pow(10,-g),v=Un[8+g/3];return function(S){return p(x*S)+v}}return{format:u,formatPrefix:c}}var Zt,Ae,ii;ru({thousands:",",grouping:[3],currency:["$",""]});function ru(t){return Zt=nu(t),Ae=Zt.format,ii=Zt.formatPrefix,Zt}function iu(t){return Math.max(0,-Ot(Math.abs(t)))}function ou(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ot(e)/3)))*3-Ot(Math.abs(t)))}function su(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ot(e)-Ot(t))+1}function au(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function lu(t){return function(){return t}}function uu(t){return+t}var jn=[0,1];function Nt(t){return t}function qe(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:lu(isNaN(e)?NaN:.5)}function cu(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function fu(t,e,n){var r=t[0],i=t[1],o=e[0],s=e[1];return i<r?(r=qe(i,r),o=n(s,o)):(r=qe(r,i),o=n(o,s)),function(a){return o(r(a))}}function du(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)i[s]=qe(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(a){var l=co(t,a,1,r)-1;return o[l](i[l](a))}}function hu(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function mu(){var t=jn,e=jn,n=on,r,i,o,s=Nt,a,l,u;function c(){var d=Math.min(t.length,e.length);return s!==Nt&&(s=cu(t[0],t[d-1])),a=d>2?du:fu,l=u=null,f}function f(d){return d==null||isNaN(d=+d)?o:(l||(l=a(t.map(r),e,n)))(r(s(d)))}return f.invert=function(d){return s(i((u||(u=a(e,t.map(r),q)))(d)))},f.domain=function(d){return arguments.length?(t=Array.from(d,uu),c()):t.slice()},f.range=function(d){return arguments.length?(e=Array.from(d),c()):e.slice()},f.rangeRound=function(d){return e=Array.from(d),n=Pa,c()},f.clamp=function(d){return arguments.length?(s=d?!0:Nt,c()):s!==Nt},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,p){return r=d,i=p,c()}}function pu(){return mu()(Nt,Nt)}function yu(t,e,n,r){var i=yo(t,e,n),o;switch(r=ge(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=ou(i,s))&&(r.precision=o),ii(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=su(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=iu(i))&&(r.precision=o-(r.type==="%")*2);break}}return Ae(r)}function gu(t){var e=t.domain;return t.ticks=function(n){var r=e();return po(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return yu(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,s=r[i],a=r[o],l,u,c=10;for(a<s&&(u=s,s=a,a=u,u=i,i=o,o=u);c-- >0;){if(u=Ie(s,a,n),u===l)return r[i]=s,r[o]=a,e(r);if(u>0)s=Math.floor(s/u)*u,a=Math.ceil(a/u)*u;else if(u<0)s=Math.ceil(s*u)/u,a=Math.floor(a*u)/u;else break;l=u}return t},t}function Qe(){var t=pu();return t.copy=function(){return hu(t,Qe())},au.apply(t,arguments),gu(t)}function Ct(t){return function(){return t}}function _u(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Gl(e)}function xu(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function oi(t){this._context=t}oi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function bu(t){return new oi(t)}function vu(t){return t[0]}function wu(t){return t[1]}function Au(t,e){var n=Ct(!0),r=null,i=bu,o=null,s=_u(a);t=typeof t=="function"?t:t===void 0?vu:Ct(t),e=typeof e=="function"?e:e===void 0?wu:Ct(e);function a(l){var u,c=(l=xu(l)).length,f,d=!1,p;for(r==null&&(o=i(p=s())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+t(f,u,l),+e(f,u,l));if(p)return o=null,p+""||null}return a.x=function(l){return arguments.length?(t=typeof l=="function"?l:Ct(+l),a):t},a.y=function(l){return arguments.length?(e=typeof l=="function"?l:Ct(+l),a):e},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Ct(!!l),a):n},a.curve=function(l){return arguments.length?(i=l,r!=null&&(o=i(r)),a):i},a.context=function(l){return arguments.length?(l==null?r=o=null:o=i(r=l),a):r},a}function Dt(t,e,n){this.k=t,this.x=e,this.y=n}Dt.prototype={constructor:Dt,scale:function(t){return t===1?this:new Dt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Dt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Dt.prototype;function Hn(t){return+t.toFixed(3)}const Mu="_PointAnchorContainer_1lvdx_1",Su="_PointAnchor_1lvdx_1",Cu="_LabelAnchor_1lvdx_30",Tu="_FloatingLabel_1lvdx_40",Eu="_FloatingLabelContent_1lvdx_52",Nu="_PointingLine_1lvdx_60",Tt={PointAnchorContainer:Mu,PointAnchor:Su,LabelAnchor:Cu,FloatingLabel:Tu,FloatingLabelContent:Eu,PointingLine:Nu};function Pu(t,e,n){let r=e.x,i=e.y;return r<t.x?(r=t.x,i<t.y?i=t.y:i+e.height>t.y+t.height&&(i=t.y+t.height-e.height)):r>=t.x&&r+e.width<=t.x+t.width?i<t.y?i=t.y:i+e.height>t.y+t.height&&(i=t.y+t.height-e.height):r+e.width>t.x+t.width&&(r=t.x+t.width-e.width,i<t.y?i=t.y:i+e.height>t.y+t.height&&(i=t.y+t.height-e.height)),r>=t.x+t.width-e.width&&n.x>=t.x+t.width-e.width&&(r=r-e.width),i>=t.y+t.height-e.height&&n.y>=t.y+t.height-e.height&&(i=i-e.height),{x:r,y:i}}const ku=m.memo(function({targetPoint:e,showTargetPointMarker:n=!1,elementWithTargetPointRef:r,children:i}){const o=m.useRef(null),s=m.useRef(null),[a,l]=m.useState(void 0),[u,c]=m.useState(void 0),[f,d]=m.useState(void 0),[p,g]=m.useState(void 0);return m.useEffect(function(){const v=o?.current,S=s.current;if(!v||!S){g(void 0);return}const w=v.getBoundingClientRect(),M=S.getBoundingClientRect();g({xOffset:M.x-w.x,yOffset:M.y-w.y})},[r,s,g]),m.useEffect(function(){function v(){l(void 0),c(void 0),d(void 0)}const S=r?.current;if(!S||!e){v();return}const w=S.getBoundingClientRect(),M=Math.min(Math.max(0,e.x),w.width),I=Math.min(Math.max(0,e.y),w.height);l({x:M,y:I});const C=o.current;if(!C){v();return}const k=w,E=C.getBoundingClientRect(),N=M+w.x,y=I+w.y,b={x:N,y,width:E.width,height:E.height},_={x:M+w.x,y:I+w.y},T=Pu(k,b,_),P={x:T.x-w.x,y:T.y-w.y};if(c(P),!!p)return d({x:P.x+p.xOffset,y:P.y+p.yOffset}),function(){v()}},[e,r,l,c,d,o,p]),h.jsxs("div",{className:Tt.PointAnchorContainer,children:[!!a&&!!f&&h.jsx("svg",{className:Tt.PointingLine,id:"line-between-target-point-and-tooltip",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("line",{x1:a.x,y1:a.y,x2:f.x,y2:f.y})}),n&&!!a&&h.jsx("div",{className:Tt.PointAnchor,style:{left:a?.x,top:a?.y}}),h.jsx("div",{ref:o,className:wr([Tt.LabelAnchor]),style:{left:u?.x||-1e3,top:u?.y||-1e3},children:h.jsx("div",{className:Tt.FloatingLabel,children:h.jsx("div",{ref:s,className:Tt.FloatingLabelContent,children:i})})})]})}),Fu="_PlotContainer_15u0v_1",Ou="_IsVisible_15u0v_9",Lu="_PriceLineTooltipContent_15u0v_13",Le={PlotContainer:Fu,IsVisible:Ou,PriceLineTooltipContent:Lu},Iu="_PriceLinePlotBody_1mnlz_1",$u="_XAxis_1mnlz_15",Bu="_Tick_1mnlz_15",Ru="_YAxis_1mnlz_16",Du="_XAxisTitle_1mnlz_20",Uu="_YAxisTitle_1mnlz_21",ju="_LineWithMissingData_1mnlz_26",Hu="_Line_1mnlz_26",Vu="_DotGroupOnLine_1mnlz_35",Xu="_DotOnLine_1mnlz_39",Yu="_PointerDot_1mnlz_44",j={PriceLinePlotBody:Iu,XAxis:$u,Tick:Bu,YAxis:Ru,XAxisTitle:Du,YAxisTitle:Uu,LineWithMissingData:ju,Line:Hu,DotGroupOnLine:Vu,DotOnLine:Xu,PointerDot:Yu};function Vn(t,e,n=5){const r=t.getBoundingClientRect(),i=e.getBoundingClientRect(),o=t.getScreenCTM();let s=t.createSVGPoint(),a=t.createSVGPoint();s.x=i.x,s.y=i.y,a.x=r.x,a.y=r.y,s=s.matrixTransform(o?.inverse()),a=a.matrixTransform(o?.inverse());let l=s.x-a.x,u=s.y-a.y;return l<=n&&(l=0),u<=n&&(u=0),{x:l,y:u}}const qu=Ae(".3~s"),Qu=Ae(".3~s"),Xn="+";function Et(t,e=!1){const n=Math.abs(t.valueOf());return!e&&n>.001&&n<1e3?`${+t.valueOf().toFixed(3)}`:`${qu(t)}`}function Yn(t,e=!1){const n=Math.abs(t.valueOf());return!e&&n>.001&&n<1e3?`${Xn}${+t.valueOf().toFixed(3)}`:`${Xn}${Qu(t)}`}const zu=m.memo(function({preparedData:e,width:n=500,height:r=250,marginTop:i=18,marginRight:o=0,marginBottom:s=20,marginLeft:a=60,innerTickLength:l=6,outerTickLength:u=12,xAxisTitleMarginBottom:c=-5,yAxisTitleMarginTop:f=10,priceAxisName:d="price",markAxisName:p="quantity",pointRef:g,setMarkValueOfSelectedPoint:x,adjustedMarginLeft:v,setAdjustedMarginLeft:S,setIsAdjustedMarginLeft:w,adjustedMarginBottom:M,setAdjustedMarginBottom:I,setIsAdjustedMarginBottom:C,xScale:k,yScale:E}){const N=m.useMemo(()=>Au().defined(O=>Number.isFinite(O[0])&&Number.isFinite(O[1])).x(O=>k(O[1])).y(O=>E(O[0])),[k,E]),y=m.useRef(null),b=m.useRef(null),_=m.useRef(null);m.useEffect(function(){const F=_.current;if(!F)return;const $=k.domain(),D=k.ticks().length>1&&Et($[0])===Et($[1]);wn(F).attr("class",j.XAxis).call(Ao(k).tickFormat(function(R,W){return D&&W!==0?Yn(R.valueOf()-$[0]):Et(R)})).call(A=>A.select(".domain").remove()).call(A=>A.selectAll(".cloned").remove()).call(A=>A.selectAll(".tick").classed(j.Tick,!0)).call(A=>A.selectAll(".tick text").append("title").text(R=>`${R}`)).call(A=>A.selectAll(".tick line").clone().attr("y1",-r+i+M).attr("stroke-opacity",.1).attr("stroke-dasharray","0.25em").attr("class","cloned")).call(A=>A.select(`.${j.XAxisTitle}`).remove()).call(A=>A.append("text").attr("class",j.XAxisTitle).attr("x",n).attr("y",M+c).attr("fill","currentColor").attr("text-anchor","end").text(`${p} ${D?"Δ":""} →`))},[_,k,l,u,r,n,M,i,c,p]),m.useEffect(function(){const F=b.current;if(!F)return;const $=E.domain(),D=E.ticks().length>1&&Et($[0])===Et($[1]);wn(F).attr("class",j.YAxis).call(Mo(E).tickFormat(function(R,W){return D&&W!==0?Yn(R.valueOf()-$[0]):Et(R)})).call(A=>A.select(".domain").remove()).call(A=>A.selectAll(".cloned").remove()).call(A=>A.selectAll(".tick").classed(j.Tick,!0)).call(A=>A.selectAll(".tick text").attr("dy","0").attr("dominant-baseline","middle")).call(A=>A.selectAll(".tick text").append("title").text(R=>`${R}`)).call(A=>A.selectAll(".tick line").clone().attr("x2",n-v-o).attr("stroke-opacity",.1).attr("stroke-dasharray","0.25em").attr("class","cloned")).call(A=>A.select(`.${j.YAxisTitle}`).remove()).call(A=>A.append("text").attr("class",j.YAxisTitle).attr("x",0).attr("y",f).attr("fill","currentColor").attr("text-anchor","end").text(`↑ ${d} ${D?"Δ":""}`))},[b,E,l,u,v,o,n,f,d]),m.useEffect(function(){const F=y.current,$=b.current;if(!F||!$)return;const D=Vn(F,$).x;Math.abs(D)>0&&S(a-D),w(!0)},[y,b,S,a,w]),m.useEffect(function(){const F=y.current,$=_.current;if(!F||!$)return;const D=Vn(F,$).y;Math.abs(D)>0&&I(s+D),C(!0)},[y,_,I,s,C]);const T=m.useMemo(()=>N(e.filter(O=>Number.isFinite(O[0])&&Number.isFinite(O[1])))||void 0,[e,N]),P=m.useMemo(()=>N(e)||void 0,[e,N]),B=m.useMemo(()=>Je(O=>O[1]).center,[]),G=m.useCallback(function(F){if(!e.length||!k||!E)return;const $=B(e,k.invert(aa(F)[0]));x($)},[B,e,k,E,x]),H=m.useCallback(function(){x(void 0)},[x]);return h.jsxs("svg",{ref:y,className:j.PriceLinePlotBody,width:"100%",viewBox:`0 0 ${n} ${r}`,onMouseMove:G,onMouseLeave:H,role:"application",children:[h.jsx("g",{ref:_,className:j.XAxis,transform:`translate(0,${r-M})`}),h.jsx("g",{ref:b,className:j.YAxis,transform:`translate(${v},0)`}),!!T&&h.jsx("path",{fill:"none",stroke:"gray",strokeWidth:"1",d:T,className:j.LineWithMissingData}),!!P&&h.jsx("path",{fill:"none",stroke:"lightgray",strokeWidth:"1",d:P,className:j.Line}),h.jsx("g",{fill:"white",stroke:"currentColor",strokeWidth:"1",className:j.DotGroupOnLine,children:e.map((O,F)=>h.jsx("circle",{cx:k(O[1]),cy:E(O[0]),r:"1.5",className:j.DotOnLine},F))}),h.jsx("g",{ref:g,transform:"translate(-1000,-1000)",className:j.PointerDot,children:h.jsx("circle",{x:"0",y:"0",stroke:"currentColor",strokeWidth:"1",r:"2.5",fill:"currentColor"})})]})}),Gu=m.memo(function({data:e,width:n=500,height:r=250,marginTop:i=18,marginRight:o=9,marginBottom:s=20,marginLeft:a=60,plotDomainPadding:l=10,innerTickLength:u=6,outerTickLength:c=12,xAxisTitleMarginBottom:f=-5,yAxisTitleMarginTop:d=10,priceAxisName:p="price",markAxisName:g="quantity"}){const[x,v]=m.useState(a),[S,w]=m.useState(s),[M,I]=m.useState(!1),[C,k]=m.useState(!1),E=M&&C,N=m.useMemo(()=>e.filter(A=>Number.isFinite(A[1])).sort((A,R)=>A[1]-R[1]),[e]),y=m.useMemo(()=>{let A=_n(N,R=>R[1]);return(A[0]===void 0||A[1]===void 0)&&(A=[0,1]),A},[N]),b=m.useMemo(()=>{let A=_n(N,R=>R[0]);return(A[0]===void 0||A[1]===void 0)&&(A=[0,1]),A},[N]),_=m.useMemo(()=>Qe().domain(y).nice().rangeRound([x+l,n-o-l]),[y,x,o,l,n]),T=m.useMemo(()=>Qe().domain(b).nice().rangeRound([r-S-l,i+l]),[b,i,S,l,r]),P=m.useRef(null),[B,G]=m.useState(void 0),H=m.useRef(null),[O,F]=m.useState(void 0),$=m.useMemo(()=>B!==void 0?N[B]?.[0]:void 0,[N,B]),D=m.useMemo(()=>B!==void 0?N[B]?.[1]:void 0,[N,B]);return m.useEffect(function(){const R=P.current;if(!R){F(void 0);return}if(B===void 0){F(void 0);return}const W=N[B];if(!W){F(void 0);return}const[bt,vt]=W,wt={x:cn(vt)?Hn(_(vt)):0,y:cn(bt)?Hn(T(bt)):0};R.setAttribute("transform",`translate(${wt.x},${wt.y})`);const At=H.current;if(!At){F(void 0);return}const Mt=At.getBoundingClientRect(),lt=R.getBoundingClientRect();return F({x:lt.x+lt.width/2-Mt.x,y:lt.y+lt.height/2-Mt.y}),function(){R.setAttribute("transform","translate(-1000,-1000)")}},[B,N,_,T]),h.jsxs("div",{ref:H,className:wr([Le.PlotContainer,E&&Le.IsVisible]),children:[h.jsx(zu,{preparedData:N,width:n,height:r,marginTop:i,marginRight:o,marginBottom:s,marginLeft:a,innerTickLength:u,outerTickLength:c,xAxisTitleMarginBottom:f,yAxisTitleMarginTop:d,priceAxisName:p,markAxisName:g,pointRef:P,setMarkValueOfSelectedPoint:G,adjustedMarginLeft:x,setAdjustedMarginLeft:v,setIsAdjustedMarginLeft:I,adjustedMarginBottom:S,setAdjustedMarginBottom:w,setIsAdjustedMarginBottom:k,xScale:_,yScale:T}),D!==void 0&&h.jsx(ku,{elementWithTargetPointRef:H,targetPoint:O,children:h.jsxs("div",{className:Le.PriceLineTooltipContent,children:[h.jsx("span",{children:"Price:"}),h.jsx("span",{children:$}),h.jsx("span",{children:"Quantity:"}),h.jsx("span",{children:D})]})})]})}),Wu=m.memo(function({order:e,onHideModal:n,onHideParentModal:r}){const i=st([tt,_t,ut,xt]),o=nt([at]),s=i||o,a=m.useCallback(function(){n()},[n]),l=m.useCallback(function(){Kn(e.uuid),a(),r()},[e,a,r]),u=m.useMemo(function(){const f=!s&&gt(e.productUuid)?.name||"(product without name)",d=!s&&Lt(e.locationUuid)||"(location without name)";let p="";return e.entityType===xe?p="sell":e.entityType===_e&&(p="buy"),h.jsxs(h.Fragment,{children:["Are you sure you want"," ",h.jsx("strong",{children:"to delete"})," ",h.jsx("strong",{children:"price history"}),h.jsx("br",{}),"of the"," ",p," ","order for"," ",h.jsx("strong",{children:f}),h.jsx("br",{}),"in"," ",h.jsx("strong",{children:d})," ","?"]})},[e,s]);return h.jsx(pr,{title:u,onHide:a,onConfirm:l,confirmButtonLabel:"delete price history"})}),Ku="_ModalBody_tz1ce_1",Zu="_Content_tz1ce_11",Ju="_NoData_tz1ce_19",tc="_TitleWithButton_tz1ce_27",re={ModalBody:Ku,Content:Zu,NoData:Ju,TitleWithButton:tc},ec=m.memo(function({formTitle:e,hasEnoughDataForPlot:n,handleShowDeletePriceAtMarksConfirmation:r,deleteItemButtonLabel:i}){return h.jsxs("div",{className:re.TitleWithButton,children:[e,n&&h.jsx(K,{noPadding:!0,transparent:!0,onClick:r,title:i,children:h.jsx(jt,{name:"delete_forever"})})]})}),si=m.memo(function({order:e,deleteItemButtonLabel:n="delete price records",onHideModal:r}){const i=st([tt,_t,ut,xt]),o=nt([at]),s=i||o,a=m.useMemo(function(){if(s)return;const v=Ge(e.uuid);if(v)return v},[e,s]),l=m.useMemo(function(){return a?.pricesAtMarks??[]},[a]),u=m.useCallback(function(){r()},[r]),c=m.useMemo(function(){const v=l?.length||0,S=!s&&gt(e.productUuid)?.name||"(product without name)",w=!s&&Lt(e.locationUuid)||"(location without name)";return h.jsxs(h.Fragment,{children:[e.entityType==="sell-order"&&"sell"||e.entityType==="buy-order"&&"buy"," ","order for"," ",h.jsx("strong",{children:S}),h.jsx("br",{}),"at"," ",h.jsx("strong",{children:w}),h.jsx("br",{}),"( total"," ",v," ","record",v>1?"s":""," ",v>=fn&&`max ${fn} records`," ",")"]})},[e,l,s]),{isVisible:f,show:d,hide:p}=Ut(!1),g=mi(a);return h.jsxs(h.Fragment,{children:[h.jsx(mr,{title:h.jsx(ec,{formTitle:"Price dynamic",deleteItemButtonLabel:n,handleShowDeletePriceAtMarksConfirmation:d,hasEnoughDataForPlot:g}),subTitle:c,onHide:u,children:h.jsx("div",{className:re.ModalBody,children:h.jsx("div",{className:re.Content,children:g?h.jsx(Gu,{data:l}):h.jsx("div",{className:re.NoData,children:"No data"})})})}),f&&h.jsx(Wu,{onHideModal:p,onHideParentModal:u,order:e})]})});function ai({item:t,setOrderForPriceChart:e}){const n=st([tt]),r=m.useCallback(function(){e(t)},[t,e]),i=!n&&pi(t.uuid);return h.jsx(h.Fragment,{children:i?h.jsx(K,{transparent:!0,noPadding:!0,noBorder:!0,isAlwaysVisible:!0,onClick:r,title:"show price chart",children:h.jsx(jt,{name:"monitoring"})}):h.jsx(K,{transparent:!0,noPadding:!0,noBorder:!0,disabled:!0,title:"no price data",children:h.jsx(jt,{name:"bid_landscape_disabled"})})})}function nc({name:t,label:e,value:n}){const r=nt([at]);if(!n)return;const i=r||!wi(n)?void 0:Lt(n);return i?{label:e??t?.toString(),value:i}:{label:e??t?.toString(),value:"(location without name)"}}function rc({filterValue:t}){if(!t)return;let e="",n="";const r=t.minPrice,i=t.maxPrice;if(!(!r&&!i))return r&&i?(e="price",n=`${r} - ${i}`):r?(e="min price",n=`${r}`):i&&(e="max price",n=`${i}`),{label:e,value:n}}function ic({filterValue:t}){if(!t)return;const e=t.minQuantity,n=t.maxQuantity;if(!e&&!n)return;let r="",i="";return e&&n?(r="quantity",i=`${e} - ${n}`):e?(r="min quantity",i=`${e}`):n&&(r="max quantity",i=`${n}`),{label:r,value:i}}function li(){return[{name:"locationUuid",label:"location",formatLabelAndValue:nc},{name:"quantity",groupNames:["minQuantity","maxQuantity"],formatLabelAndValue:ic},{name:"price",groupNames:["minPrice","maxPrice"],formatLabelAndValue:rc}]}const oc=["productUuid","desirableQuantity","price","locationUuid"];function sc(t){return[{name:"uuid",isCheckbox:!0},{name:"productUuid",label:"product",asLinkToEditItem:!0,isSortable:!0,alignLabel:"left",formatValue:cr,actionButtons:ur,sortFn:lr},{name:"desirableQuantity",label:"stock",type:"number",isSortable:!0,formatValue:fr},{name:"price",type:"number",isSortable:!0,sort:"desc",formatValue:dr,actionButtons:({item:e})=>h.jsx(ai,{item:e,setOrderForPriceChart:t})},{name:"locationUuid",label:"location",alignLabel:"right",isSortable:!0,formatValue:Mr,actionButtons:hr,sortFn:Ar}]}const ac=m.memo(function({searchFieldValue:e,buyOrderFilterValue:n,setBuyOrderFilterValue:r,resetSearchFieldValue:i}){const[o,s]=m.useState(!1),[a,l]=m.useState(),[u,c]=m.useState(),f=J(Zn(L=>L.items())),d=st([Z,J,_t,ut,xt]),p=nt([at]),g=d||p,x=J(L=>L.deleteMultiple),v=Z(L=>L.createMultiple),S=m.useCallback(()=>{r(void 0)},[r]),w=m.useCallback(()=>{s(!0)},[s]),M=m.useCallback(()=>{l(void 0),s(!1)},[l,s]),I=m.useCallback(L=>{c(L)},[c]),C=m.useCallback(()=>{c(void 0)},[c]),[k,E]=m.useState(void 0),N=m.useCallback(L=>{E(L)},[E]),y=m.useCallback(()=>{E(void 0)},[E]),b=m.useMemo(function(){return e?f.filter(({productUuid:U})=>{const X=gt(U);return X?X.name.includes(e):!1}):f},[e,f,g]),_=m.useMemo(function(){return no([])},[]),{isAppliedFilter:T,enableFilter:P,disableFilter:B}=xr(n),G=Jn(b,_,T?n:void 0),H=m.useMemo(function(){return li()},[g]),O=m.useMemo(function(){return sc(N)},[N,g]),{sortedItems:F,columnsToSortBy:$,handleColumnSortClick:D}=tr(G,O,oc),{selectedItemsUuids:A,handleResetSelectedItems:R,handleSelectAllItems:W,handleSelectItem:bt,handleShowDeleteMultipleSelectedItemsConfirmation:vt,DeleteSelectedItemsConfirmation:wt}=br({itemTypeNamePlural:"buy orders",items:F,searchFieldValue:e,filterValue:n,deleteItemsByUuids:x,setItemToDelete:c}),{lastCreatedOrUpdatedItem:At,onCreateItem:Mt,onUpdateItem:lt}=vr({itemEntityType:_e,items:F,searchFieldValue:e,filterValue:n,resetFilterValue:S,resetSearchFieldValue:i}),Qt=m.useCallback(function(U){return yi(U)?U:void 0},[]),Me=m.useCallback(L=>{const U=L.map(X=>({entityType:xe,productUuid:X.productUuid,locationUuid:X.locationUuid,price:X.price,availableQuantity:0}));v(U)},[v]),{CopySelectedItemsButton:Se,CopyingDialog:Ce,ItemsWereCopiedNotification:Te,NothingToCopyNotification:Ee}=Sr({items:F,selectedItemsUuids:A,onBulkCopyingIntoTargetTable:Me,findSimilarItemInTargetTable:Qt,targetTableName:"sell orders table"});return h.jsxs(h.Fragment,{children:[h.jsx(er,{tableTitle:"buy orders",tableColumns:O,items:F,noItemsLabel:"no buy orders",isLoading:g,showCreateItemModalButtonLabel:"add buy order",onShowCreateItemModal:w,columnsToSortBy:$,onColumnHeaderClick:D,selectedItemsUuids:A,onResetSelectedItems:R,onSelectAllItems:W,onDeleteSelectedItems:vt,searchFieldValue:e,filterValue:n,isAppliedFilter:T,onEnableFilter:P,onDisableFilter:B,filterInfoFields:H,CopySelectedItemsButton:Se,children:h.jsx(nr,{items:F,columns:O,selectedItemsUuids:A,onEditItem:l,onSelectItem:bt,lastCreatedOrUpdatedItem:At})}),(o||!!a)&&h.jsx(oo,{itemToEdit:a,filterValue:n,onHideModal:M,onShowDeleteItemConfirmation:I,onCreateItem:Mt,onUpdateItem:lt}),!!u&&h.jsx(Tr,{onHideModal:C,onHideParentModal:M,itemToDelete:u}),h.jsx(wt,{}),h.jsx(Ce,{}),Te(),Ee(),!!k&&h.jsx(si,{order:k,onHideModal:y})]})}),lc=t=>[{name:"locationUuid",label:"location",type:"select",options:t,chooseOptionLabel:"choose a location",noOptionsLabel:"no location available",allowToSelectNoValueOption:!0,filterPredicate:Cr},{name:"minQuantity",label:"min quantity",type:"number",min:0,max:Number.MAX_SAFE_INTEGER,filterPredicate:(e,n)=>n.minQuantity===void 0?!0:e.availableQuantity>=n.minQuantity},{name:"maxQuantity",label:"max quantity",type:"number",min:0,max:Number.MAX_SAFE_INTEGER,filterPredicate:(e,n)=>n.maxQuantity===void 0?!0:e.availableQuantity<=n.maxQuantity},{name:"minPrice",label:"min price",type:"number",valueType:"float",pattern:"[0-9]+[.][0-9]{2}",min:0,max:Number.MAX_SAFE_INTEGER,step:"0.01",filterPredicate:(e,n)=>n.minPrice===void 0?!0:e.price>=n.minPrice},{name:"maxPrice",label:"max price",type:"number",valueType:"float",pattern:"[0-9]+[.][0-9]{2}",min:0,max:Number.MAX_SAFE_INTEGER,step:"0.01",filterPredicate:(e,n)=>n.maxPrice===void 0?!0:e.price<=n.maxPrice}],qn=(t,e)=>[{name:"uuid",type:"hidden"},{name:"entityType",type:"hidden"},{name:"locationUuid",label:"location",type:"select",required:!0,options:e,chooseOptionLabel:"choose a location",noOptionsLabel:"no locations available",allowToSelectNoValueOption:!0},{name:"productUuid",label:"product",type:"select",required:!0,options:t,chooseOptionLabel:"choose a product",noOptionsLabel:"no products available",allowToSelectNoValueOption:!0},{name:"availableQuantity",label:"stock",type:"number",required:!0,min:0,max:Number.MAX_SAFE_INTEGER},{name:"price",type:"number",required:!0,valueType:"float",pattern:"[0-9]+[.][0-9]{2}",step:"0.01",min:0,max:Number.MAX_SAFE_INTEGER}],uc=m.memo(function({itemToEdit:e,filterValue:n,onHideModal:r,onShowDeleteItemConfirmation:i,onCreateItem:o,onUpdateItem:s}){const a=st([Z,tt,_t,ut,xt]),l=nt([mt,at,se]),u=a||l,c=Z(y=>y.create),f=Z(y=>y.update),d=tt(y=>y.create),p=tt(y=>y.update),g=m.useCallback(y=>{d({entityType:Er,orderUuid:y.uuid,pricesAtMarks:[[y.price,y.availableQuantity]]})},[d]),x=m.useCallback(function(b){const _=[b.price,b.availableQuantity],T=Ge(b.uuid);if(T){if(T.pricesAtMarks.find(B=>B[0]===_[0]&&B[1]===_[1]))return;p({...T,pricesAtMarks:T.pricesAtMarks.concat([_])})}else g(b)},[p,g]),v=m.useCallback(y=>{const b=c(y);g(b),typeof o=="function"&&o(b)},[c,o,g]),S=m.useCallback(y=>{const b=f(y);b&&(x(b),typeof s=="function"&&s(b))},[f,s,x]),w=m.useCallback(()=>{r()},[r]),M=m.useCallback(y=>{if(yr(y)){const b=ae(y,Oi);S(b)}else{const b=ae(y,Fi);b.entityType=xe,v(b)}w()},[v,S,w]),I=m.useCallback(function(b){if(u)return function(){return h.jsx("span",{children:"Loading..."})};const _=gi(b);if(_){const T=gt(_.productUuid)?.name||"(product without name)",P=Lt(_.locationUuid)||"(location without name)";return function(){return h.jsxs("span",{children:["Sell order for"," ",h.jsx("strong",{children:T})," ","in"," ",h.jsx("strong",{children:P})," ","already exists"]})}}},[u]),C=se(y=>y.items),k=mt(y=>y.items),E=m.useMemo(function(){return l?qn([],[]):qn(C,k)},[C,k,l]),N=gr(E,n);return h.jsx(_r,{humanizedItemTypeName:"sell order",itemToEdit:e,formFields:N,validateFormData:I,onCancel:w,onSubmit:M,onDelete:i,deleteItemButtonLabel:"delete sell order"})}),cc=["productUuid","availableQuantity","price","locationUuid"];function fc(t){return[{name:"uuid",isCheckbox:!0},{name:"productUuid",label:"product",asLinkToEditItem:!0,isSortable:!0,alignLabel:"left",formatValue:cr,actionButtons:ur,sortFn:lr},{name:"availableQuantity",label:"stock",type:"number",isSortable:!0,formatValue:fr},{name:"price",type:"number",isSortable:!0,sort:"asc",formatValue:dr,actionButtons:({item:e})=>h.jsx(ai,{item:e,setOrderForPriceChart:t})},{name:"locationUuid",label:"location",alignLabel:"right",isSortable:!0,formatValue:Mr,actionButtons:hr,sortFn:Ar}]}const dc=m.memo(function({searchFieldValue:e,sellOrderFilterValue:n,setSellOrderFilterValue:r,resetSearchFieldValue:i}){const[o,s]=m.useState(!1),[a,l]=m.useState(),[u,c]=m.useState(),f=Z(Zn(L=>L.items())),d=st([Z,J,_t,ut,xt]),p=nt([at]),g=d||p,x=Z(L=>L.deleteMultiple),v=J(L=>L.createMultiple),S=m.useCallback(function(){r(void 0)},[r]),w=m.useCallback(function(){s(!0)},[s]),M=m.useCallback(function(){l(void 0),s(!1)},[l,s]),I=m.useCallback(function(U){c(U)},[c]),C=m.useCallback(function(){c(void 0)},[c]),[k,E]=m.useState(void 0),N=m.useCallback(function(U){E(U)},[E]),y=m.useCallback(function(){E(void 0)},[E]),b=m.useMemo(function(){return e?f.filter(({productUuid:U})=>{const X=gt(U);return X?X.name.includes(e):!1}):f},[e,f,g]),_=m.useMemo(function(){return lc([])},[g]),{isAppliedFilter:T,enableFilter:P,disableFilter:B}=xr(n),G=Jn(b,_,T?n:void 0),H=m.useMemo(function(){return li()},[g]),O=m.useMemo(function(){return fc(N)},[N,g]),{sortedItems:F,columnsToSortBy:$,handleColumnSortClick:D}=tr(G,O,cc),{selectedItemsUuids:A,handleResetSelectedItems:R,handleSelectAllItems:W,handleSelectItem:bt,handleShowDeleteMultipleSelectedItemsConfirmation:vt,DeleteSelectedItemsConfirmation:wt}=br({itemTypeNamePlural:"sell orders",items:F,searchFieldValue:e,filterValue:n,deleteItemsByUuids:x,setItemToDelete:c}),{lastCreatedOrUpdatedItem:At,onCreateItem:Mt,onUpdateItem:lt}=vr({itemEntityType:xe,items:F,searchFieldValue:e,filterValue:n,resetFilterValue:S,resetSearchFieldValue:i}),Qt=m.useCallback(function(U){return _i(U)?U:void 0},[]),Me=m.useCallback(function(U){const X=U.map(Ne=>({entityType:_e,productUuid:Ne.productUuid,locationUuid:Ne.locationUuid,price:Ne.price,desirableQuantity:0}));v(X)},[v]),{CopySelectedItemsButton:Se,CopyingDialog:Ce,ItemsWereCopiedNotification:Te,NothingToCopyNotification:Ee}=Sr({items:F,selectedItemsUuids:A,onBulkCopyingIntoTargetTable:Me,findSimilarItemInTargetTable:Qt,targetTableName:"buy orders table"});return h.jsxs(h.Fragment,{children:[h.jsx(er,{tableTitle:"sell orders",tableColumns:O,items:F,noItemsLabel:"no sell orders",isLoading:g,showCreateItemModalButtonLabel:"add sell order",onShowCreateItemModal:w,columnsToSortBy:$,onColumnHeaderClick:D,selectedItemsUuids:A,onResetSelectedItems:R,onSelectAllItems:W,onDeleteSelectedItems:vt,searchFieldValue:e,filterValue:n,isAppliedFilter:T,onEnableFilter:P,onDisableFilter:B,filterInfoFields:H,CopySelectedItemsButton:Se,children:h.jsx(nr,{items:F,columns:O,selectedItemsUuids:A,onEditItem:l,onSelectItem:bt,lastCreatedOrUpdatedItem:At})}),(o||!!a)&&h.jsx(uc,{itemToEdit:a,filterValue:n,onHideModal:M,onShowDeleteItemConfirmation:I,onCreateItem:Mt,onUpdateItem:lt}),!!u&&h.jsx(Tr,{onHideModal:C,onHideParentModal:M,itemToDelete:u}),h.jsx(wt,{}),h.jsx(Ce,{}),Te(),Ee(),!!k&&h.jsx(si,{order:k,onHideModal:y})]})}),Qn=[rr,ir,or,sr],hc=[We,Ke,Ze];function ze(t){const e={locationId:t.get(We)||void 0,locationName:t.get(Ke)||void 0,planetarySystemName:t.get(Ze)||void 0,minPrice:+(t.get(rr)||0)||void 0,maxPrice:+(t.get(ir)||0)||void 0,minQuantity:+(t.get(or)||0)||void 0,maxQuantity:+(t.get(sr)||0)||void 0};return Ai(e)}function mc({filterValue:t}){if(!t)return;const{locationId:e,locationName:n,planetarySystemName:r,...i}=t;let o;return e||n?o=xi({id:e,name:n,planetarySystemName:r})?.uuid:r&&(o=bi(r)?.uuid),{...i,locationUuid:o}}function pc({urlSearchParams:t,setUrlSearchParams:e}){const n=st([ut,xt]),r=nt([mt,at]),i=n||r,o=m.useRef(void 0),s=m.useMemo(function(){const u=ze(t),c=mc({filterValue:u}),f=o.current;return dn(f,c)?(o.current=c,c):f},[t,o,i]),a=m.useCallback(function(u){let c;if(typeof u=="function")throw new Error("MarketValue as setState(prev=>newState) function not supported");u&&Object.keys(u).length>0&&(c=u),e(f=>{const d=ze(f);if(dn(d,c)){if(!c)return Qn.forEach(x=>{f.delete(x)}),hc.forEach(x=>{f.delete(x)}),f;Qn.forEach(x=>{c[x]?f.set(x,`${c[x]}`):f.delete(x)});const g=c.locationUuid;Li({urlSearchParams:f,locationUuid:g,planetarySystemUuid:g,locationIdUrlSearchParamsKeyName:We,locationNameUrlSearchParamsKeyName:Ke,planetarySystemNameUrlSearchParamsKeyName:Ze})}return f})},[e]);return{marketFilterValue:s,setMarketFilterValueToUrlSearchParams:a}}function yc({urlSearchParams:t,setUrlSearchParams:e}){return Mi({urlSearchParams:t,setUrlSearchParams:e,getSearchValueFromUrlSearchParams:ar,searchValueKeyInUrlSearchParams:hn,searchFieldNameInSearchForm:hn,searchFieldPlaceholderTextInSearchForm:"Start typing to search a product by name..."})}function gc(t){const e=m.useMemo(()=>{const i=ze(t);return Ei({id:i?.locationId,name:i?.locationName,planetarySystemName:i?.planetarySystemName})},[t]),n=m.useMemo(()=>ar(t),[t]);return m.useMemo(function(){return Ti(Ii({productName:n,locationName:e}))},[n,e])}const _c=m.memo(function(){const{urlSearchParams:e,setUrlSearchParams:n}=Si(),r=gc(e),{marketFilterValue:i,setMarketFilterValueToUrlSearchParams:o}=pc({urlSearchParams:e,setUrlSearchParams:n}),{searchFieldValue:s,SearchForm:a,resetSearchFieldValue:l}=yc({urlSearchParams:e,setUrlSearchParams:n}),{isVisible:u,show:c,hide:f}=Ut(!1);return m.useEffect(function(){(i||!i)&&f()},[i,f]),h.jsxs(h.Fragment,{children:[h.jsx("title",{children:r}),h.jsxs(Ni,{children:[h.jsxs(Ci,{children:[a,h.jsxs(K,{title:"show filter form",onClick:c,children:[h.jsx(jt,{name:"tune"}),h.jsx("span",{children:"filter"})]}),u&&h.jsx(Yi,{filterValue:i,onSetFilterValue:o,onHide:f})]}),h.jsxs("div",{className:Bi.Container,children:[h.jsx(dc,{searchFieldValue:s,sellOrderFilterValue:i,setSellOrderFilterValue:o,resetSearchFieldValue:l}),h.jsx(ac,{searchFieldValue:s,buyOrderFilterValue:i,setBuyOrderFilterValue:o,resetSearchFieldValue:l})]})]})]})}),$c=ui(function(){return h.jsx(_c,{})});export{$c as default};
