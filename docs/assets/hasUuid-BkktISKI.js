import{a as e,q as i}from"./chunk-PVWAREVJ-D1PIyzeh.js";import{a as D,M as w}from"./ModalConfirmation-BkKL8gix.js";import{c as T,a as U}from"./ClassNames-CdIKlwZs.js";import{c as L,u as R,a as W,B as O,I as k,F as v}from"./useLoadingPersistStorages-BWX3nPU9.js";function Z({itemTypeNamePlural:o="items",items:t=[],searchFieldValue:n,filterValue:s,deleteItemsByUuids:d,setItemToDelete:f}){const[r,l]=e.useState([]),m=e.useCallback(function(u,M){l(F=>M?Array.from(new Set(new Array().concat(F,u.uuid))):F.filter(A=>A!==u.uuid))},[l]),h=e.useCallback(()=>{l(a=>a.length?[]:a)},[]),p=e.useCallback(function(){if(r.length!==t.length){l(t.map(u=>u.uuid));return}h()},[r,t,h]),x=e.useCallback(function(){d(r),h()},[d,r,h]),S=e.useCallback(a=>{f(a)},[f]),[_,b]=e.useState(!1),g=e.useCallback(function(){if(r.length){if(r.length===1){const u=r[0],M=t.find(F=>F.uuid===u);if(!M)return;S(M);return}b(!0)}},[r,t,S]),I=e.useCallback(function(){b(!1)},[]);e.useEffect(function(){l(u=>{if(!u.length)return u;const M=[];return t.forEach(F=>{const A=u.find(B=>B===F.uuid);A&&M.push(A)}),M})},[t]);const c=e.useMemo(function(){if(r.length>1)return i.jsxs(i.Fragment,{children:["are sure you want to delete"," ",i.jsx("strong",{children:r.length})," ",o,"?"]})},[r.length,o]),C=e.useMemo(function(){return function(){return i.jsx(i.Fragment,{children:_&&i.jsx(D,{title:c,onHide:I,onConfirm:x,confirmButtonLabel:`delete multiple ${o}`})})}},[_,o,c,I,x]);return e.useEffect(function(){(n||!n||s||!s)&&h()},[n,s,h]),{selectedItemsUuids:r,handleSelectItem:m,handleSelectAllItems:p,handleResetSelectedItems:h,handleShowDeleteMultipleSelectedItemsConfirmation:g,DeleteSelectedItemsConfirmation:C}}const j=T(U({item:void 0},o=>({setItem:t=>{o(()=>({item:t}))}}))),y=5*1e3;function P({itemEntityType:o,items:t,searchFieldValue:n,filterValue:s,resetSearchFieldValue:d,resetFilterValue:f}){const r=j(c=>c.item),l=j(c=>c.setItem),m=e.useMemo(function(){return r?.entityType===o?r:void 0},[r,o]),h=e.useCallback(function(C){l(C)},[l]),p=e.useCallback(function(C){l(C)},[l]),x=e.useCallback(function(){d&&d()},[d]),S=e.useCallback(function(){f&&f()},[f]),[_,b]=e.useState(void 0),[g,I]=e.useState(void 0);return e.useEffect(function(){return(!Object.is(n,_)||!Object.is(s,g))&&(l(void 0),Object.is(n,_)||b(n),Object.is(s,g)||I(s)),function(){m&&t.find(a=>a.uuid===m.uuid)&&l(void 0)}},[_,g,n,s,l,b,I,t,m]),e.useEffect(function(){if(!m)return;if(!t.find(u=>u.uuid===m.uuid)){s&&S(),n&&x();return}const a=window.setTimeout(function(){l(void 0)},y);return function(){window.clearTimeout(a)}},[m,t,S,x,s,n,l]),{lastCreatedOrUpdatedItem:m,onCreateItem:h,onUpdateItem:p}}function z(o){const{isVisible:t,show:n,hide:s}=L(!0);return e.useEffect(function(){n()},[o,n]),{isAppliedFilter:t,enableFilter:n,disableFilter:s}}const ee=(o=[],t)=>e.useMemo(()=>t?o.map(s=>{const d=s.name,f=t[d];return f?{...s,defaultValue:f}:s}):o,[o,t]),V="_ModalEditFormBody_1x6ew_1",N="_Content_1x6ew_10",H="_ErrorMessageContainer_1x6ew_18",G="_ErrorMessageText_1x6ew_28",$="_ActionButtons_1x6ew_36",q="_ActionButtonsGroup_1x6ew_43",J="_TitleWithButton_1x6ew_58",E={ModalEditFormBody:V,Content:N,ErrorMessageContainer:H,ErrorMessageText:G,ActionButtons:$,ActionButtonsGroup:q,TitleWithButton:J},te=e.memo(function({humanizedItemTypeName:t,itemToEdit:n,formFields:s,showResetButton:d=!1,resetButtonLabel:f,onCancel:r,saveButtonLabel:l,validateFormData:m,onSubmit:h,onDelete:p,deleteItemButtonLabel:x="delete item"}){const S=!n?.uuid,_=`${S?"create":"save"} ${t||"item"}`,b=e.useRef(null);R(b,s);const{handleSubmit:g,formValidationErrorMessage:I}=W({formRef:b,onSubmit:h,formFields:s,validateFormData:m}),c=e.useCallback(()=>{r()},[r]),C=e.useCallback(()=>{typeof p=="function"&&n&&p(n)},[p,n]),a=e.useMemo(function(){const M=`${S?"create":"edit"} ${t||"item"}`,F=typeof p=="function"&&!!n;return i.jsxs("div",{className:E.TitleWithButton,children:[i.jsx("span",{children:M}),F&&i.jsx(O,{noPadding:!0,transparent:!0,onClick:C,title:x,children:i.jsx(k,{name:"delete_forever"})})]})},[S,t,n,p,C,x]);return i.jsx(w,{title:a,onHide:c,children:i.jsxs("form",{ref:b,className:E.ModalEditFormBody,onSubmit:g,children:[i.jsxs("div",{className:E.Content,children:[i.jsx(v,{formFields:s,item:n}),I!==void 0&&i.jsx("div",{className:E.ErrorMessageContainer,role:"alert",children:i.jsx("span",{className:E.ErrorMessageText,children:typeof I=="function"?I():I})})]}),i.jsx("div",{className:E.ActionButtons,children:i.jsxs("div",{className:E.ActionButtonsGroup,children:[d&&i.jsx(O,{type:"reset",children:f||"reset form"}),i.jsx(O,{type:"submit",primary:!0,children:l||_})]})})]})})});function ne(o,t){const n={};return t.forEach(s=>{n[s]=o[s]}),n}function se(o){return!!o.uuid}export{te as M,z as a,Z as b,P as c,ne as g,se as h,ee as u};
