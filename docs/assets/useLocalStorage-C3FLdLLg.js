import{a}from"./chunk-NL6KNZEE-BTkWJe7M.js";function c(t){var e;return t===null?"null":typeof t=="object"?((e=t==null?void 0:t.constructor)==null?void 0:e.name)||"object":typeof t}function p(t,e,o){const r=c(t)===c(e);return r||console.error(`localStorage item '${o}' value has incompatible type (localStorage itemDataType: '${c(t)}', initialDataType: '${c(e)})'`),r}function v(t,e,o){const r=c(t)===c(e);return r||console.error(`nextState of '${o}' has incompatible value type  (localStorage itemDataType: '${c(t)}', initialDataType: '${c(e)})`),r}function S(t,e){window.dispatchEvent(new StorageEvent("storage",{key:t,newValue:e}))}function h(t,e){var o;try{const r=JSON.stringify(e);(o=window.localStorage)==null||o.setItem(t,r),S(t,r)}catch(r){console.error(r);return}}function w(t){var e;try{(e=window.localStorage)==null||e.removeItem(t),S(t,null)}catch(o){console.error(o);return}}function f(t){var e;try{return((e=window.localStorage)==null?void 0:e.getItem(t))||void 0}catch(o){console.error(o);return}}function b(){}function d(t,e,o=!1){const r=a.useCallback(function(n){return window.addEventListener("storage",n),function(){window.removeEventListener("storage",n)}},[]),l=a.useCallback(function(){return f(t)},[t]),u=a.useSyncExternalStore(r,l,b),g=a.useMemo(function(){if(u==null)return e;try{const n=JSON.parse(u);return o&&!p(n,e,t)?e:n}catch(n){return console.error(n),e}},[e,t,u,o]),m=a.useCallback(function(n){const s=n;o&&!v(s,e,t)||(s==null?w(t):h(t,s))},[e,t,o]);return a.useEffect(function(){f(t)},[t,e]),[g,m]}export{d as u};
