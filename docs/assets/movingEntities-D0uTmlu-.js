import{q as n,a,z as Et}from"./chunk-PVWAREVJ-D1PIyzeh.js";import{i as A,N as we,q as ft,r as St,u as J,d as Fe,M as B,h as he,j as Ee,k as fe,O as Se,P as be,Q as ve,R as pe,V as Ce,W as Me,l as bt,m as Re,X as Be,E as Ne,a as vt,b as De,S as He,T as ke,c as Ye,Y as pt,p as Ct}from"./useTableSearch-Ui5oQRZ2.js";import{c as Mt}from"./createPageTitleWithAppName-C6bNgB-9.js";import{M as Tt}from"./Main-D4jU2hau.js";import{w as T,K as O,O as V,y as Q,z as Z,aq as C,ac as D,I,B as U,aH as Lt,ag as x,aI as It,a3 as At,aJ as Ft,aK as Nt,aL as _t,_ as jt,$ as xt,v as We,c as Ut,N as Pt,aM as Ot}from"./useLoadingPersistStorages-BWX3nPU9.js";import{h as Ke,g as q,u as Ge,M as $e,a as Vt,b as ze,c as qe}from"./hasUuid-BkktISKI.js";import{d as Xe,p as Y,f as Je,M as wt,u as X,e as _e,a as Qe}from"./getUrlToMapPageWithParams-gLmSAaLz.js";import{S as Ze}from"./SearchFormAndTableContainer-Dn0g8KWe.js";import{M as Rt,E as et,a as Bt}from"./MovingEntity-_XUTKdrK.js";import{s as le,F as re,a as ce}from"./setMovingEntityOrLocationOrPlanetarySystemToUrlSearchParams-B36G2HfO.js";import{I as H}from"./InternalStaticLink-rDmjTW4d.js";import{g as tt}from"./getUrlToMovingEntitiesPageWithParams-CAB83Xnk.js";import{a as nt}from"./ModalConfirmation-BkKL8gix.js";import{D as Dt}from"./DialogFilterForm-CQxhjX2d.js";import"./ClassNames-CdIKlwZs.js";import"./App.const-Bym5gJCd.js";import"./index-D9Tyn9c9.js";const je="Moving objects";function Ht({movingEntityName:t}){const e=[t].filter(o=>!!o);return e.length?`Search ${e.join(" ")} - ${je}`:`${je}`}const kt="_Container_anbvv_1",Yt="_MainTable_anbvv_10",Wt="_TableGroups_anbvv_16",me={Container:kt,MainTable:Yt,TableGroups:Wt};function de({name:t,label:e,value:o}){const i=T([O,V]);if(!o)return;const c=i||!A(o)?void 0:o,s=c?Q(c):void 0;if(s)return{label:e??t?.toString(),value:s?.name};const l=i||!A(o)?void 0:o,m=l?Z(l):void 0;return m?{label:e??t?.toString(),value:m?.name}:{label:e??t?.toString(),value:"(location type without name)"}}function Kt({name:t,label:e,value:o}){const i=T([C]);if(!o)return;const c=i||!A(o)?void 0:D(o)?.name;return c?{label:e??t?.toString(),value:c}:{label:e??t?.toString(),value:"(moving object class without name)"}}function Gt(){return[{name:"movingEntityClassUuid",label:"class",formatLabelAndValue:Kt},{name:"locationUuid",label:"type",formatLabelAndValue:de},{name:"homeLocationUuid",label:"type",formatLabelAndValue:de},{name:"destinationLocationUuid",label:"type",formatLabelAndValue:de}]}function $t({value:t,item:e}){const o=T([O,V]),i=o||!A(t)?void 0:Q(t);let c=o||!A(i?.planetarySystemUuid)?void 0:i?.planetarySystemUuid;!c&&A(t)&&(c=t);const s=c?Z(c):void 0,l=Xe({locationId:i?.id,locationName:i?.name,planetarySystemName:s?.name});let m;i?m=Y(i?.position):m=Y(e.position);const d=m&&s&&Je({locationId:i?.id,locationName:i?.name,planetarySystemName:s?.name,position:i?void 0:e.position});return n.jsxs(n.Fragment,{children:[l?n.jsx(H,{to:l,title:"show location info",children:n.jsx(I,{name:"info"})}):n.jsx(U,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no location data",children:n.jsx(I,{name:"location_disabled"})}),d?n.jsx(H,{to:d,title:`show ${i?"location":"position"} on map`,children:n.jsx(I,{name:"location_on"})}):n.jsx(U,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no position data",children:n.jsx(I,{name:"location_off"})})]})}function xe({value:t}){const e=T([O,V]),o=e||!A(t)?void 0:Q(t);let i=e||!A(o?.planetarySystemUuid)?void 0:o?.planetarySystemUuid;i||(i=e||!A(t)?void 0:t);const c=i?Z(i):void 0,s=Xe({locationId:o?.id,locationName:o?.name,planetarySystemName:c?.name}),m=(o?Y(o.position):void 0)&&c&&Je({locationId:o?.id,locationName:o?.name,planetarySystemName:c?.name,mapMode:!o?.id&&!o?.name?wt:void 0});return n.jsxs(n.Fragment,{children:[s?n.jsx(H,{to:s,title:"show location info",children:n.jsx(I,{name:"info"})}):n.jsx(U,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no location data",children:n.jsx(I,{name:"location_disabled"})}),m?n.jsx(H,{to:m,title:"show location on map",children:n.jsx(I,{name:"location_on"})}):n.jsx(U,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no position data",children:n.jsx(I,{name:"location_off"})})]})}function Ue({value:t}){return n.jsx(n.Fragment,{children:typeof t=="string"?t:n.jsx(we,{children:"(noÂ id)"})})}function zt({value:t}){const i=T([C])||!A(t)?void 0:D(t)?.name;return n.jsx(n.Fragment,{children:i||n.jsx(we,{children:"(n/d)"})})}function qt({value:t}){const o=T([C])||!A(t)?void 0:D(t),i=tt({movingEntityClassName:o?.name});return n.jsx(n.Fragment,{children:i?n.jsx(H,{to:i,title:"show moving object class info",children:n.jsx(I,{name:"info"})}):n.jsx(U,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no moving object class data",children:n.jsx(I,{name:"search_off"})})})}function Xt(t,e){if(Lt())return 0;const i=A(t)&&D(t)?.name||"",c=A(e)&&D(e)?.name||"";return i.localeCompare(c)}function Pe(){return[{name:"uuid",isCheckbox:!0},{name:"id",asLinkToEditItem:!0,isSortable:!0,alignLabel:"center",uppercase:!0,monospaced:!0,nowrap:!0,isSearchCaseInsensitive:!0,formatValue:Ue},{name:"originalId",label:"original id",asLinkToEditItem:!0,isSortable:!0,alignLabel:"center",uppercase:!0,monospaced:!0,nowrap:!0,isSearchCaseInsensitive:!0,formatValue:Ue},{name:"movingEntityClassUuid",label:"class",isSortable:!0,sort:"asc",alignLabel:"center",formatValue:zt,actionButtons:qt,sortFn:Xt},{name:"name",asLinkToEditItem:!0,isSortable:!0,alignLabel:"left"},{name:"locationUuid",label:"location",alignLabel:"right",isSortable:!0,formatValue:re,actionButtons:$t,sortFn:le},{name:"destinationLocationUuid",label:"destination",alignLabel:"right",isSortable:!0,formatValue:re,actionButtons:xe,sortFn:le},{name:"homeLocationUuid",label:"home",alignLabel:"right",isSortable:!0,formatValue:re,actionButtons:xe,sortFn:le}]}function ue(t,e){if(!t||!e)return!1;if(t===e)return!0;const i=Q(t)?.planetarySystemUuid,c=i?Z(i):void 0;return c?c.uuid===e:!1}const ye=(t,e)=>[{name:"movingEntityClassUuid",label:"class",type:"select",options:t,chooseOptionLabel:"choose a moving entity class",noOptionsLabel:"no moving entity classes available",allowToSelectNoValueOption:!0,filterPredicate:(o,i)=>o.movingEntityClassUuid===i.movingEntityClassUuid},{name:"locationUuid",label:"location",type:"select",options:e,chooseOptionLabel:"choose a location",noOptionsLabel:"no location available",allowToSelectNoValueOption:!0,filterPredicate:(o,i)=>ue(o.locationUuid,i.locationUuid)},{name:"destinationLocationUuid",label:"destination",type:"select",options:e,chooseOptionLabel:"choose a location",noOptionsLabel:"no location available",allowToSelectNoValueOption:!0,filterPredicate:(o,i)=>ue(o.destinationLocationUuid,i.destinationLocationUuid)},{name:"homeLocationUuid",label:"home",type:"select",options:e,chooseOptionLabel:"choose a location",noOptionsLabel:"no location available",allowToSelectNoValueOption:!0,filterPredicate:(o,i)=>ue(o.homeLocationUuid,i.homeLocationUuid)}],Jt=a.memo(function({itemToDelete:e,onHideModal:o,onHideParentModal:i}){const s=T([x]),l=x(r=>r.delete),m=a.useCallback(function(){o()},[o]),d=a.useCallback(function(){i()},[i]),h=a.useCallback(function(){s||(l(e),m(),d())},[e,m,d,l,s]),g=a.useMemo(function(){return n.jsxs(n.Fragment,{children:["Are you sure you want"," ",n.jsx("strong",{children:"to delete"})," ","the moving object named",n.jsx("br",{}),n.jsxs("strong",{children:[e.id?`${e.id} `:"",e.name]}),"?"]})},[e]);return n.jsx(nt,{title:g,onHide:m,onConfirm:h,confirmButtonLabel:"delete moving object"})}),P=ft();function ot(){const{isHydrating:t,isHydrated:e}=C.getState();if(t||!e)return;const o=It();Qt({movingEntitiesMap:o})}P.setState({prepareData:ot});C.subscribe(function(){ot()});function Qt({movingEntitiesMap:t}){const e=P.getState();e.isProcessing||(e.setIsProcessing(!0),window.setTimeout(function(){const c=tn({movingEntitiesMap:t});e.replaceAll(c),e.setIsProcessing(!1)},0))}function Zt(t,e=!1){const o=t?.name??"(moving object class without name)",i=e?St(o,"entity class"):o;return{name:o,nameAsLabel:i}}function en({movingEntitiesMap:t,shouldAddSuffixLabel:e=!1}){const o=[];return At(t).forEach(function(s){const l=s.uuid,{name:m,nameAsLabel:d}=Zt(s,e);o.push({uuid:l,name:m,label:d})}),o}function it(t){t.sort((e,o)=>e.name.localeCompare(o.name)),t.forEach(({items:e})=>it(e??[]))}function at({items:t=[],level:e=0,disableOptionsWithoutUuid:o=!0,selectOptions:i=new Array}){return t.forEach(c=>{const{label:s,items:l}=c,m=c.uuid,d=m??"";i.push({value:d,label:s,level:e,disabled:o?!m:!1}),l?.length&&at({items:l,level:e+1,disableOptionsWithoutUuid:o,selectOptions:i})}),i}function tn({movingEntitiesMap:t,disableOptionsWithoutUuid:e}){const o=en({movingEntitiesMap:t,shouldAddSuffixLabel:!1});return it(o),at({items:o,disableOptionsWithoutUuid:e})??[]}function Oe({movingEntityClassesAsSelectOptions:t,locationsAsSelectOptions:e}){return[{name:"uuid",type:"hidden"},{name:"entityType",type:"hidden"},{name:"id",uppercase:!0},{name:"originalId",label:"original Id",uppercase:!0},{name:"movingEntityClassUuid",label:"class",type:"select",options:t,chooseOptionLabel:"choose a moving object class",noOptionsLabel:"no moving object classes available",allowToSelectNoValueOption:!0},{name:"name",required:!0},{name:"position"},{name:"locationUuid",label:"current location",type:"select",options:e,chooseOptionLabel:"choose a location",noOptionsLabel:"no locations available",allowToSelectNoValueOption:!0},{name:"destinationLocationUuid",label:"destination",type:"select",options:e,chooseOptionLabel:"choose a location",noOptionsLabel:"no locations available",allowToSelectNoValueOption:!0},{name:"homeLocationUuid",label:"home location",type:"select",options:e,chooseOptionLabel:"choose a location",noOptionsLabel:"no locations available",allowToSelectNoValueOption:!0},{name:"cargo",label:"cargo / freight bay"},{name:"combatShield",label:"shield"},{name:"combatLaser",label:"laser"},{name:"combatMissiles",label:"missiles",type:"number",valueType:"integer",pattern:"[0-9]+",min:0,max:Number.MAX_SAFE_INTEGER,step:"1"},{name:"note",type:"multiline-text"}]}const nn=a.memo(function({itemToEdit:e,filterValue:o,onHideModal:i,onShowDeleteItemConfirmation:c,onCreateItem:s,onUpdateItem:l}){const m=T([x,C,O,V]),d=J([P,X]),h=m||d,g=x(E=>E.create),r=x(E=>E.update),f=a.useCallback(E=>{const u=g(E);typeof s=="function"&&s(u)},[g,s]),v=a.useCallback(E=>{const u=r(E);u&&typeof l=="function"&&l(u)},[r,l]),b=a.useCallback(()=>{i()},[i]),p=a.useCallback(E=>{if(Ke(E)){const u=q(E,Bt);u.id=u.id?.toLocaleUpperCase(),u.originalId=u.originalId?.toLocaleUpperCase();const M=Y(u.position);M&&(u.position=_e(M)),v(u)}else{const u=q(E,Rt);u.entityType=et,u.id=u.id?.toLocaleUpperCase(),u.originalId=u.originalId?.toLocaleUpperCase();const M=Y(u.position);M&&(u.position=_e(M)),f(u)}b()},[f,v,b]),F=a.useCallback(E=>{if(h)return function(){return n.jsx("span",{children:"Loading..."})};const u=Ft(E);if(u)return function(){return n.jsxs(n.Fragment,{children:["Moving object with Id:"," ",n.jsx("strong",{children:u?u.id:"(no-id)"})," ","already exists"]})};const M=Nt(E);if(M)return function(){return n.jsxs(n.Fragment,{children:["Moving object with Original Id:"," ",n.jsx("strong",{children:M?M.originalId:"(no-original-id)"})," ","already exists"]})}},[h]),L=P(E=>E.items),y=X(E=>E.items),S=a.useMemo(function(){return Oe(h?{locationsAsSelectOptions:[],movingEntityClassesAsSelectOptions:[]}:{locationsAsSelectOptions:y,movingEntityClassesAsSelectOptions:L})},[L,y,h]),j=Ge(S,o);return n.jsx($e,{humanizedItemTypeName:"moving object",itemToEdit:e,formFields:j,validateFormData:F,onCancel:b,onSubmit:p,onDelete:c,deleteItemButtonLabel:"delete moving object"})}),on=a.memo(function({filterValue:e,onSetFilterValue:o,onHide:i}){const c=T([C,O,V]),s=J([P,X]),l=c||s,m=X(f=>f.items),d=P(f=>f.items),h=a.useMemo(function(){return l?ye([],[]):ye(d,m)},[d,m,l]),g=a.useCallback(function(){i()},[i]),r=a.useCallback(function(v){Object.keys(v).length?o(v):o(void 0),g()},[g,o]);return n.jsx(n.Fragment,{children:n.jsx("div",{style:{position:"absolute",top:0,right:0},children:n.jsx(Dt,{humanizedPluralItemTypeName:"moving objects",filterValue:e,formFields:h,onCancel:g,onFilter:r})})})}),an="_Container_1vczl_1",sn={Container:an},ln=[B,he,Ee,fe,Se,be,ve,pe,Ce,Me];function Ve(t){const e={className:t.get(B)||void 0,locationId:t.get(he)||void 0,locationName:t.get(Ee)||void 0,planetarySystemName:t.get(fe)||void 0,destinationLocationId:t.get(Se)||void 0,destinationLocationName:t.get(be)||void 0,destinationPlanetarySystemName:t.get(ve)||void 0,homeLocationId:t.get(pe)||void 0,homeLocationName:t.get(Ce)||void 0,homePlanetarySystemName:t.get(Me)||void 0};return bt(e)}function ge(t,e,o){let i;return t||e?i=jt({id:t,name:e,planetarySystemName:o})?.uuid:o&&(i=xt(o)?.uuid),i}function rn({filterValue:t}){if(!t)return;const{className:e,locationId:o,locationName:i,planetarySystemName:c,destinationLocationId:s,destinationLocationName:l,destinationPlanetarySystemName:m,homeLocationId:d,homeLocationName:h,homePlanetarySystemName:g,...r}=t,f=e?_t(e)?.uuid:void 0,v=ge(o,i,c),b=ge(s,l,m),p=ge(d,h,g);return{...r,movingEntityClassUuid:f,locationUuid:v,destinationLocationUuid:b,homeLocationUuid:p}}function cn({urlSearchParams:t,setUrlSearchParams:e}){const o=T([C,O,V]),i=J([P,Qe]),c=o||i,s=a.useRef(void 0),l=a.useMemo(function(){const h=Ve(t),g=rn({filterValue:h}),r=s.current;return Fe(r,g)?(s.current=g,g):r},[t,s,c]),m=a.useCallback(function(h){let g;if(typeof h=="function")throw new Error("MovingEntityFilterValue as setState(prev=>newState) function not supported");h&&Object.keys(h).length>0&&(g=h),e(r=>{const f=Ve(r);if(Fe(f,g)){if(!g)return ln.forEach(S=>{r.delete(S)}),r;const b=g.movingEntityClassUuid,p=b?D(b)?.name:void 0;p?r.set(B,p):r.delete(B);const F=g.locationUuid;ce({urlSearchParams:r,locationUuid:F,planetarySystemUuid:F,locationIdUrlSearchParamsKeyName:he,locationNameUrlSearchParamsKeyName:Ee,planetarySystemNameUrlSearchParamsKeyName:fe});const L=g.destinationLocationUuid;ce({urlSearchParams:r,locationUuid:L,planetarySystemUuid:L,locationIdUrlSearchParamsKeyName:Se,locationNameUrlSearchParamsKeyName:be,planetarySystemNameUrlSearchParamsKeyName:ve});const y=g.homeLocationUuid;ce({urlSearchParams:r,locationUuid:y,planetarySystemUuid:y,locationIdUrlSearchParamsKeyName:pe,locationNameUrlSearchParamsKeyName:Ce,planetarySystemNameUrlSearchParamsKeyName:Me})}return r})},[e]);return{filterValue:l,setFilterValueToUrlSearchParams:m}}function mn({urlSearchParams:t,setUrlSearchParams:e}){return Re({urlSearchParams:t,setUrlSearchParams:e,getSearchValueFromUrlSearchParams:Be,searchValueKeyInUrlSearchParams:Ne,searchFieldNameInSearchForm:Ne,searchFieldPlaceholderTextInSearchForm:"Search by moving object name, id, originalId..."})}const dn=["name","id","originalId","movingEntityClassUuid","locationUuid","homeLocationUuid","destinationLocationUuid","combatShield","combatLaser","combatMissiles"],un=["name","id","originalId"],gn=a.memo(function({urlSearchParams:e,setUrlSearchParams:o}){const i=T([x,C,V,O]),c=J([Qe]),s=i||c,{filterValue:l,setFilterValueToUrlSearchParams:m}=cn({urlSearchParams:e,setUrlSearchParams:o}),{searchFieldValue:d,SearchForm:h,resetSearchFieldValue:g}=mn({urlSearchParams:e,setUrlSearchParams:o}),r=x(We(N=>N.items())),f=x(N=>N.deleteMultiple),[v,b]=a.useState(!1),[p,F]=a.useState(),[L,y]=a.useState(),S=a.useCallback(()=>{b(!0)},[b]),j=a.useCallback(()=>{F(void 0),b(!1)},[F,b]),E=a.useCallback(N=>{y(N)},[y]),u=a.useCallback(()=>{y(void 0)},[y]),M=a.useMemo(function(){return Pe().filter(se=>un.includes(se.name))},[]),w=a.useMemo(function(){return d?r.filter(se=>!!M.find(Ie=>{const Ae=se[Ie.name];return Ie.isSearchCaseInsensitive?Ae?.toLocaleLowerCase()?.includes(d.toLocaleLowerCase()):Ae?.includes(d)})):r},[d,r,M]),W=a.useMemo(function(){return ye([],[])},[s]),ee=a.useMemo(function(){return Gt()},[s]),{isAppliedFilter:K,enableFilter:te,disableFilter:ne}=Vt(l),oe=vt(w,W,K?l:void 0),k=a.useMemo(function(){return Pe()},[s]),{sortedItems:R,columnsToSortBy:ie,handleColumnSortClick:_}=De(oe,k,dn),{selectedItemsUuids:G,handleResetSelectedItems:Te,handleSelectAllItems:$,handleSelectItem:z,handleShowDeleteMultipleSelectedItemsConfirmation:Le,DeleteSelectedItemsConfirmation:ct}=ze({itemTypeNamePlural:"moving objects",items:R,searchFieldValue:d,filterValue:l,deleteItemsByUuids:f,setItemToDelete:y}),mt=a.useCallback(function(){m(void 0)},[m]),{lastCreatedOrUpdatedItem:dt,onCreateItem:ut,onUpdateItem:gt}=qe({itemEntityType:et,items:R,searchFieldValue:d,filterValue:l,resetSearchFieldValue:g,resetFilterValue:mt}),{isVisible:yt,show:ht,hide:ae}=Ut(!1);return a.useEffect(function(){(l||!l)&&ae()},[l,ae]),n.jsxs(Ze,{children:[n.jsxs(He,{children:[h,n.jsxs(U,{title:"show filter form",onClick:ht,children:[n.jsx(I,{name:"tune"}),n.jsx("span",{children:"filter"})]}),yt&&n.jsx(on,{filterValue:l,onSetFilterValue:m,onHide:ae})]}),n.jsx("div",{className:sn.Container,children:n.jsx(ke,{tableTitle:"moving objects",tableColumns:k,items:R,noItemsLabel:"no moving objects",isLoading:s,showCreateItemModalButtonLabel:"add moving object",onShowCreateItemModal:S,columnsToSortBy:ie,onColumnHeaderClick:_,selectedItemsUuids:G,onResetSelectedItems:Te,onSelectAllItems:$,onDeleteSelectedItems:Le,searchFieldValue:d,filterValue:l,isAppliedFilter:K,onEnableFilter:te,onDisableFilter:ne,filterInfoFields:ee,children:n.jsx(Ye,{items:R,columns:k,selectedItemsUuids:G,onEditItem:F,onSelectItem:z,lastCreatedOrUpdatedItem:dt})})}),(v||!!p)&&n.jsx(nn,{itemToEdit:p,filterValue:l,onHideModal:j,onShowDeleteItemConfirmation:E,onCreateItem:ut,onUpdateItem:gt}),!!L&&n.jsx(Jt,{onHideModal:u,onHideParentModal:j,itemToDelete:L}),n.jsx(ct,{})]})}),st="moving-entity-class",lt=["uuid","entityType","name","note","image"],yn=Pt(lt);function rt(){return[{name:"uuid",isCheckbox:!0},{name:"name",asLinkToEditItem:!0,isSortable:!0,sort:"asc",alignLabel:"left",actionButtons:function({item:e}){const o=tt({movingEntityClassName:e?.name});return n.jsx(n.Fragment,{children:o?n.jsx(H,{to:o,title:"search by moving entity class in moving entities",children:n.jsx(I,{name:"search_category"})}):n.jsx(U,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search",children:n.jsx(I,{name:"search_off"})})})}},{name:"note",asLinkToEditItem:!0,isSortable:!0,alignLabel:"left"}]}const hn=a.memo(function({itemToDelete:e,onHideModal:o,onHideParentModal:i}){const s=T([C]),l=C(r=>r.delete),m=a.useCallback(function(){o()},[o]),d=a.useCallback(function(){i()},[i]),h=a.useCallback(function(){s||(l(e),m(),d())},[e,m,d,l,s]),g=a.useMemo(function(){return n.jsxs(n.Fragment,{children:["Are you sure you want"," ",n.jsx("strong",{children:"to delete"})," ","the moving object class named",n.jsx("br",{}),n.jsx("strong",{children:e.name}),"?"]})},[e]);return n.jsx(nt,{title:g,onHide:m,onConfirm:h,confirmButtonLabel:"delete moving object class"})});function En(){return[{name:"uuid",type:"hidden"},{name:"entityType",type:"hidden"},{name:"name",required:!0},{name:"note"},{name:"image",type:"file",accept:"image/*"}]}const fn=a.memo(function({itemToEdit:e,filterValue:o,onHideModal:i,onShowDeleteItemConfirmation:c,onCreateItem:s,onUpdateItem:l}){const d=T([C]),h=C(y=>y.create),g=C(y=>y.update),r=a.useCallback(y=>{const S=h(y);typeof s=="function"&&s(S)},[h,s]),f=a.useCallback(y=>{const S=g(y);S&&typeof l=="function"&&l(S)},[g,l]),v=a.useCallback(()=>{i()},[i]),b=a.useCallback(y=>{if(Ke(y)){const S=q(y,lt);f(S)}else{const S=q(y,yn);S.entityType=st,r(S)}v()},[r,f,v]),p=a.useCallback(y=>{if(d)return function(){return n.jsx("span",{children:"Loading..."})};const S=Ot(y);if(S)return function(){return n.jsxs(n.Fragment,{children:["Moving object class named"," ",n.jsx("strong",{children:S?S.name:"(moving object class without name)"})," ","already exists"]})}},[d]),F=a.useMemo(function(){return En()},[]),L=Ge(F,o);return n.jsx($e,{humanizedItemTypeName:"moving object class",itemToEdit:e,formFields:L,validateFormData:p,onCancel:v,onSubmit:b,onDelete:c,deleteItemButtonLabel:"delete moving object class"})});function Sn({urlSearchParams:t,setUrlSearchParams:e}){return Re({urlSearchParams:t,setUrlSearchParams:e,getSearchValueFromUrlSearchParams:pt,searchValueKeyInUrlSearchParams:B,searchFieldNameInSearchForm:B,searchFieldPlaceholderTextInSearchForm:"Search by moving object class..."})}const bn=["name"],vn=["name"],pn=rt().filter(t=>vn.includes(t.name)),Cn=a.memo(function({urlSearchParams:e,setUrlSearchParams:o}){const c=T([C]),{searchFieldValue:s,SearchForm:l,resetSearchFieldValue:m}=Sn({urlSearchParams:e,setUrlSearchParams:o}),d=C(We(_=>_.items())),h=C(_=>_.deleteMultiple),[g,r]=a.useState(!1),[f,v]=a.useState(),[b,p]=a.useState(),F=a.useCallback(()=>{r(!0)},[r]),L=a.useCallback(()=>{v(void 0),r(!1)},[v,r]),y=a.useCallback(_=>{p(_)},[p]),S=a.useCallback(()=>{p(void 0)},[p]),j=a.useMemo(function(){return s?d.filter(G=>!!pn.find($=>{const z=G[$.name];return $.isSearchCaseInsensitive?z?.toLocaleLowerCase()?.includes(s.toLocaleLowerCase()):z?.includes(s)})):d},[s,d]),E=a.useMemo(function(){return rt()},[c]),{sortedItems:u,columnsToSortBy:M,handleColumnSortClick:w}=De(j,E,bn),{selectedItemsUuids:W,handleResetSelectedItems:ee,handleSelectAllItems:K,handleSelectItem:te,handleShowDeleteMultipleSelectedItemsConfirmation:ne,DeleteSelectedItemsConfirmation:oe}=ze({itemTypeNamePlural:"moving object classes",items:u,searchFieldValue:s,deleteItemsByUuids:h,setItemToDelete:p}),{lastCreatedOrUpdatedItem:k,onCreateItem:R,onUpdateItem:ie}=qe({itemEntityType:st,items:u,searchFieldValue:s,resetSearchFieldValue:m});return n.jsxs(Ze,{children:[n.jsx(He,{children:l}),n.jsx(ke,{tableTitle:"moving object classes",tableColumns:E,items:u,noItemsLabel:"no moving object classes",isLoading:c,showCreateItemModalButtonLabel:"add moving object class",onShowCreateItemModal:F,columnsToSortBy:M,onColumnHeaderClick:w,selectedItemsUuids:W,onResetSelectedItems:ee,onSelectAllItems:K,onDeleteSelectedItems:ne,searchFieldValue:s,children:n.jsx(Ye,{items:u,columns:E,selectedItemsUuids:W,onEditItem:v,onSelectItem:te,lastCreatedOrUpdatedItem:k})}),(g||!!f)&&n.jsx(fn,{itemToEdit:f,onHideModal:L,onShowDeleteItemConfirmation:y,onCreateItem:R,onUpdateItem:ie}),!!b&&n.jsx(hn,{onHideModal:S,onHideParentModal:L,itemToDelete:b}),n.jsx(oe,{})]})});function Mn(t){const e=a.useMemo(()=>Be(t),[t]);return a.useMemo(function(){return Mt(Ht({movingEntityName:e}))},[e])}function Tn(){const{urlSearchParams:t,setUrlSearchParams:e}=Ct(),o=Mn(t);return n.jsxs(n.Fragment,{children:[n.jsx("title",{children:o}),n.jsx(Tt,{children:n.jsxs("div",{className:me.Container,children:[n.jsx("div",{className:me.MainTable,children:n.jsx(gn,{urlSearchParams:t,setUrlSearchParams:e})}),n.jsx("div",{className:me.TableGroups,children:n.jsx(Cn,{urlSearchParams:t,setUrlSearchParams:e})})]})})]})}const Wn=Et(function(){return n.jsx(Tn,{})});export{Wn as default};
