import{i as ie,q as e,a,t as re,v as ce,O as le,L as de,S as ue,w as me,x as fe,y as ge,z as he}from"./chunk-PVWAREVJ-D1PIyzeh.js";import{c as pe,a as _e,b as L}from"./ClassNames-CdIKlwZs.js";import{A as Se,a as xe}from"./App.const-Bym5gJCd.js";import{u as Ce,a as Ee,F as Ne,B as h,r as Le,i as je,d as be,D as Te,C as ve,S as De,b as Me,c as M,e as Ae,g as ye,f as w,h as we,l as G,j as V,I as S,k as Ie,m as Q,n as Z,E as I,P as ke,o as Pe,p as Be,q as Fe,s as Oe,t as K,v as Re,w as He,x as Ge}from"./useLoadingPersistStorages-BWX3nPU9.js";import{M as Ve,a as R}from"./ModalConfirmation-BkKL8gix.js";import{M as $}from"./ModalNotification-4U2xs5uf.js";import{D as y,C as v,a as A,u as $e,b as z,H as J,c as O,L as ze}from"./ColorTheme.store-Cona8foo.js";import"./index-D9Tyn9c9.js";const Je={};function Ue({error:o}){let t="Error",n="An unexpected error occured";return ie(o)&&(t=o.status===404?"404":"Unknown status error",n=o.status===404?"the requested page could not be found":o.statusText||"An unexpected error occured"),e.jsxs("main",{className:Je.AppErrorBoundary,style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",gap:"1em"},children:[e.jsx("h1",{style:{margin:"0"},children:t}),e.jsx("p",{style:{margin:"0"},children:n}),!1]})}function Ye({loaderData:o}){return e.jsxs("main",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",gap:"1em"},children:[e.jsx("div",{children:"Loading..."}),e.jsxs("div",{children:["version"," ",o.version]})]})}const P=pe(_e({isVisible:!1},o=>({setIsVisible:t=>{o(()=>({isVisible:t}))}})));function We(){P.setState({isVisible:!0})}function U(){P.setState({isVisible:!1})}const qe="_Container_1k9w5_1",Xe="_ActionButtons_1k9w5_8",Y={Container:qe,ActionButtons:Xe},Qe="_ModalFormBody_7068i_1",Ze="_Content_7068i_10",Ke="_InfoMessageContainer_7068i_18",et="_InfoMessageText_7068i_28",tt="_ErrorMessageContainer_7068i_37",ot="_ErrorMessageText_7068i_47",nt="_ActionButtons_7068i_56",at="_ActionButtonsGroup_7068i_62",C={ModalFormBody:Qe,Content:Ze,InfoMessageContainer:Ke,InfoMessageText:et,ErrorMessageContainer:tt,ErrorMessageText:ot,ActionButtons:nt,ActionButtonsGroup:at};function st({title:o,informationMessage:t,formFields:n,showResetButton:s=!1,resetButtonLabel:l,validateFormData:d,onCancel:r,cancelButtonLabel:m,submitButtonLabel:u,onSubmit:i}){const c=a.useRef(null);Ce(c,n);const{handleSubmit:_,formValidationErrorMessage:p}=Ee({formRef:c,onSubmit:i,formFields:n,validateFormData:d}),j=a.useCallback(()=>{r()},[r]);return e.jsx(Ve,{title:o,onHide:j,children:e.jsxs("form",{ref:c,className:C.ModalFormBody,onSubmit:_,children:[e.jsxs("div",{className:C.Content,children:[t&&e.jsx("div",{className:C.InfoMessageContainer,children:e.jsx("div",{className:C.InfoMessageText,children:typeof t=="function"?t():t})}),e.jsx(Ne,{formFields:n}),p&&e.jsx("div",{className:C.ErrorMessageContainer,role:"alert",children:e.jsx("div",{className:C.ErrorMessageText,children:typeof p=="function"?p():p})})]}),e.jsxs("div",{className:C.ActionButtons,children:[e.jsx(h,{onClick:r,children:m||"cancel"}),e.jsxs("div",{className:C.ActionButtonsGroup,children:[s&&e.jsx(h,{type:"reset",children:l||"reset form"}),e.jsx(h,{type:"submit",primary:!0,children:u||"upload"})]})]})]})})}const it=[{name:"storageDataJsonFile",type:"file",required:!0,label:"file",accept:De}],rt=({onHide:o,onSuccessImport:t})=>{const n=a.useCallback(()=>{typeof o=="function"&&o()},[o]),s=a.useCallback(async({storageDataJsonFile:r})=>{const{jsonString:m,error:u}=await Le(r);if(!m||u)return u||"";const i=await je(m);if(i)return i;n(),typeof t=="function"&&t()},[n,t]),l=a.useCallback(({storageDataJsonFile:r})=>{if(!be(r,Me))return function(){return e.jsxs(e.Fragment,{children:["File should be in"," ",e.jsxs("strong",{children:[".",Te]})," ","or"," ",e.jsxs("strong",{children:[".",ve]})," ","format"]})}},[]),d=a.useCallback(()=>e.jsxs(e.Fragment,{children:["Warning.",e.jsx("br",{}),"Importing data will replace"," ",e.jsx("strong",{children:"all existing data"})," ","in the storage (indexedBD)"]}),[]);return e.jsx(st,{title:"Importing storage data",informationMessage:d,formFields:it,validateFormData:l,onCancel:n,onSubmit:s,submitButtonLabel:"import"})},ct=a.memo(function({onHide:t,onConfirm:n}){const s=a.useMemo(()=>e.jsxs(e.Fragment,{children:["Are you sure you want"," ",e.jsx("strong",{children:"to clear data storage"}),"?",e.jsx("br",{}),"All data will be deleted"]}),[]);return e.jsx(R,{title:s,onHide:t,onConfirm:n,confirmButtonLabel:"clear storage"})}),lt=a.memo(function({onHide:t,onConfirm:n}){const s=a.useMemo(()=>e.jsxs(e.Fragment,{children:["No data in data storage.",e.jsx("br",{}),"Are you want"," ",e.jsx("strong",{children:"to load demo data"}),"?"]}),[]);return e.jsx(R,{title:s,onHide:t,onConfirm:n,confirmButtonLabel:"load demo data"})}),dt=a.memo(function({onHide:t,onConfirm:n}){const s=a.useMemo(()=>e.jsxs(e.Fragment,{children:["Are you sure you want"," ",e.jsx("strong",{children:"to load demo data"}),"?",e.jsx("br",{}),"Note: All existing data will be exported into a file"]}),[]);return e.jsx(R,{title:s,onHide:t,onConfirm:n,confirmButtonLabel:"load demo data"})}),W=5*1e3,k=5*1e3;async function F(){const o=await Ie(Z,Q);if(o)return w({entityType:I,messages:[()=>e.jsx(e.Fragment,{children:o})],hideTimeout:k,tags:["storage-data-cleanup-failure"],type:"error",title:"Data storage cleanup"}),o}const ut=a.memo(function(){const{isVisible:t,show:n,hide:s}=M(!1),{isVisible:l,show:d,hide:r}=M(!1),{isVisible:m,show:u,hide:i}=M(!1),c=Ae(N=>N.isVisible),{isVisible:_,show:p}=M(!1),j=a.useCallback(function(){window.location.reload()},[]),{isVisible:b,show:T}=M(!1),ne=a.useCallback(async function(){const x=await F();if(x)return x;r(),s(),p()},[r,s,p]),B=a.useCallback(async function(){const x=new Date().getTime(),{error:D,indexDBState:H}=await ye(Z,Q);if(D)return w({entityType:I,messages:[()=>e.jsx(e.Fragment,{children:D})],hideTimeout:k,tags:["storage-data-export"],type:"error",title:"Export storage data"}),!0;if(!H)return w({entityType:I,messages:[()=>e.jsx(e.Fragment,{children:"Nothing to export"})],hideTimeout:k,tags:["storage-data-export"],type:"info",title:"Export storage data"}),!0;if(await we(H))return!0;w({entityType:I,messages:[()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Storage data was exported into file."}),e.jsxs("div",{children:["Storage data dump was created at"," ",new Date(x).toLocaleString()]})]})],hideTimeout:k,tags:["storage-data-export"],type:"success",title:"Export storage data"})},[]),ae=a.useCallback(async function(){await B()||await F()||await G()},[B]),se=a.useCallback(async function(){await F()||(await G(),V())},[]);return a.useEffect(function(){if(!b)return;const x=window.setTimeout(function(){window.location.reload()},W);return function(){window.clearTimeout(x)}},[b]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:Y.Container,children:e.jsxs("div",{className:Y.ActionButtons,children:[e.jsx(h,{noPadding:!0,transparent:!0,onClick:d,title:"clear storage",children:e.jsx(S,{name:"ink_eraser"})}),e.jsx(h,{noPadding:!0,transparent:!0,onClick:n,title:"import storage data",children:e.jsx(S,{name:"upload_file"})}),e.jsx(h,{noPadding:!0,transparent:!0,onClick:B,title:"export storage data",children:e.jsx(S,{name:"file_download"})}),e.jsxs(h,{noPadding:!0,transparent:!0,onClick:u,title:"load demo data",children:[e.jsx(S,{name:"description"}),e.jsx("span",{children:"load demo data"})]})]})}),l&&e.jsx(ct,{onHide:r,onConfirm:ne}),t&&e.jsx(rt,{onHide:s,onSuccessImport:T}),m&&e.jsx(dt,{onHide:i,onConfirm:ae}),c&&e.jsx(lt,{onHide:V,onConfirm:se}),_&&e.jsx($,{title:"storage data were successfully deleted",onHide:j,okButtonLabel:"reload page"}),b&&e.jsx($,{title:"storage data was successfully",children:e.jsxs("div",{style:{textAlign:"center",maxHeight:"90%",overflow:"auto"},children:["Page will automatically reload in"," ",Math.ceil(W/1e3)," ","seconds",e.jsx("br",{}),"to use imported storage data"]})})]})}),mt="_InternalNavLink_7yk2l_1",q={InternalNavLink:mt},ft=a.memo(function({to:t,className:n,children:s,...l}){const d=a.useCallback(function(m){return typeof n=="function"?L([q.InternalNavLink,n(m)]):L([q.InternalNavLink,n])},[n]);return e.jsx(re,{to:t,className:d,...l,children:s})}),gt=[{slug:ke,text:"market"},{slug:Pe,text:"locations"},{slug:Be,text:"map"},{slug:Fe,text:"products"},{slug:Oe,text:"moving objects"}],ht="_Navbar_sg2lo_1",pt="_HeaderContainer_sg2lo_13",_t="_Logo_sg2lo_19",St="_LinksList_sg2lo_24",xt="_MobileNavMenuActionButtons_sg2lo_33",Ct="_LinkListItem_sg2lo_37",Et="_NavLink_sg2lo_41",Nt="_Pending_sg2lo_61",Lt="_Active_sg2lo_66",jt="_MobileNavMenu_sg2lo_33",bt="_VisibleMobileNavMenu_sg2lo_104",f={Navbar:ht,HeaderContainer:pt,Logo:_t,LinksList:St,MobileNavMenuActionButtons:xt,LinkListItem:Ct,NavLink:Et,Pending:Nt,Active:Lt,MobileNavMenu:jt,VisibleMobileNavMenu:bt};function E(o){return o===null?"null":typeof o=="object"?o?.constructor?.name||"object":typeof o}function Tt(o,t,n){const s=E(o)===E(t);return s||console.error(`localStorage item '${n}' value has incompatible type (localStorage itemDataType: '${E(o)}', initialDataType: '${E(t)})'`),s}function vt(o,t,n){const s=E(o)===E(t);return s||console.error(`nextState of '${n}' has incompatible value type  (localStorage itemDataType: '${E(o)}', initialDataType: '${E(t)})`),s}function ee(o,t){window.dispatchEvent(new StorageEvent("storage",{key:o,newValue:t}))}function Dt(o,t){try{const n=JSON.stringify(t);window.localStorage?.setItem(o,n),ee(o,n)}catch(n){console.error(n);return}}function Mt(o){try{window.localStorage?.removeItem(o),ee(o,null)}catch(t){console.error(t);return}}function X(o){try{return window.localStorage?.getItem(o)||void 0}catch(t){console.error(t);return}}function At(){}function yt(o,t,n=!1){const s=a.useCallback(function(i){return window.addEventListener("storage",i),function(){window.removeEventListener("storage",i)}},[]),l=a.useCallback(function(){return X(o)},[o]),d=a.useSyncExternalStore(s,l,At),r=a.useMemo(function(){if(d==null)return t;try{const i=JSON.parse(d);return n&&!Tt(i,t,o)?t:i}catch(i){return console.error(i),t}},[t,o,d,n]),m=a.useCallback(function(i){const c=i;n&&!vt(c,t,o)||(c==null?Mt(o):Dt(o,c))},[t,o,n]);return a.useEffect(function(){X(o)},[o,t]),[r,m]}function wt(){return window?.matchMedia?window.matchMedia?.("(prefers-color-scheme: dark)")?.matches?v:window.matchMedia?.("(prefers-color-scheme: light)")?.matches?A:y:y}const It=a.memo(function(){const[t,n]=a.useState(y),[s,l]=yt(ze,z),d=$e(c=>c.setColorTheme),r=a.useMemo(()=>s||t||y,[s,t]);a.useEffect(function(){d(r)},[r,d]);const m=a.useCallback(function(){l(v)},[l]),u=a.useCallback(function(){l(A)},[l]),i=a.useCallback(function(){l(z)},[l]);return a.useEffect(function(){return r===v?window.document.body.classList.add(J):r===A&&window.document.body.classList.add(O),function(){window.document.body.classList.remove(J,O)}},[r]),a.useEffect(function(){if(!window.matchMedia)return;const _=window?.matchMedia?.("(prefers-color-scheme: dark)");function p(T){if(T.matches){n(v);return}}const j=window?.matchMedia?.("(prefers-color-scheme: light)");function b(T){if(T.matches){n(A);return}}return _.addEventListener("change",p),j.addEventListener("change",b),function(){_.removeEventListener("change",p),j.removeEventListener("change",b)}},[n]),a.useEffect(function(){const _=wt();n(_)},[n]),e.jsxs(e.Fragment,{children:[!s&&e.jsx(h,{onClick:m,transparent:!0,noPadding:!0,noBorder:!0,title:"switch to dark theme",children:e.jsx(S,{name:"routine"})}),s===v&&e.jsx(h,{onClick:u,transparent:!0,noPadding:!0,noBorder:!0,title:"switch to light theme",children:e.jsx(S,{name:"dark_mode"})}),s===A&&e.jsx(h,{onClick:i,transparent:!0,noPadding:!0,noBorder:!0,title:"switch to system color scheme",children:e.jsx(S,{name:"light_mode"})})]})}),kt=a.memo(function({link:t}){const n=({isActive:s,isPending:l,isTransitioning:d})=>L([f.NavLink,l&&f.Pending,s&&f.Active,d&&f.Transitioning]);return e.jsx("li",{className:f.LinkListItem,children:e.jsx(ft,{to:t.slug,className:n,children:t.text})})}),Pt=a.memo(function({pageLinks:t}){const n=P(s=>s.isVisible);return e.jsx("ul",{className:L([f.LinksList,f.MobileNavMenu,n&&f.VisibleMobileNavMenu]),children:t.map(s=>e.jsx(kt,{link:s},s.slug))})}),Bt=a.memo(function(){const t=P(s=>s.isVisible),n=ce();return a.useEffect(function(){n.pathname,U()},[n.pathname]),e.jsxs("nav",{className:f.Navbar,children:[e.jsxs("div",{className:f.HeaderContainer,children:[e.jsx("div",{className:f.Logo,children:Se}),e.jsx(ut,{}),e.jsx(It,{})]}),e.jsxs("div",{className:L([f.HeaderContainer,f.MobileNavMenuActionButtons]),children:[t&&e.jsx(h,{noPadding:!0,transparent:!0,onClick:U,title:"hide menu",children:e.jsx(S,{name:"close"})}),!t&&e.jsx(h,{noPadding:!0,transparent:!0,onClick:We,title:"show menu",children:e.jsx(S,{name:"menu"})})]}),e.jsx(Pt,{pageLinks:gt})]})}),Ft="_NotificationContainer_65vy2_1",Ot={NotificationContainer:Ft},Rt="_Notification_nzmsj_25",Ht="_InDisapperState_nzmsj_47",Gt="_AnimationSmoothDisappear_nzmsj_1",Vt="_NotificationContent_nzmsj_51",$t="_NotificationSuccess_nzmsj_72",zt="_NotificationFailure_nzmsj_73",Jt="_NotificationWarning_nzmsj_91",Ut="_TimeoutProgressBar_nzmsj_100",Yt="_NotificationTitle_nzmsj_120",Wt="_MessageList_nzmsj_125",qt="_MessageListItem_nzmsj_132",g={Notification:Rt,InDisapperState:Ht,AnimationSmoothDisappear:Gt,NotificationContent:Vt,NotificationSuccess:$t,NotificationFailure:zt,NotificationWarning:Jt,TimeoutProgressBar:Ut,NotificationTitle:Yt,MessageList:Wt,MessageListItem:qt};function Xt(o){return!(typeof o!="number"||!Number.isFinite(o)||o<=0)}const Qt=a.memo(function({notification:t}){const{type:n,hideTimeout:s}=t,[l,d]=a.useState(!1),r=K(i=>i.delete),m=a.useCallback(function(){d(!0)},[d]),u=a.useCallback(function(c){c.type==="animationend"&&c.animationName===g.AnimationSmoothDisappear&&r(t)},[t,r]);return e.jsxs("div",{className:L([g.Notification,n==="success"&&g.NotificationSuccess,n==="error"&&g.NotificationFailure,n==="warning"&&g.NotificationWarning,n==="info"&&g.NotificationInfo,l&&g.InDisapperState]),onAnimationEnd:u,role:n==="error"?"alert":"log",children:[Xt(s)&&e.jsx("div",{className:g.TimeoutProgressBar,style:{animationDuration:`${s}ms`},onAnimationEnd:m}),e.jsxs("div",{className:g.NotificationContent,children:[!!t.title&&e.jsx("div",{className:g.NotificationTitle,children:t.title}),!!t.messages.length&&e.jsx("div",{className:g.MessageList,children:t.messages?.length&&t.messages.map((i,c)=>e.jsx("div",{className:g.MessageListItem,children:typeof i=="function"?i():i},c))})]})]})}),Zt=a.memo(function(){const t=K(Re(n=>n.items()));return e.jsx("div",{className:Ot.NotificationContainer,children:t.map(n=>e.jsx(Qt,{notification:n},n.uuid))})});function te(){return e.jsxs(e.Fragment,{children:[e.jsx(Bt,{}),e.jsx(le,{}),e.jsx(Zt,{})]})}function Kt(){return e.jsx(te,{})}function eo(){return He(Ge),e.jsx(te,{})}let oe=Kt;oe=eo;const to=oe;function oo({children:o}){const t=L([y===v,O]);return e.jsxs("html",{lang:"en",children:[e.jsxs("head",{children:[e.jsx("meta",{charSet:"utf-8"}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),e.jsx("meta",{name:"theme-color",content:"#eee"}),e.jsx(de,{})]}),e.jsxs("body",{className:t,children:[e.jsx("noscript",{children:"You need to enable JavaScript to run this app."}),e.jsx("div",{id:xe,children:o}),e.jsx(ue,{}),e.jsx(me,{})]})]})}const fo=()=>[{rel:"manifest",href:"/trader/manifest.json"},{rel:"icon",type:"image/svg+xml",href:"/trader/favicon.svg"}],go=fe(Ye),ho=oo,po=ge(Ue),_o=he(to);export{po as ErrorBoundary,go as HydrateFallback,ho as Layout,_o as default,fo as links};
