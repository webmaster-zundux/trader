import{a,q as e,z as Xe}from"./chunk-PVWAREVJ-D1PIyzeh.js";import{q as Ze,r as et,m as ue,s as tt,t as q,u as Q,b as ye,S as pe,T as he,c as Se,i as _,N as ne,d as Ie,k as G,l as ot,v as _e,j as xe,a as nt,w as Ee,p as at}from"./useTableSearch-Ui5oQRZ2.js";import{c as st}from"./createPageTitleWithAppName-C6bNgB-9.js";import{M as it}from"./Main-D4jU2hau.js";import{a1 as A,a2 as rt,a3 as lt,N as ct,w as P,a4 as dt,v as fe,I as T,B as j,a5 as K,O as x,z as W,K as D,y as mt,a6 as ut,a7 as yt,a8 as pt,$ as ht,a9 as St,c as ft,aa as Tt,ab as gt}from"./useLoadingPersistStorages-BWX3nPU9.js";import{I as M}from"./InternalStaticLink-rDmjTW4d.js";import{b as Lt,d as re,p as w,e as $,f as se,a as Ne,g as Oe,h as z,L as bt,E as Be,i as Ct,M as Pt,P as Ft,j as Ue,k as It}from"./getUrlToMapPageWithParams-gLmSAaLz.js";import{S as Te}from"./SearchFormAndTableContainer-Dn0g8KWe.js";import{h as ge,g as J,M as Le,b as be,c as Ce,u as xt,a as At}from"./hasUuid-BkktISKI.js";import{a as Pe}from"./ModalConfirmation-BkKL8gix.js";import{g as ie}from"./getUrlToMarketPageWithParams-DdYQKoX-.js";import{D as jt}from"./DialogFilterForm-CQxhjX2d.js";import{g as Mt}from"./getUrlToMovingEntitiesPageWithParams-CAB83Xnk.js";import"./ClassNames-CdIKlwZs.js";import"./App.const-Bym5gJCd.js";import"./index-D9Tyn9c9.js";const X=Ze();function ke(){const{isHydrating:n,isHydrated:t}=A.getState();if(n||!t)return;const o=rt();_t({locationTypesMap:o})}X.setState({prepareData:ke});A.subscribe(function(){ke()});function _t({locationTypesMap:n}){const t=X.getState();t.isProcessing||(t.setIsProcessing(!0),window.setTimeout(function(){const i=Ot({locationTypesMap:n});t.replaceAll(i),t.setIsProcessing(!1)},0))}function Et(n,t=!1,o){const s=n?.name??"(location type without name)",i=Lt([s]),r=t?et(s,"location type"):i;return{locationTypeNameWithId:i,locationTypeNameWithIdAsLabel:r}}function Nt({locationTypesMap:n,shouldAddSuffixLabel:t=!1}){const o=[];return lt(n).forEach(function(r){const S=r.uuid,{locationTypeNameWithId:d,locationTypeNameWithIdAsLabel:y}=Et(r,t);o.push({uuid:S,name:d,label:y})}),o}function De(n){n.sort((t,o)=>t.name.localeCompare(o.name)),n.forEach(({items:t})=>De(t??[]))}function we({items:n=[],level:t=0,disableOptionsWithoutUuid:o=!0,selectOptions:s=new Array}){return n.forEach(i=>{const{label:r,items:S}=i,d=i.uuid,y=d??"";s.push({value:y,label:r,level:t,disabled:o?!d:!1}),S?.length&&we({items:S,level:t+1,disableOptionsWithoutUuid:o,selectOptions:s})}),s}function Ot({locationTypesMap:n,disableOptionsWithoutUuid:t}){const o=Nt({locationTypesMap:n,shouldAddSuffixLabel:!1});return De(o),we({items:o,disableOptionsWithoutUuid:t})??[]}const Ve="location-type",ve=["uuid","name","image"],Bt=ct(ve),Ut=a.memo(function({itemToDelete:t,onHideModal:o,onHideParentModal:s}){const r=P([A]),S=A(c=>c.delete),d=a.useCallback(function(){o()},[o]),y=a.useCallback(function(){s()},[s]),p=a.useCallback(function(){r||(S(t),d(),y())},[S,t,d,y,r]),u=a.useMemo(()=>e.jsxs(e.Fragment,{children:["Are you sure you want"," ",e.jsx("strong",{children:"to delete"}),e.jsx("br",{}),"the location type named"," ",e.jsx("strong",{children:t.name}),"?"]}),[t]);return e.jsx(Pe,{title:u,onHide:d,onConfirm:p,confirmButtonLabel:"delete location type"})}),kt=[{name:"uuid",type:"hidden"},{name:"entityType",type:"hidden"},{name:"name",required:!0},{name:"image",type:"file",accept:"image/*"}],Dt=a.memo(function({itemToEdit:t,onHideModal:o,onShowDeleteItemConfirmation:s,onCreateItem:i,onUpdateItem:r}){const d=P([A]),y=A(m=>m.create),p=A(m=>m.update),u=a.useCallback(m=>{const l=y(m);typeof i=="function"&&i(l)},[y,i]),c=a.useCallback(m=>{const l=p(m);l&&typeof r=="function"&&r(l)},[p,r]),h=a.useCallback(()=>{o()},[o]),C=a.useCallback(m=>{if(ge(m)){const l=J(m,ve);l.name=l.name.toLocaleLowerCase(),c(l)}else{const l=J(m,Bt);l.entityType=Ve,l.name=l.name.toLocaleLowerCase(),u(l)}h()},[u,c,h]),F=a.useCallback(m=>{if(d)return function(){return e.jsx("span",{children:"Loading..."})};const l=dt(m);if(l)return function(){return e.jsxs(e.Fragment,{children:["Location type named"," ",e.jsx("strong",{children:l.name})," ","already exists"]})}},[d]);return e.jsx(Le,{humanizedItemTypeName:"location type",itemToEdit:t,formFields:kt,validateFormData:F,onCancel:h,onSubmit:C,onDelete:s,deleteItemButtonLabel:"delete location type"})});function wt({urlSearchParams:n,setUrlSearchParams:t}){return ue({urlSearchParams:n,setUrlSearchParams:t,getSearchValueFromUrlSearchParams:tt,searchValueKeyInUrlSearchParams:q,searchFieldNameInSearchForm:q,searchFieldPlaceholderTextInSearchForm:"Search by location type..."})}const Vt=["name"],ce=[{name:"uuid",isCheckbox:!0},{name:"name",asLinkToEditItem:!0,isSortable:!0,sort:"asc",alignLabel:"left",actionButtons:function({item:t}){const o=re({locationTypeName:t?.name});return e.jsx(e.Fragment,{children:o?e.jsx(M,{to:o,title:"search by location type in locations",children:e.jsx(T,{name:"search_category"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search",children:e.jsx(T,{name:"search_off"})})})}}],vt=a.memo(function({urlSearchParams:t,setUrlSearchParams:o}){const s=P([A]),i=Q([X]),r=s||i,[S,d]=a.useState(!1),[y,p]=a.useState(),[u,c]=a.useState(),h=A(fe(N=>N.items())),C=A(N=>N.deleteMultiple),F=a.useCallback(()=>{d(!0)},[d]),m=a.useCallback(()=>{p(void 0),d(!1)},[p,d]),l=a.useCallback(N=>{c(N)},[c]),g=a.useCallback(()=>{c(void 0)},[c]),{searchFieldValue:L,SearchForm:E,resetSearchFieldValue:v}=wt({urlSearchParams:t,setUrlSearchParams:o}),b=a.useMemo(()=>L?h.filter(({name:N})=>N.includes(L)):h,[L,h]),{sortedItems:f,columnsToSortBy:I,handleColumnSortClick:B}=ye(b,ce,Vt),{selectedItemsUuids:U,handleResetSelectedItems:H,handleSelectAllItems:Z,handleSelectItem:ee,handleShowDeleteMultipleSelectedItemsConfirmation:R,DeleteSelectedItemsConfirmation:V}=be({itemTypeNamePlural:"location types",items:f,searchFieldValue:L,deleteItemsByUuids:C,setItemToDelete:c}),{lastCreatedOrUpdatedItem:te,onCreateItem:oe,onUpdateItem:Y}=Ce({itemEntityType:Ve,items:f,searchFieldValue:L,resetSearchFieldValue:v});return e.jsxs(Te,{children:[e.jsx(pe,{children:E}),e.jsx(he,{tableTitle:"location types",tableColumns:ce,items:f,noItemsLabel:"no location types",isLoading:r,showCreateItemModalButtonLabel:"add location type",onShowCreateItemModal:F,columnsToSortBy:I,onColumnHeaderClick:B,selectedItemsUuids:U,onResetSelectedItems:H,onSelectAllItems:Z,onDeleteSelectedItems:R,searchFieldValue:L,children:e.jsx(Se,{items:f,columns:ce,selectedItemsUuids:U,onEditItem:p,onSelectItem:ee,lastCreatedOrUpdatedItem:te})}),(S||!!y)&&e.jsx(Dt,{itemToEdit:y,onHideModal:m,onShowDeleteItemConfirmation:l,onCreateItem:oe,onUpdateItem:Y}),!!u&&e.jsx(Ut,{onHideModal:g,onHideParentModal:m,itemToDelete:u}),e.jsx(V,{})]})}),Ae="Locations";function Ht({locationName:n,planetarySystemName:t}){const o=[n,!!t&&`in ${t}`].filter(s=>!!s);return o.length?`Search ${o.join(" ")} - ${Ae}`:`${Ae}`}const Rt="_Container_anbvv_1",Wt="_MainTable_anbvv_10",Yt="_TableGroups_anbvv_16",de={Container:Rt,MainTable:Wt,TableGroups:Yt};function qt({name:n,label:t,value:o}){const s=P([A]);if(!o)return;const i=s||!_(o)?void 0:K(o)?.name;return i?{label:t??n?.toString(),value:i}:{label:t??n?.toString(),value:"(location type without name)"}}function Gt({name:n,label:t,value:o}){const s=P([x]);if(!o)return;const i=s||!_(o)?void 0:W(o)?.name;return i?{label:t??n?.toString(),value:i}:{label:t??n?.toString(),value:"(planetary system without name)"}}function Kt(){return[{name:"planetarySystemUuid",label:"planetary system",formatLabelAndValue:Gt},{name:"locationTypeUuid",label:"type",formatLabelAndValue:qt}]}const $t=7,zt="0";function Jt({value:n}){const t=a.useMemo(function(){return w(n)},[n]),o=a.useMemo(function(){if(t)return $(t,!1,$t,zt)},[t]);return e.jsx(e.Fragment,{children:typeof o=="string"?o:e.jsx(ne,{children:"(no data)"})})}function Qt({value:n}){const o=P([A])||!_(n)?void 0:K(n)?.name;return o?e.jsx(e.Fragment,{children:o}):e.jsx(ne,{children:"(no type)"})}function Xt({value:n}){const o=P([x])||!_(n)?void 0:W(n)?.name;return o?e.jsx(e.Fragment,{children:o}):e.jsx(ne,{children:"(no data)"})}function Zt({value:n,item:t}){const o=P([x,D]),s=t.uuid,i=o||!_(s)?void 0:mt(s),r=i?i.planetarySystemUuid:void 0,S=o||!_(r)?void 0:W(r),y=a.useMemo(function(){return w(n)},[n])&&se({locationId:i?.id,locationName:i?.name,planetarySystemName:S?.name});return e.jsx(e.Fragment,{children:y?e.jsx(M,{to:y,title:"show location on map",children:e.jsx(T,{name:"location_on"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no position data",children:e.jsx(T,{name:"location_off"})})})}function eo({value:n}){const o=P([A])||!_(n)?void 0:K(n)?.name,s=re({locationTypeName:o});return e.jsx(e.Fragment,{children:s?e.jsx(M,{to:s,title:"search locations by type",children:e.jsx(T,{name:"location_searching"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no location type data",children:e.jsx(T,{name:"location_disabled"})})})}function to({value:n}){const o=P([x])||!_(n)?void 0:W(n)?.name,s=se({planetarySystemName:o}),i=re({planetarySystemName:o}),r=ie({planetarySystemName:o});return e.jsxs(e.Fragment,{children:[s?e.jsx(M,{to:s,title:"show planetary system on map",children:e.jsx(T,{name:"location_on"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no planetary systems data",children:e.jsx(T,{name:"location_off"})}),i?e.jsx(M,{to:i,title:"search locations in the planetary system",children:e.jsx(T,{name:"location_searching"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no planetary system data",children:e.jsx(T,{name:"location_disabled"})}),r?e.jsx(M,{to:r,title:"search by planetary system name in market",children:e.jsx(T,{name:"query_stats"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search in market",children:e.jsx(T,{name:"search_off"})})]})}function oo(n,t){const{isHydrating:o}=ut();if(o)return 0;const s=_(n)&&K(n)?.name||"",i=_(t)&&K(t)?.name||"";return s.localeCompare(i)}function no(n,t){const{isHydrating:o}=yt();if(o)return 0;const s=_(n)&&W(n)?.name||"",i=_(t)&&W(t)?.name||"";return s.localeCompare(i)}function He(){return[{name:"uuid",isCheckbox:!0},{name:"id",asLinkToEditItem:!0,isSortable:!0,alignLabel:"center",uppercase:!0,monospaced:!0,nowrap:!0,isSearchCaseInsensitive:!0,formatValue:function({value:t}){return e.jsx(e.Fragment,{children:typeof t=="string"?t:e.jsx(ne,{children:"(no id)"})})},actionButtons:function({value:t}){const o=ie({locationId:t});return e.jsx(e.Fragment,{children:o?e.jsx(M,{to:o,title:"search by location id in market",children:e.jsx(T,{name:"query_stats"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search in market",children:e.jsx(T,{name:"search_off"})})})}},{name:"name",asLinkToEditItem:!0,isSortable:!0,alignLabel:"left",actionButtons:function({value:t}){const o=ie({locationName:t});return e.jsx(e.Fragment,{children:o?e.jsx(M,{to:o,title:"search by location name in market",children:e.jsx(T,{name:"query_stats"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search in market",children:e.jsx(T,{name:"search_off"})})})}},{name:"locationTypeUuid",label:"type",isSortable:!0,alignLabel:"left",formatValue:Qt,actionButtons:eo,sortFn:oo},{name:"position",isSortable:!0,alignLabel:"right",monospaced:!0,formatValue:Jt,actionButtons:Zt},{name:"planetarySystemUuid",label:"planetary system",isSortable:!0,sort:"asc",alignLabel:"right",formatValue:Xt,actionButtons:to,sortFn:no}]}const ao=a.memo(function({itemToDelete:t,onHideModal:o,onHideParentModal:s}){const i=P([D,x]),r=Q([Ne]),S=i||r,d=D(h=>h.delete),y=a.useCallback(function(){o()},[o]),p=a.useCallback(function(){s()},[s]),u=a.useCallback(function(){S||(d(t),y(),p())},[t,y,p,d,S]),c=a.useMemo(function(){const C=Oe(t.uuid)||"(location without full name)";return e.jsxs(e.Fragment,{children:["Are you sure you want"," ",e.jsx("strong",{children:"to delete"})," ","the location named",e.jsx("br",{}),e.jsx("strong",{children:C}),"?"]})},[t]);return e.jsx(Pe,{title:c,onHide:y,onConfirm:u,confirmButtonLabel:"delete location"})});function je(n=[],t=[]){return[{name:"uuid",type:"hidden"},{name:"entityType",type:"hidden"},{name:"id",uppercase:!0},{name:"name",required:!0},{name:"locationTypeUuid",label:"type",type:"select",options:t,chooseOptionLabel:"choose a location type",noOptionsLabel:"no location types available",allowToSelectNoValueOption:!0},{name:"planetarySystemUuid",label:"planetary system",type:"select",options:n,chooseOptionLabel:"choose a planetary system",noOptionsLabel:"no planetary systems available",allowToSelectNoValueOption:!0},{name:"position"}]}const so=a.memo(function({itemToEdit:t,filterValue:o,onHideModal:s,onShowDeleteItemConfirmation:i,onCreateItem:r,onUpdateItem:S}){const d=P([D,x]),y=Q([z,Ne]),p=d||y,u=D(b=>b.create),c=D(b=>b.update),h=a.useCallback(b=>{const f=u(b);typeof r=="function"&&r(f)},[u,r]),C=a.useCallback(b=>{const f=c(b);f&&typeof S=="function"&&S(f)},[c,S]),F=a.useCallback(()=>{s()},[s]),m=a.useCallback(b=>{if(ge(b)){const f=J(b,Ct);f.id=f.id?.toLocaleUpperCase();const I=w(f.position);I&&(f.position=$(I)),C(f)}else{const f=J(b,bt);f.entityType=Be,f.id=f.id?.toLocaleUpperCase();const I=w(f.position);I&&(f.position=$(I)),h(f)}F()},[h,C,F]),l=a.useCallback(function(f){if(p)return function(){return e.jsx("span",{children:"Loading..."})};const I=f.id;if(I){const B=pt(f);if(B){const U=Oe(B.uuid);return function(){return e.jsxs(e.Fragment,{children:["Location with Id:"," ",e.jsx("strong",{children:I})," ","(",U,")"," ","already exists"]})}}}if(f.position&&!w(f.position))return function(){return e.jsxs(e.Fragment,{children:["Position coordinates have incorrect data."," ",e.jsx("br",{}),"Example:"," ",e.jsx("strong",{children:"[ +100, -100, 0 ]"})," ","or"," ",e.jsx("strong",{children:"100,-100,0"})]})}},[p]),g=z(b=>b.items),L=X(b=>b.items),E=a.useMemo(function(){return p?je([],[]):je(g,L)},[g,L,p]),v=xt(E,o);return e.jsx(Le,{humanizedItemTypeName:"location",itemToEdit:t,formFields:v,validateFormData:l,onCancel:F,onSubmit:m,onDelete:i,deleteItemButtonLabel:"delete location"})}),me=(n,t)=>[{name:"planetarySystemUuid",label:"planetary system",type:"select",options:n,chooseOptionLabel:"choose a planetary system",noOptionsLabel:"no planetary system available",allowToSelectNoValueOption:!0,filterPredicate:(o,s)=>o.planetarySystemUuid===s.planetarySystemUuid},{name:"locationTypeUuid",label:"type",type:"select",options:t,chooseOptionLabel:"choose a location type",noOptionsLabel:"no location type available",allowToSelectNoValueOption:!0,filterPredicate:(o,s)=>o.locationTypeUuid===s.locationTypeUuid}],io=a.memo(function({filterValue:t,onSetFilterValue:o,onHide:s}){const i=P([x]),r=Q([z]),S=i||r,d=z(h=>h.items),y=X(h=>h.items),p=a.useMemo(function(){return S?me([],[]):me(d,y)},[d,S,y]),u=a.useCallback(function(){s()},[s]),c=a.useCallback(function(C){o(C),u()},[u,o]);return e.jsx(e.Fragment,{children:e.jsx("div",{style:{position:"absolute",top:0,right:0},children:e.jsx(jt,{humanizedPluralItemTypeName:"locations",filterValue:t,formFields:p,onCancel:u,onFilter:c})})})}),ro=[G,q];function Me(n){const t={planetarySystemName:n.get(G)||void 0,locationTypeName:n.get(q)||void 0};return ot(t)}function lo({filterValue:n}){if(!n)return;const{planetarySystemName:t,locationTypeName:o,...s}=n,i=t?ht(t)?.uuid:void 0,r=o?St(o)?.uuid:void 0;return{...s,planetarySystemUuid:i,locationTypeUuid:r}}function co({urlSearchParams:n,setUrlSearchParams:t}){const o=P([x,A]),s=Q([z,X]),i=o||s,r=a.useRef(void 0),S=a.useMemo(function(){const p=Me(n),u=lo({filterValue:p}),c=r.current;return Ie(c,u)?(r.current=u,u):c},[n,r,i]),d=a.useCallback(function(p){let u;if(typeof p=="function")throw new Error("LocationValue as setState(prev=>newState) function not supported");p&&Object.keys(p).length>0&&(u=p),t(c=>{const h=Me(c);if(Ie(h,u)){if(!u)return ro.forEach(L=>{c.delete(L)}),c;const F=u.planetarySystemUuid,m=F?W(F)?.name:void 0;m?c.set(G,m):c.delete(G);const l=u.locationTypeUuid,g=l?K(l)?.name:void 0;g?c.set(q,g):c.delete(q)}return c})},[t]);return{filterValue:S,setFilterValueToUrlSearchParams:d}}function mo({urlSearchParams:n,setUrlSearchParams:t}){return ue({urlSearchParams:n,setUrlSearchParams:t,getSearchValueFromUrlSearchParams:_e,searchValueKeyInUrlSearchParams:xe,searchFieldNameInSearchForm:xe,searchFieldPlaceholderTextInSearchForm:"Search by location name or location id..."})}const uo=["name","planetarySystemUuid","locationTypeUuid","position"],yo=["id","name"],po=He().filter(n=>yo.includes(n.name)),ho=a.memo(function({urlSearchParams:t,setUrlSearchParams:o}){const i=P([D,x,A]),{filterValue:r,setFilterValueToUrlSearchParams:S}=co({urlSearchParams:t,setUrlSearchParams:o}),{searchFieldValue:d,SearchForm:y,resetSearchFieldValue:p}=mo({urlSearchParams:t,setUrlSearchParams:o}),u=D(fe(O=>O.items())),c=D(O=>O.deleteMultiple),[h,C]=a.useState(!1),[F,m]=a.useState(),[l,g]=a.useState(),L=a.useCallback(()=>{C(!0)},[C]),E=a.useCallback(()=>{m(void 0),C(!1)},[m,C]),v=a.useCallback(O=>{g(O)},[g]),b=a.useCallback(()=>{g(void 0)},[g]),f=a.useMemo(function(){return d?u.filter(Qe=>!!po.find(Fe=>{let ae=Qe[Fe.name];return Fe.isSearchCaseInsensitive?(ae=ae?.toLocaleLowerCase(),ae?.includes(d.toLocaleLowerCase())):ae?.includes(d)})):u},[d,u]),I=a.useMemo(function(){return me([],[])},[]),B=a.useMemo(function(){return Kt()},[]),{isAppliedFilter:U,enableFilter:H,disableFilter:Z}=At(r),ee=nt(f,I,U?r:void 0),R=a.useMemo(function(){return He()},[]),{sortedItems:V,columnsToSortBy:te,handleColumnSortClick:oe}=ye(ee,R,uo),{selectedItemsUuids:Y,handleResetSelectedItems:N,handleSelectAllItems:k,handleSelectItem:Re,handleShowDeleteMultipleSelectedItemsConfirmation:We,DeleteSelectedItemsConfirmation:Ye}=be({itemTypeNamePlural:"locations",items:V,searchFieldValue:d,filterValue:r,deleteItemsByUuids:c,setItemToDelete:g}),qe=a.useCallback(function(){S(void 0)},[S]),{lastCreatedOrUpdatedItem:Ge,onCreateItem:Ke,onUpdateItem:$e}=Ce({itemEntityType:Be,items:V,searchFieldValue:d,filterValue:r,resetSearchFieldValue:p,resetFilterValue:qe}),{isVisible:ze,show:Je,hide:le}=ft(!1);return a.useEffect(function(){(r||!r)&&le()},[r,le]),e.jsxs(Te,{children:[e.jsxs(pe,{children:[y,e.jsxs(j,{title:"show filter form",onClick:Je,children:[e.jsx(T,{name:"tune"}),e.jsx("span",{children:"filter"})]}),ze&&e.jsx(io,{filterValue:r,onSetFilterValue:S,onHide:le})]}),e.jsx(he,{tableTitle:"locations",tableColumns:R,items:V,noItemsLabel:"no locations",isLoading:i,showCreateItemModalButtonLabel:"add location",onShowCreateItemModal:L,columnsToSortBy:te,onColumnHeaderClick:oe,selectedItemsUuids:Y,onResetSelectedItems:N,onSelectAllItems:k,onDeleteSelectedItems:We,searchFieldValue:d,filterValue:r,isAppliedFilter:U,onEnableFilter:H,onDisableFilter:Z,filterInfoFields:B,children:e.jsx(Se,{items:V,columns:R,selectedItemsUuids:Y,onEditItem:m,onSelectItem:Re,lastCreatedOrUpdatedItem:Ge})}),(h||!!F)&&e.jsx(so,{itemToEdit:F,filterValue:r,onHideModal:E,onShowDeleteItemConfirmation:v,onCreateItem:Ke,onUpdateItem:$e}),!!l&&e.jsx(ao,{onHideModal:b,onHideParentModal:E,itemToDelete:l}),e.jsx(Ye,{})]})}),So=0,fo="0";function To({value:n}){const t=a.useMemo(function(){return w(n)},[n]),o=a.useMemo(function(){if(t)return $(t,!1,So,fo)},[t]);return e.jsx(e.Fragment,{children:typeof o=="string"?o:e.jsx(ne,{children:"(no data)"})})}function go(){return[{name:"uuid",isCheckbox:!0},{name:"name",asLinkToEditItem:!0,isSortable:!0,sort:"asc",alignLabel:"left",actionButtons:function({item:t}){const o=re({planetarySystemName:t?.name}),s=Mt({planetarySystemName:t?.name}),i=ie({planetarySystemName:t?.name});return e.jsxs(e.Fragment,{children:[s?e.jsx(M,{to:s,title:"search moving objects in the planetary system",children:e.jsx(T,{name:"rocket_launch"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search",children:e.jsx(T,{name:"search_off"})}),o?e.jsx(M,{to:o,title:"search locations in the planetary system",children:e.jsx(T,{name:"location_searching"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search",children:e.jsx(T,{name:"search_off"})}),i?e.jsx(M,{to:i,title:"search orders in market",children:e.jsx(T,{name:"query_stats"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search",children:e.jsx(T,{name:"search_off"})})]})}},{name:"position",isSortable:!0,monospaced:!0,formatValue:To,actionButtons:function({item:t}){const o=w(t.position),s=se({planetarySystemName:t?.name}),i=o&&se({planetarySystemName:t?.name,mapMode:Pt});return e.jsxs(e.Fragment,{children:[s?e.jsx(M,{to:s,title:"show on map what the planetary system contains",children:e.jsx(T,{name:"planet_orbit"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search",children:e.jsx(T,{name:"not_listed_location"})}),i?e.jsx(M,{to:i,title:"show planetary system on map",children:e.jsx(T,{name:"location_on"})}):e.jsx(j,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search",children:e.jsx(T,{name:"not_listed_location"})})]})}}]}const Lo=a.memo(function({itemToDelete:t,onHideModal:o,onHideParentModal:s}){const r=P([x]),S=x(c=>c.delete),d=a.useCallback(function(){o()},[o]),y=a.useCallback(function(){s()},[s]),p=a.useCallback(function(){r||(S(t),d(),y())},[S,t,d,y,r]),u=a.useMemo(()=>e.jsxs(e.Fragment,{children:["Are you sure you want"," ",e.jsx("strong",{children:"to delete"}),e.jsx("br",{}),"the planetary system named"," ",e.jsx("strong",{children:t.name}),"?"]}),[t]);return e.jsx(Pe,{title:u,onHide:d,onConfirm:p,confirmButtonLabel:"delete planetary system"})}),bo=[{name:"uuid",type:"hidden"},{name:"entityType",type:"hidden"},{name:"name",required:!0},{name:"position"}],Co=a.memo(function({itemToEdit:t,onHideModal:o,onShowDeleteItemConfirmation:s,onCreateItem:i,onUpdateItem:r}){const d=P([x]),y=x(m=>m.create),p=x(m=>m.update),u=a.useCallback(m=>{const l=y(m);typeof i=="function"&&i(l)},[y,i]),c=a.useCallback(m=>{const l=p(m);l&&typeof r=="function"&&r(l)},[p,r]),h=a.useCallback(()=>{o()},[o]),C=a.useCallback(m=>{if(ge(m)){const l=J(m,It);l.name=l.name.toLocaleLowerCase();const g=w(l.position);g&&(l.position=$(g)),c(l)}else{const l=J(m,Ft);l.entityType=Ue,l.name=l.name.toLocaleLowerCase();const g=w(l.position);g&&(l.position=$(g)),u(l)}h()},[u,c,h]),F=a.useCallback(m=>{if(d)return function(){return e.jsx("span",{children:"Loading..."})};const l=Tt(m);if(l)return function(){return e.jsxs(e.Fragment,{children:["Planetary system"," ",e.jsx("strong",{children:l.name})," ","already exists"]})};if(!m.position)return;const L=gt(m);if(L)return function(){return e.jsxs(e.Fragment,{children:["Planetary system with position"," ",e.jsx("strong",{children:L.position})," ","(named"," ",e.jsx("strong",{children:L.name})," ",") already exists"]})}},[d]);return e.jsx(Le,{humanizedItemTypeName:"planetary system",itemToEdit:t,formFields:bo,validateFormData:F,onCancel:h,onSubmit:C,onDelete:s,deleteItemButtonLabel:"delete planetary system"})});function Po({urlSearchParams:n,setUrlSearchParams:t}){return ue({urlSearchParams:n,setUrlSearchParams:t,getSearchValueFromUrlSearchParams:Ee,searchValueKeyInUrlSearchParams:G,searchFieldNameInSearchForm:G,searchFieldPlaceholderTextInSearchForm:"Search by planetary system name..."})}const Fo=["name","position"],Io=a.memo(function({urlSearchParams:t,setUrlSearchParams:o}){const s=P([x]),i=Q([z]),r=s||i,[S,d]=a.useState(!1),[y,p]=a.useState(),[u,c]=a.useState(),h=x(fe(k=>k.items())),C=x(k=>k.deleteMultiple),F=a.useCallback(()=>{d(!0)},[d]),m=a.useCallback(()=>{p(void 0),d(!1)},[p,d]),l=a.useCallback(k=>{c(k)},[c]),g=a.useCallback(()=>{c(void 0)},[c]),{searchFieldValue:L,SearchForm:E,resetSearchFieldValue:v}=Po({urlSearchParams:t,setUrlSearchParams:o}),b=a.useMemo(()=>L?h.filter(({name:k})=>k.includes(L)):h,[L,h]),f=a.useMemo(function(){return go()},[]),{sortedItems:I,columnsToSortBy:B,handleColumnSortClick:U}=ye(b,f,Fo),{selectedItemsUuids:H,handleResetSelectedItems:Z,handleSelectAllItems:ee,handleSelectItem:R,handleShowDeleteMultipleSelectedItemsConfirmation:V,DeleteSelectedItemsConfirmation:te}=be({itemTypeNamePlural:"planetary systems",items:I,searchFieldValue:L,deleteItemsByUuids:C,setItemToDelete:c}),{lastCreatedOrUpdatedItem:oe,onCreateItem:Y,onUpdateItem:N}=Ce({itemEntityType:Ue,items:I,searchFieldValue:L,resetSearchFieldValue:v});return e.jsxs(Te,{children:[e.jsx(pe,{children:E}),e.jsx(he,{tableTitle:"planetary systems",tableColumns:f,items:I,noItemsLabel:"no planetary systems",isLoading:r,showCreateItemModalButtonLabel:"add planetary system",onShowCreateItemModal:F,columnsToSortBy:B,onColumnHeaderClick:U,selectedItemsUuids:H,onResetSelectedItems:Z,onSelectAllItems:ee,onDeleteSelectedItems:V,searchFieldValue:L,children:e.jsx(Se,{items:I,columns:f,selectedItemsUuids:H,onEditItem:p,onSelectItem:R,lastCreatedOrUpdatedItem:oe})}),(S||!!y)&&e.jsx(Co,{itemToEdit:y,onHideModal:m,onShowDeleteItemConfirmation:l,onCreateItem:Y,onUpdateItem:N}),!!u&&e.jsx(Lo,{onHideModal:g,onHideParentModal:m,itemToDelete:u}),e.jsx(te,{})]})});function xo(n){const t=a.useMemo(()=>Ee(n),[n]),o=a.useMemo(()=>_e(n),[n]);return a.useMemo(function(){return st(Ht({locationName:o,planetarySystemName:t}))},[o,t])}function Ao(){const{urlSearchParams:n,setUrlSearchParams:t}=at(),o=xo(n);return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:o}),e.jsx(it,{children:e.jsxs("div",{className:de.Container,children:[e.jsxs("div",{className:de.TableGroups,children:[e.jsx(Io,{urlSearchParams:n,setUrlSearchParams:t}),e.jsx(vt,{urlSearchParams:n,setUrlSearchParams:t})]}),e.jsx("div",{className:de.MainTable,children:e.jsx(ho,{urlSearchParams:n,setUrlSearchParams:t})})]})})]})}const qo=Xe(function(){return e.jsx(Ao,{})});export{qo as default};
