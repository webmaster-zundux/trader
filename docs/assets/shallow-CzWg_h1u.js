import{a as c,p as o,q as X}from"./chunk-NL6KNZEE-BTkWJe7M.js";import{ax as J,ay as Q,p as Z,n as B,B as M,Y as C,az as ee}from"./useLoadingPersistStorages-PEsUDW_D.js";import{a as te}from"./index-D_ImYj8K.js";function It(t){const[e,n]=c.useState(t),r=c.useCallback(()=>{n(!0)},[n]),s=c.useCallback(()=>{n(!1)},[n]),a=c.useCallback(()=>{n(i=>!i)},[n]);return{isVisible:e,show:r,hide:s,toggle:a}}const O=J();function $(){return O.getState().items()}function G(){const t=$(),e=t[t.length-1];if(e)return e}function v(){const t=$(),e=t[t.length-2];if(e)return e}const ne="Escape";function re({onClose:t,currentModalDialog:e}){c.useEffect(function(){if(typeof t!="function"||!e)return;function r(s){if(typeof t=="function"&&s.key===ne){const a=G();if(!Object.is(e,a))return;t()}}return document.addEventListener("keydown",r),function(){document.removeEventListener("keydown",r)}},[t,e])}const H="root";function q(t){return`modal-dialog-${t}`}function oe(){const t=document.documentElement;return t.scrollHeight>t.clientHeight}function W(t){const e=window.getComputedStyle(t),n=e.overflow;if(n==="hidden")return;const r=t.style,s=e.paddingRight;return r.overflow="hidden",oe()&&(r.paddingRight="0.5em"),{overflow:n,paddingRight:s}}function K(t,e){const n=t.style;n.overflow=e.overflow,n.paddingRight=e.paddingRight}function ae(t,e){c.useEffect(function(){const r=t.current;if(!r||!e)return;const s=G();if(Object.is(e,s))return;const a=W(r);if(a)return function(){K(r,a)}},[t,e])}function se(t,e){c.useEffect(function(){if(!t.current||!e)return;const s=v();if(!(s!=null&&s.uuid))return;const a=q(s.uuid);let i=document.getElementById(a);if(!i&&(i=document.getElementById(H),!i))return;const u=W(i);if(u)return function(){K(i,u)}},[t,e])}function ie(t){let e;if(t!=null&&t.uuid){const n=q(t.uuid);e=document.getElementById(n)}if(!(!e&&(e=document.getElementById(H),!e)))return e}function ce(t){return t.getAttribute("inert")!==null}function le(t,e){c.useEffect(function(){if(!t.current||!e)return;const s=v(),a=ie(s);if(a&&!ce(a))return a.setAttribute("inert",""),function(){a.removeAttribute("inert")}},[t,e])}const ue=c.memo(Q),de="_ModalWrapper_qjgbx_1",me="_Backdrop_qjgbx_13",fe="_ModalContainer_qjgbx_19",ge="_CloseButtonContainer_qjgbx_36",pe="_SizeTiny_qjgbx_43",be="_SizeSmall_qjgbx_47",he="_SizeMedium_qjgbx_51",Fe="_SizeLarge_qjgbx_55",xe="_HeaderContainer_qjgbx_131",ye="_NoPaddingForCloseButton_qjgbx_139",Ee="_TitleContainer_qjgbx_143",_e="_Title_qjgbx_143",je="_CenterText_qjgbx_162",Ce="_SubTitle_qjgbx_166",E={ModalWrapper:de,Backdrop:me,ModalContainer:fe,CloseButtonContainer:ge,SizeTiny:pe,SizeSmall:be,SizeMedium:he,SizeLarge:Fe,HeaderContainer:xe,NoPaddingForCloseButton:ye,TitleContainer:Ee,Title:_e,CenterText:je,SubTitle:Ce},Ie="modal-dialog",Se=["uuid","entityType"];Z(Se);function Le(){const t=O(s=>s.create),e=O(s=>s.delete),[n,r]=c.useState(void 0);return c.useEffect(function(){const a=t({entityType:Ie});return r(a),function(){r(void 0),e(a)}},[r,t,e]),n}function Ne({title:t,isTitleCentered:e,subTitle:n,size:r,noCloseButton:s,onHide:a,children:i}){const u=c.useRef(null),l=Le();ae(u,l),se(u,l),le(u,l),re({onClose:a,currentModalDialog:l});const d=c.useCallback(function(){typeof a=="function"&&a()},[a]),m=c.useMemo(function(){return typeof a=="function"},[a]),f=c.useId(),g=c.useId(),p=c.useMemo(function(){if(l)return q(l.uuid)},[l]);return te.createPortal(o.jsx(o.Fragment,{children:!!p&&o.jsxs("div",{ref:u,className:E.ModalWrapper,id:p,children:[o.jsx("div",{className:E.Backdrop,onClick:d,role:"presentation"}),o.jsxs("div",{className:B([E.ModalContainer,(!r||r==="tiny")&&E.SizeTiny,r==="small"&&E.SizeSmall,r==="medium"&&E.SizeMedium,r==="large"&&E.SizeLarge]),role:"dialog","aria-modal":"true","aria-labelledby":f,...n?{"aria-describedby":g}:void 0,children:[(!!t||!!n)&&o.jsx("div",{className:B([E.HeaderContainer,(s||!m)&&E.NoPaddingForCloseButton]),children:o.jsxs("div",{className:E.TitleContainer,children:[o.jsx("h2",{className:B([E.Title,e&&E.CenterText]),id:f,children:t}),!!n&&o.jsx("div",{className:E.SubTitle,id:g,children:n})]})}),i,!s&&m&&o.jsx("div",{className:E.CloseButtonContainer,children:o.jsx(M,{size:"small",transparent:!0,noBorder:!0,noPadding:!0,onClick:d,title:"close",children:o.jsx(ue,{})})})]})]})}),document.body)}const we=c.memo(Ne),Me="_FieldContainer_1rojq_1",ke="_FieldLabel_1rojq_6",Te="_RequiredLabel_1rojq_30",D={FieldContainer:Me,FieldLabel:ke,RequiredLabel:Te},Be=c.memo(function({name:e,label:n,hideFieldLabel:r,required:s,children:a}){return o.jsxs("div",{className:D.FieldContainer,children:[!r&&!!n&&o.jsxs("label",{htmlFor:e,className:D.FieldLabel,children:[n,s?o.jsx("span",{className:D.RequiredLabel,children:"(required)"}):""]}),a]})}),De="_CheckboxGroupField_o8xmk_1",Oe="_Item_o8xmk_9",qe="_NoItemsLabel_o8xmk_14",w={CheckboxGroupField:De,Item:Oe,NoItemsLabel:qe},Ae=c.memo(function({items:e,noItemsLabel:n="no items",defaultValue:r=[],disabled:s,name:a,autoFocusOnFirstRender:i}){const u=c.useMemo(()=>s,[s]),l=c.useCallback(m=>!!r.find(g=>g===m),[r]),d=C({autoFocus:i});return o.jsxs("div",{className:w.CheckboxGroupField,children:[!e.length&&o.jsx("div",{className:w.NoItemsLabel,children:n}),e.length&&o.jsx(o.Fragment,{children:e.map(({value:m,label:f,disabled:g},p)=>o.jsxs("div",{className:w.Item,children:[o.jsx("input",{ref:p===0?d:null,type:"checkbox",name:a,value:m,id:m,disabled:g||u,defaultChecked:l(m),className:w.Checkbox}),o.jsx("label",{htmlFor:m,className:w.CheckboxLabel,children:f})]},`${p}-${m}`))})]})}),Ue="_SelectField_1jo1y_1",Pe="_NoOptionsLabel_1jo1y_10",T={SelectField:Ue,NoOptionsLabel:Pe},Re=c.memo(function({options:e,showNoValueOption:n=!0,chooseOptionLabel:r="choose an option",noOptionsLabel:s="no options",disabled:a,allowToSelectNoValueOption:i=!1,onFieldValueChange:u,name:l,autoFocusOnFirstRender:d,...m}){const f=c.useCallback(p=>{if(typeof u!="function")return;if(!l){console.error("Error. Form field must have name");return}const b=p.target.value;u(l,b)},[u,l]),g=C({autoFocus:d});return o.jsxs("select",{ref:g,autoComplete:"off",className:T.SelectField,disabled:!(e!=null&&e.length)||a,name:l,onChange:f,...m,children:[!e.length&&o.jsx("option",{value:"",className:T.NoOptionsLabel,children:s}),e.length&&o.jsxs(o.Fragment,{children:[n&&o.jsx("option",{value:"",className:T.DefaultSelectOption,disabled:!i,children:r}),e.map(({value:p,label:b,level:h,disabled:F},S)=>o.jsxs("option",{value:p,disabled:F,className:T.SelectOption,children:[!!h&&o.jsx(o.Fragment,{children:Array(h).fill("").map((x,y)=>o.jsx(c.Fragment,{children:"   "},y))}),b]},`${S}-${p}`))]})]})});function Ve(t){return(t==null?void 0:t.type)==="hidden"}function ze(t){return(t==null?void 0:t.type)!=="hidden"}function $e(t){return(t==null?void 0:t.type)==="text"||(t==null?void 0:t.type)===void 0}function Ge(t){return(t==null?void 0:t.type)==="multiline-text"}function ve(t){return(t==null?void 0:t.type)==="number"}function He(t){return(t==null?void 0:t.type)==="select"}function We(t){return(t==null?void 0:t.type)==="checkbox-group"}function Ke(t){return(t==null?void 0:t.type)==="file"}const Ye="_FileField_18uop_1",Xe={FileField:Ye},Je=c.memo(function({onFieldValueChange:e,name:n,autoFocusOnFirstRender:r,...s}){const a=c.useCallback(u=>{if(typeof e!="function")return;if(!n){console.error("Error. Form field must have name");return}const l=u.target.value;e(n,l)},[e,n]),i=C({autoFocus:r});return o.jsx("input",{ref:i,type:"file",className:Xe.FileField,name:n,onChange:a,...s})}),Qe=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(r),r.onerror=s=>n(s),r.readAsDataURL(t)});function Ze(t,e){return new File([t],e,{type:t.type})}async function et(t,e){const n=new Blob([await t.arrayBuffer()]),r=URL.createObjectURL(n);return new Promise((s,a)=>{try{const i=new Image;i.onload=function(){try{let l=function(f){if(!f){a("Error. Impossible to read image data as blob from canvas");return}s(f)};URL.revokeObjectURL(r);const d=document.createElement("canvas");t.type==="image/svg"?(d.width=(e==null?void 0:e.width)||i.naturalWidth,d.height=(e==null?void 0:e.height)||i.naturalHeight):(d.width=i.naturalWidth,d.height=i.naturalHeight);const m=d.getContext("2d");if(!m){a("Error. Canvas 2d rendering context is not supported");return}m.drawImage(i,0,0),d.toBlob(l,"image/webp")}catch(l){a(l)}},i.onerror=u=>a(u),i.src=r}catch(i){a(i)}})}const tt=async t=>new Promise((e,n)=>{fetch(t).then(r=>r.blob()).then(r=>e(r)).catch(r=>n(r))}),nt="_ImageFileField_177w6_1",rt="_ExistingImageContainer_177w6_11",ot="_ImageContainer_177w6_18",at="_Image_177w6_1",st="_ActionButtonGroup_177w6_40",it="_LoadingProgressBar_177w6_53",I={ImageFileField:nt,ExistingImageContainer:rt,ImageContainer:ot,Image:at,ActionButtonGroup:st,LoadingProgressBar:it},ct=c.memo(function({onFieldValueChange:e,name:n,defaultValue:r,autoFocusOnFirstRender:s,...a}){const[i,u]=c.useState(),[l,d]=c.useState(r||""),[m,f]=c.useState(!1),[g,p]=c.useState(!1);c.useEffect(function(){async function j(){if(r!=null&&r.length)try{f(!0);const _=await tt(r),N=URL.createObjectURL(_);u(N),f(!1)}catch(_){console.warn("Warning. FileField default value can not be readed as blob",_),f(!1)}}return j(),function(){}},[r,u,f]),c.useEffect(function(){if(!i)return;const j=i;return function(){URL.revokeObjectURL(j)}},[i]);const b=c.useCallback(async L=>{var U;let j,_,N;try{const k=(U=L.target.files)==null?void 0:U[0];if(!k)return;p(!0),j=await et(k),_=URL.createObjectURL(j);const Y=Ze(j,"blob-converted-to-webp-format.webp"),P=(await Qe(Y)).result;if(typeof P!="string"){console.error("Error reading the image as data url");return}N=P}catch(k){console.error(k),p(!1);return}if(d(N),u(_),p(!1),typeof e=="function"){if(!n){console.error("Error. Form field must have name");return}e(n,N);return}},[u,d,e,n,p]),h=c.useCallback(function(){window.open(i)},[i]),F=c.useCallback(function(){u(void 0),d("")},[u,d]),S=c.useMemo(()=>!!(l!=null&&l.length),[l]),x=C({autoFocus:s}),y=c.useId(),A=m||g;return o.jsxs(o.Fragment,{children:[A&&o.jsxs("div",{className:I.LoadingProgressBar,children:[o.jsx("progress",{id:y,"aria-labelledby":y}),o.jsxs("label",{htmlFor:y,children:[g?"uploading":"loading"," ","image..."]})]}),!A&&o.jsx(o.Fragment,{children:S?o.jsxs("div",{className:I.ExistingImageContainer,children:[o.jsx("input",{type:"hidden",name:n,defaultValue:l}),o.jsxs("div",{className:I.ImageContainer,children:[o.jsx("img",{className:I.Image,src:i,title:"uploaded file preview",alt:"uploaded file preview"}),o.jsxs("div",{className:I.ActionButtonGroup,children:[o.jsx(M,{title:"open full size in new tab",onClick:h,children:"open full size"}),o.jsx(M,{title:"delete image",onClick:F,children:"delete"})]})]})]}):o.jsx("input",{ref:x,type:"file",className:I.ImageFileField,name:n,onChange:b,...a})})]})}),lt="_NumberField_14cz5_1",ut={NumberField:lt},dt=c.memo(function({name:e,min:n,max:r,formatValue:s,defaultValue:a,autoFocusOnFirstRender:i,...u}){const l=n??Number.MIN_SAFE_INTEGER,d=r??Number.MAX_SAFE_INTEGER,m=Math.max(l,Number.MIN_SAFE_INTEGER),f=Math.min(d,Number.MAX_SAFE_INTEGER),g=c.useMemo(function(){return typeof s=="function"?s(a):a},[s,a]),p=C({autoFocus:i});return o.jsx(o.Fragment,{children:o.jsx("input",{ref:p,autoComplete:"off",type:"number",className:ut.NumberField,name:e,min:m,max:f,defaultValue:g,...u})})}),mt="_TextareaField_1s9r3_1",ft={TextareaField:mt},gt=c.memo(function({autoComplete:e="off",onFieldValueChange:n,name:r,value:s,autoFocusOnFirstRender:a,...i}){const u=c.useCallback(function(m){if(typeof n!="function")return;if(!r){console.error("Error. Form field must have name");return}const f=m.target.value;n(r,f)},[n,r]),l=C({autoFocus:a});return o.jsx("textarea",{ref:l,autoComplete:e,className:ft.TextareaField,name:r,value:s,onChange:u,...i})}),pt=c.memo(function({field:e,fieldValue:n,autoFocusOnFirstRender:r=!1,hideFieldLabel:s=!1}){return o.jsx(o.Fragment,{children:o.jsxs(Be,{name:e.name,label:e.label??e.name,hideFieldLabel:s,required:e.required,children:[We(e)&&o.jsx(Ae,{id:e.name,name:e.name,autoFocusOnFirstRender:r,required:e.required,items:e.items,defaultValue:n??e.defaultValue,noItemsLabel:e.noItemsLabel}),He(e)&&o.jsx(Re,{id:e.name,name:e.name,autoFocusOnFirstRender:r,required:e.required,options:e.options,defaultValue:n??e.defaultValue,chooseOptionLabel:e.chooseOptionLabel,noOptionsLabel:e.noOptionsLabel,allowToSelectNoValueOption:e.allowToSelectNoValueOption}),Ke(e)&&o.jsx(o.Fragment,{children:e.accept==="image/*"?o.jsx(ct,{id:e.name,name:e.name,autoFocusOnFirstRender:r,required:e.required,defaultValue:n??e.defaultValue,accept:e.accept}):o.jsx(Je,{id:e.name,name:e.name,autoFocusOnFirstRender:r,required:e.required,accept:e.accept})}),ve(e)&&o.jsx(dt,{id:e.name,name:e.name,pattern:e.pattern,step:e.step,autoFocusOnFirstRender:r,required:e.required,defaultValue:n??e.defaultValue,formatValue:e.formatValue,min:e.min,max:e.max}),$e(e)&&o.jsx(ee,{id:e.name,name:e.name,type:e.type,autoFocusOnFirstRender:r,required:e.required,defaultValue:n??e.defaultValue,pattern:e.pattern,uppercase:e.uppercase}),Ge(e)&&o.jsx(gt,{id:e.name,name:e.name,autoFocusOnFirstRender:r,required:e.required,defaultValue:n??e.defaultValue})]})})}),bt="_FieldList_10uw8_1",ht={FieldList:bt},St=c.memo(function({formFields:e,item:n}){const r=c.useMemo(()=>e.filter(Ve),[e]),s=c.useMemo(()=>e.filter(ze),[e]);return o.jsxs("div",{className:ht.FieldList,children:[r.map(a=>{const i=n==null?void 0:n[a.name];return o.jsx("input",{type:"hidden",id:a.name,name:a.name,required:a.required,defaultValue:i??a.defaultValue},a.name)}),s.map((a,i)=>{const u=n==null?void 0:n[a.name],l=i===0;return o.jsx(pt,{field:a,autoFocusOnFirstRender:l,fieldValue:u},a.name)})]})}),Lt=(t,e,n)=>{c.useEffect(function(){const s=t.current;if(!s)return;function a(){const i=t.current;i&&(e.forEach(({name:u,defaultValue:l})=>{const d=i.querySelector(`[name="${u}"]`);d&&(d.value=l||"")}),typeof n=="function"&&n())}return s.addEventListener("reset",a),function(){s.removeEventListener("reset",a)}},[e,t,n])},Nt=({formRef:t,onSubmit:e,formFields:n,validateFormData:r,showErrorWhenAllVisibleFieldsEmpty:s=!1})=>{const[a,i]=c.useState(),u=c.useCallback(async function(d){d==null||d.preventDefault();const m=t.current;if(!m)return;const f=Object.fromEntries(new FormData(m).entries()),g={};for(const b of n){const{name:h,type:F,valueType:S}=b;try{if(F===void 0||F==="text"||F==="multiline-text"||F==="hidden"||F==="select"||F==="checkbox-group"){const x=f[h];if(!x)continue;g[h]=x.trim()}else if(F==="number"){const x=f[h];if(!x)continue;let y;if(S==="float"?y=Number.parseFloat(x):y=Number.parseInt(x),!Number.isFinite(y)){console.error("Error. Field value type should be a number");continue}g[h]=y}else if(F==="file"){const x=f[h];if(!x)continue;const y=x;if(y instanceof File&&y.size===0)continue;g[h]=y}}catch(x){console.error("form field gathering data error",x);continue}}if(s){const b=[];if(n.forEach(({name:h,type:F})=>{F!=="hidden"&&g[h]&&b.push(h)}),!b.length){i(()=>o.jsx(o.Fragment,{children:"Please fill any field"}));return}}if(typeof r=="function"){const b=r(g);if(i(b),b)return}const p=await e(g);if(p){i(p);return}m.reset()},[t,n,s,r,e]);return c.useEffect(function(){const d=t.current;if(!d)return;const m=()=>{i(void 0)};return d.addEventListener("reset",m),function(){d.removeEventListener("reset",m)}},[t]),{handleSubmit:u,formValidationErrorMessage:a}},Ft="_ActionButtons_1xu73_1",xt={ActionButtons:Ft},wt=c.memo(function({title:e="are you want to proceed?",onHide:n,hideButtonLabel:r="cancel",onConfirm:s,confirmButtonLabel:a="confirm"}){const i=c.useCallback(()=>{typeof n=="function"&&n()},[n]),u=c.useCallback(async function(){typeof s!="function"||await s()||i()},[s,i]),l=C({autoFocus:!0});return o.jsx(we,{title:e,onHide:i,noCloseButton:!0,isTitleCentered:!0,children:o.jsxs("div",{className:xt.ActionButtons,children:[o.jsx(M,{onClick:i,ref:l,children:r}),typeof s=="function"&&o.jsx(M,{primary:!0,onClick:u,children:a})]})})}),R=t=>Symbol.iterator in t,V=t=>"entries"in t,z=(t,e)=>{const n=t instanceof Map?t:new Map(t.entries()),r=e instanceof Map?e:new Map(e.entries());if(n.size!==r.size)return!1;for(const[s,a]of n)if(!Object.is(a,r.get(s)))return!1;return!0},yt=(t,e)=>{const n=t[Symbol.iterator](),r=e[Symbol.iterator]();let s=n.next(),a=r.next();for(;!s.done&&!a.done;){if(!Object.is(s.value,a.value))return!1;s=n.next(),a=r.next()}return!!s.done&&!!a.done};function Et(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null||Object.getPrototypeOf(t)!==Object.getPrototypeOf(e)?!1:R(t)&&R(e)?V(t)&&V(e)?z(t,e):yt(t,e):z({entries:()=>Object.entries(t)},{entries:()=>Object.entries(e)})}function Mt(t){const e=X.useRef(void 0);return n=>{const r=t(n);return Et(e.current,r)?e.current:e.current=r}}export{H as A,ue as C,St as F,we as M,Nt as a,wt as b,It as c,Mt as d,pt as e,Be as f,Le as g,re as h,Lt as u};
