import{p as o,a as s,s as vt}from"./chunk-NL6KNZEE-BTkWJe7M.js";import{i as F,N as Be,S as De,c as Mt,a as Ct,d as Ne,y as Y,h as fe,j as Se,k as be,z as pe,A as ve,B as Me,C as Ce,E as Ie,F as Te,l as It,u as ke,G as He,H as _e,T as Ye,b as We,I as Tt,o as Lt}from"./useTableSearch-B_PAahYU.js";import{c as Ft}from"./createPageTitleWithAppName-CJkNTaXl.js";import{M as At}from"./Main-CgXj-WVg.js";import{b as Ke,d as Ge,c as Nt}from"./shallow-CPQYnUdO.js";import{n as T,y as B,H as D,p as Z,q as ee,al as C,am as W,B as R,an as _t,ao as x,ap as jt,G as Ut,aq as Pt,ar as Ot,as as xt,V as Vt,W as Rt,o as wt,at as Bt}from"./useLoadingPersistStorages-B-TGxPUM.js";import{u as te,h as $e,g as J,a as qe,M as ze,b as Dt,c as kt,d as Xe,e as Je,f as Qe,T as Ht}from"./hasUuid-DmTzcSBx.js";import{b as Ze,p as q,d as et,L as tt,M as Yt,u as Q,f as je,a as nt}from"./getUrlToMapPageWithParams-pWJMDKLd.js";import{S as ot}from"./SearchFormAndTableContainer-DLdA1ywV.js";import{M as Wt,E as it,a as Kt}from"./MovingEntity-BJWVN4xB.js";import{s as ce,F as de}from"./sortItemsByLocationFullNameForOrder-DtXWy21E.js";import{S as K}from"./StaticLink-BbBTYWDN.js";import{I as Le,s as ue}from"./setMovingEntityOrLocationOrPlanetarySystemToUrlSearchParams-ALaqoq6z.js";import{L as at,a as st}from"./LocationOffIcon-BLDsxhkF.js";import{g as lt}from"./getUrlToMovingEntitiesPageWithParams-ChWoPbCk.js";import{D as Gt,S as $t}from"./DialogFilterForm-BwenAqfq.js";import"./middleware-XeL71aNN.js";import"./App.const-DTwjj9QA.js";import"./index-D_ImYj8K.js";const Ue="Moving objects";function qt({movingEntityName:e}){const n=[e].filter(t=>!!t);return n.length?`Search ${n.join(" ")} - ${Ue}`:`${Ue}`}const zt="_Container_1ku51_1",Xt="_MainTable_1ku51_10",Jt="_TableGroups_1ku51_16",me={Container:zt,MainTable:Xt,TableGroups:Jt};function ge({name:e,label:n,value:t}){const i=T([B,D]);if(!t)return;const l=i||!F(t)?void 0:t,a=l?Z(l):void 0;if(a)return{label:n??(e==null?void 0:e.toString()),value:a==null?void 0:a.name};const r=i||!F(t)?void 0:t,d=r?ee(r):void 0;return d?{label:n??(e==null?void 0:e.toString()),value:d==null?void 0:d.name}:{label:n??(e==null?void 0:e.toString()),value:"(location type without name)"}}function Qt({name:e,label:n,value:t}){var a;const i=T([C]);if(!t)return;const l=i||!F(t)||(a=W(t))==null?void 0:a.name;return l?{label:n??(e==null?void 0:e.toString()),value:l}:{label:n??(e==null?void 0:e.toString()),value:"(moving object class without name)"}}function Zt(){return[{name:"movingEntityClassUuid",label:"class",formatLabelAndValue:Qt},{name:"locationUuid",label:"type",formatLabelAndValue:ge},{name:"homeLocationUuid",label:"type",formatLabelAndValue:ge},{name:"destinationLocationUuid",label:"type",formatLabelAndValue:ge}]}function en({value:e,item:n}){const t=T([B,D]),i=t||!F(e)?void 0:Z(e);let l=t||!F(i==null?void 0:i.planetarySystemUuid)||i==null?void 0:i.planetarySystemUuid;!l&&F(e)&&(l=e);const a=l?ee(l):void 0,r=Ze({locationId:i==null?void 0:i.id,locationName:i==null?void 0:i.name,planetarySystemName:a==null?void 0:a.name});let d;i?d=q(i==null?void 0:i.position):d=q(n.position);const u=d&&a&&et({locationId:i==null?void 0:i.id,locationName:i==null?void 0:i.name,planetarySystemName:a==null?void 0:a.name,position:i?void 0:n.position});return o.jsxs(o.Fragment,{children:[r?o.jsx(K,{href:r,title:"show location info",children:o.jsx(Le,{})}):o.jsx(R,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no location data",children:o.jsx(at,{})}),u?o.jsx(K,{href:u,title:`show ${i?"location":"position"} on map`,children:o.jsx(tt,{})}):o.jsx(R,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no position data",children:o.jsx(st,{})})]})}function Pe({value:e}){const n=T([B,D]),t=n||!F(e)?void 0:Z(e);let i=n||!F(t==null?void 0:t.planetarySystemUuid)||t==null?void 0:t.planetarySystemUuid;i||(i=n||!F(e)?void 0:e);const l=i?ee(i):void 0,a=Ze({locationId:t==null?void 0:t.id,locationName:t==null?void 0:t.name,planetarySystemName:l==null?void 0:l.name}),d=(t?q(t.position):void 0)&&l&&et({locationId:t==null?void 0:t.id,locationName:t==null?void 0:t.name,planetarySystemName:l==null?void 0:l.name,mapMode:!(t!=null&&t.id)&&!(t!=null&&t.name)?Yt:void 0});return o.jsxs(o.Fragment,{children:[a?o.jsx(K,{href:a,title:"show location info",children:o.jsx(Le,{})}):o.jsx(R,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no location data",children:o.jsx(at,{})}),d?o.jsx(K,{href:d,title:"show location on map",children:o.jsx(tt,{})}):o.jsx(R,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no position data",children:o.jsx(st,{})})]})}function Oe({value:e}){return o.jsx(o.Fragment,{children:typeof e=="string"?e:o.jsx(Be,{children:"(noÂ id)"})})}function tn({value:e}){var l;const i=T([C])||!F(e)||(l=W(e))==null?void 0:l.name;return o.jsx(o.Fragment,{children:i||o.jsx(Be,{children:"(n/d)"})})}function nn({value:e}){const t=T([C])||!F(e)?void 0:W(e),i=lt({movingEntityClassName:t==null?void 0:t.name});return o.jsx(o.Fragment,{children:i?o.jsx(K,{href:i,title:"show moving object class info",children:o.jsx(Le,{})}):o.jsx(R,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no moving object class data",children:o.jsx(De,{})})})}function on(e,n){var a,r;if(_t())return 0;const i=F(e)&&((a=W(e))==null?void 0:a.name)||"",l=F(n)&&((r=W(n))==null?void 0:r.name)||"";return i.localeCompare(l)}function xe(){return[{name:"uuid",isCheckbox:!0},{name:"id",asLinkToEditItem:!0,isSortable:!0,alignLabel:"center",uppercase:!0,monospaced:!0,nowrap:!0,isSearchCaseInsensitive:!0,formatValue:Oe},{name:"originalId",label:"original id",asLinkToEditItem:!0,isSortable:!0,alignLabel:"center",uppercase:!0,monospaced:!0,nowrap:!0,isSearchCaseInsensitive:!0,formatValue:Oe},{name:"movingEntityClassUuid",label:"class",isSortable:!0,sort:"asc",alignLabel:"center",formatValue:tn,actionButtons:nn,sortFn:on},{name:"name",asLinkToEditItem:!0,isSortable:!0,alignLabel:"left"},{name:"locationUuid",label:"location",alignLabel:"right",isSortable:!0,formatValue:de,actionButtons:en,sortFn:ce},{name:"destinationLocationUuid",label:"destination",alignLabel:"right",isSortable:!0,formatValue:de,actionButtons:Pe,sortFn:ce},{name:"homeLocationUuid",label:"home",alignLabel:"right",isSortable:!0,formatValue:de,actionButtons:Pe,sortFn:ce}]}function he(e,n){var a;if(!e||!n)return!1;if(e===n)return!0;const i=(a=Z(e))==null?void 0:a.planetarySystemUuid,l=i?ee(i):void 0;return l?l.uuid===n:!1}const Ee=(e,n)=>[{name:"movingEntityClassUuid",label:"class",type:"select",options:e,chooseOptionLabel:"choose a moving entity class",noOptionsLabel:"no moving entity classes available",allowToSelectNoValueOption:!0,filterPredicate:(t,i)=>t.movingEntityClassUuid===i.movingEntityClassUuid},{name:"locationUuid",label:"location",type:"select",options:n,chooseOptionLabel:"choose a location",noOptionsLabel:"no location available",allowToSelectNoValueOption:!0,filterPredicate:(t,i)=>he(t.locationUuid,i.locationUuid)},{name:"destinationLocationUuid",label:"destination",type:"select",options:n,chooseOptionLabel:"choose a location",noOptionsLabel:"no location available",allowToSelectNoValueOption:!0,filterPredicate:(t,i)=>he(t.destinationLocationUuid,i.destinationLocationUuid)},{name:"homeLocationUuid",label:"home",type:"select",options:n,chooseOptionLabel:"choose a location",noOptionsLabel:"no location available",allowToSelectNoValueOption:!0,filterPredicate:(t,i)=>he(t.homeLocationUuid,i.homeLocationUuid)}],an=s.memo(function({itemToDelete:n,onHideModal:t,onHideParentModal:i}){const a=T([x]),r=x(c=>c.delete),d=s.useCallback(function(){t()},[t]),u=s.useCallback(function(){i()},[i]),h=s.useCallback(function(){a||(r(n),d(),u())},[n,d,u,r,a]),m=s.useMemo(function(){return o.jsxs(o.Fragment,{children:["Are you sure you want"," ",o.jsx("strong",{children:"to delete"})," ","the moving object named",o.jsx("br",{}),o.jsxs("strong",{children:[n.id?`${n.id} `:"",n.name]}),"?"]})},[n]);return o.jsx(Ke,{title:m,onHide:d,onConfirm:h,confirmButtonLabel:"delete moving object"})}),w=Mt();function rt(){const{isHydrating:e,isHydrated:n}=C.getState();if(e||!n)return;const t=jt();sn({movingEntitiesMap:t})}w.setState({prepareData:rt});C.subscribe(function(){rt()});function sn({movingEntitiesMap:e}){const n=w.getState();n.isProcessing||(n.setIsProcessing(!0),window.setTimeout(function(){const l=cn({movingEntitiesMap:e});n.replaceAll(l),n.setIsProcessing(!1)},0))}function ln(e,n=!1){const t=(e==null?void 0:e.name)??"(moving object class without name)",i=n?Ct(t,"entity class"):t;return{name:t,nameAsLabel:i}}function rn({movingEntitiesMap:e,shouldAddSuffixLabel:n=!1}){const t=[];return Ut(e).forEach(function(a){const r=a.uuid,{name:d,nameAsLabel:u}=ln(a,n);t.push({uuid:r,name:d,label:u})}),t}function ct(e){e.sort((n,t)=>n.name.localeCompare(t.name)),e.forEach(({items:n})=>ct(n??[]))}function dt({items:e=[],level:n=0,disableOptionsWithoutUuid:t=!0,selectOptions:i=new Array}){return e.forEach(l=>{const{label:a,items:r}=l,d=l.uuid,u=d??"";i.push({value:u,label:a,level:n,disabled:t?!d:!1}),r!=null&&r.length&&dt({items:r,level:n+1,disableOptionsWithoutUuid:t,selectOptions:i})}),i}function cn({movingEntitiesMap:e,disableOptionsWithoutUuid:n}){const t=rn({movingEntitiesMap:e,shouldAddSuffixLabel:!1});return ct(t),dt({items:t,disableOptionsWithoutUuid:n})??[]}function Ve({movingEntityClassesAsSelectOptions:e,locationsAsSelectOptions:n}){return[{name:"uuid",type:"hidden"},{name:"entityType",type:"hidden"},{name:"id",uppercase:!0},{name:"originalId",label:"original Id",uppercase:!0},{name:"movingEntityClassUuid",label:"class",type:"select",options:e,chooseOptionLabel:"choose a moving object class",noOptionsLabel:"no moving object classes available",allowToSelectNoValueOption:!0},{name:"name",required:!0},{name:"position"},{name:"locationUuid",label:"current location",type:"select",options:n,chooseOptionLabel:"choose a location",noOptionsLabel:"no locations available",allowToSelectNoValueOption:!0},{name:"destinationLocationUuid",label:"destination",type:"select",options:n,chooseOptionLabel:"choose a location",noOptionsLabel:"no locations available",allowToSelectNoValueOption:!0},{name:"homeLocationUuid",label:"home location",type:"select",options:n,chooseOptionLabel:"choose a location",noOptionsLabel:"no locations available",allowToSelectNoValueOption:!0},{name:"cargo",label:"cargo / freight bay"},{name:"combatShield",label:"shield"},{name:"combatLaser",label:"laser"},{name:"combatMissiles",label:"missiles",type:"number",valueType:"integer",pattern:"[0-9]+",min:0,max:Number.MAX_SAFE_INTEGER,step:"1"},{name:"note",type:"multiline-text"}]}const dn=s.memo(function({itemToEdit:n,filterValue:t,onHideModal:i,onShowDeleteItemConfirmation:l,onCreateItem:a,onUpdateItem:r}){const d=T([x,C,B,D]),u=te([w,Q]),h=d||u,m=x(y=>y.create),c=x(y=>y.update),E=s.useCallback(y=>{const v=m(y);typeof a=="function"&&a(v)},[m,a]),p=s.useCallback(y=>{const v=c(y);v&&typeof r=="function"&&r(v)},[c,r]),b=s.useCallback(()=>{i()},[i]),M=s.useCallback(y=>{var v,N,U,V;if($e(y)){const S=J(y,Kt);S.id=(U=S.id)==null?void 0:U.toLocaleUpperCase(),S.originalId=(V=S.originalId)==null?void 0:V.toLocaleUpperCase();const j=q(S.position);j&&(S.position=je(j)),p(S)}else{const S=J(y,Wt);S.entityType=it,S.id=(v=S.id)==null?void 0:v.toLocaleUpperCase(),S.originalId=(N=S.originalId)==null?void 0:N.toLocaleUpperCase();const j=q(S.position);j&&(S.position=je(j)),E(S)}b()},[E,p,b]),I=s.useCallback(y=>{if(h)return function(){return o.jsx("span",{children:"Loading..."})};const v=Pt(y);if(v)return function(){return o.jsxs(o.Fragment,{children:["Moving object with Id:"," ",o.jsx("strong",{children:v?v.id:"(no-id)"})," ","already exists"]})};const N=Ot(y);if(N)return function(){return o.jsxs(o.Fragment,{children:["Moving object with Original Id:"," ",o.jsx("strong",{children:N?N.originalId:"(no-original-id)"})," ","already exists"]})}},[h]),L=w(y=>y.items),g=Q(y=>y.items),f=s.useMemo(function(){return Ve(h?{locationsAsSelectOptions:[],movingEntityClassesAsSelectOptions:[]}:{locationsAsSelectOptions:g,movingEntityClassesAsSelectOptions:L})},[L,g,h]),_=qe(f,t);return o.jsx(ze,{humanizedItemTypeName:"moving object",itemToEdit:n,formFields:_,validateFormData:I,onCancel:b,onSubmit:M,onDelete:l,deleteItemButtonLabel:"delete moving object"})}),un=s.memo(function({filterValue:n,onSetFilterValue:t,onHide:i}){const l=T([C,B,D]),a=te([w,Q]),r=l||a,d=Q(E=>E.items),u=w(E=>E.items),h=s.useMemo(function(){return r?Ee([],[]):Ee(u,d)},[u,d,r]),m=s.useCallback(function(){i()},[i]),c=s.useCallback(function(p){Object.keys(p).length?t(p):t(void 0),m()},[m,t]);return o.jsx(o.Fragment,{children:o.jsx("div",{style:{position:"absolute",top:0,right:0},children:o.jsx(Gt,{humanizedPluralItemTypeName:"moving objects",filterValue:n,formFields:h,onCancel:m,onFilter:c})})})}),mn="_Container_16hmi_1",gn="_SearchAndFilterFormContainer_16hmi_9",Re={Container:mn,SearchAndFilterFormContainer:gn},hn=[Y,fe,Se,be,pe,ve,Me,Ce,Ie,Te];function we(e){const n={className:e.get(Y)||void 0,locationId:e.get(fe)||void 0,locationName:e.get(Se)||void 0,planetarySystemName:e.get(be)||void 0,destinationLocationId:e.get(pe)||void 0,destinationLocationName:e.get(ve)||void 0,destinationPlanetarySystemName:e.get(Me)||void 0,homeLocationId:e.get(Ce)||void 0,homeLocationName:e.get(Ie)||void 0,homePlanetarySystemName:e.get(Te)||void 0};return It(n)}function ye(e,n,t){var l,a;let i;return e||n?i=(l=Vt({id:e,name:n,planetarySystemName:t}))==null?void 0:l.uuid:t&&(i=(a=Rt(t))==null?void 0:a.uuid),i}function yn({filterValue:e}){var I;if(!e)return;const{className:n,locationId:t,locationName:i,planetarySystemName:l,destinationLocationId:a,destinationLocationName:r,destinationPlanetarySystemName:d,homeLocationId:u,homeLocationName:h,homePlanetarySystemName:m,...c}=e,E=n?(I=xt(n))==null?void 0:I.uuid:void 0,p=ye(t,i,l),b=ye(a,r,d),M=ye(u,h,m);return{...c,movingEntityClassUuid:E,locationUuid:p,destinationLocationUuid:b,homeLocationUuid:M}}function En({urlSearchParams:e,setUrlSearchParams:n}){const t=T([C,B,D]),i=te([w,nt]),l=t||i,a=s.useRef(void 0),r=s.useMemo(function(){const h=we(e),m=yn({filterValue:h}),c=a.current;return Ne(c,m)?(a.current=m,m):c},[e,a,l]),d=s.useCallback(function(h){let m;if(typeof h=="function")throw new Error("MovingEntityFilterValue as setState(prev=>newState) function not supported");h&&Object.keys(h).length>0&&(m=h),n(c=>{var b;const E=we(c);if(Ne(E,m)){if(!m)return hn.forEach(_=>{c.delete(_)}),c;const M=m.movingEntityClassUuid,I=M?(b=W(M))==null?void 0:b.name:void 0;I?c.set(Y,I):c.delete(Y);const L=m.locationUuid;ue({urlSearchParams:c,locationUuid:L,planetarySystemUuid:L,locationIdUrlSearchParamsKeyName:fe,locationNameUrlSearchParamsKeyName:Se,planetarySystemNameUrlSearchParamsKeyName:be});const g=m.destinationLocationUuid;ue({urlSearchParams:c,locationUuid:g,planetarySystemUuid:g,locationIdUrlSearchParamsKeyName:pe,locationNameUrlSearchParamsKeyName:ve,planetarySystemNameUrlSearchParamsKeyName:Me});const f=m.homeLocationUuid;ue({urlSearchParams:c,locationUuid:f,planetarySystemUuid:f,locationIdUrlSearchParamsKeyName:Ce,locationNameUrlSearchParamsKeyName:Ie,planetarySystemNameUrlSearchParamsKeyName:Te})}return c})},[n]);return{filterValue:r,setFilterValueToUrlSearchParams:d}}function fn({urlSearchParams:e,setUrlSearchParams:n}){return ke({urlSearchParams:e,setUrlSearchParams:n,getSearchValueFromUrlSearchParams:He,searchValueKeyInUrlSearchParams:_e,searchFieldNameInSearchForm:_e,searchFieldPlaceholderTextInSearchForm:"Search by moving object name, id, originalId..."})}const Sn=["name","id","originalId","movingEntityClassUuid","locationUuid","homeLocationUuid","destinationLocationUuid","combatShield","combatLaser","combatMissiles"],bn=["name","id","originalId"],pn=s.memo(function({urlSearchParams:n,setUrlSearchParams:t}){const i=T([x,C,D,B]),l=te([nt]),a=i||l,{filterValue:r,setFilterValueToUrlSearchParams:d}=En({urlSearchParams:n,setUrlSearchParams:t}),{searchFieldValue:u,SearchForm:h,resetSearchFieldValue:m}=fn({urlSearchParams:n,setUrlSearchParams:t}),c=x(Ge(A=>A.items())),E=x(A=>A.deleteMultiple),[p,b]=s.useState(!1),[M,I]=s.useState(),[L,g]=s.useState(),f=s.useCallback(()=>{b(!0)},[b]),_=s.useCallback(()=>{I(void 0),b(!1)},[I,b]),y=s.useCallback(A=>{g(A)},[g]),v=s.useCallback(()=>{g(void 0)},[g]),N=s.useMemo(function(){return xe().filter(le=>bn.includes(le.name))},[]),U=s.useMemo(function(){return u?c.filter(le=>!!N.find(Ae=>{const H=le[Ae.name];if(Ae.isSearchCaseInsensitive){const re=H==null?void 0:H.toLocaleLowerCase();return re==null?void 0:re.includes(u.toLocaleLowerCase())}return H==null?void 0:H.includes(u)})):c},[u,c,N]),V=s.useMemo(function(){return Ee([],[])},[a]),S=s.useMemo(function(){return Zt()},[a]),{isAppliedFilter:j,enableFilter:ne,disableFilter:oe}=Dt(r),ie=kt(U,V,j?r:void 0),G=s.useMemo(function(){return xe()},[a]),{sortedItems:k,columnsToSortBy:ae,handleColumnSortClick:P}=Xe(ie,G,Sn),{selectedItemsUuids:z,handleResetSelectedItems:Fe,handleSelectAllItems:X,handleSelectItem:O,handleShowDeleteMultipleSelectedItemsConfirmation:$,DeleteSelectedItemsConfirmation:ht}=Je({itemTypeNamePlural:"moving objects",items:k,searchFieldValue:u,filterValue:r,deleteItemsByUuids:E,setItemToDelete:g}),yt=s.useCallback(function(){d(void 0)},[d]),{lastCreatedOrUpdatedItem:Et,onCreateItem:ft,onUpdateItem:St}=Qe({itemEntityType:it,items:k,searchFieldValue:u,filterValue:r,resetSearchFieldValue:m,resetFilterValue:yt}),{isVisible:bt,show:pt,hide:se}=Nt(!1);return s.useEffect(function(){(r||!r)&&se()},[r,se]),o.jsxs(ot,{children:[o.jsxs("div",{className:Re.SearchAndFilterFormContainer,children:[h,o.jsxs(R,{onClick:pt,title:"show filter form",children:[o.jsx(Ht,{}),o.jsx("span",{children:"filter"})]}),bt&&o.jsx(un,{filterValue:r,onSetFilterValue:d,onHide:se})]}),o.jsx("div",{className:Re.Container,children:o.jsx(Ye,{tableTitle:"moving objects",tableColumns:G,items:k,noItemsLabel:"no moving objects",isLoading:a,showCreateItemModalButtonLabel:"add moving object",onShowCreateItemModal:f,columnsToSortBy:ae,onColumnHeaderClick:P,selectedItemsUuids:z,onResetSelectedItems:Fe,onSelectAllItems:X,onDeleteSelectedItems:$,searchFieldValue:u,filterValue:r,isAppliedFilter:j,onEnableFilter:ne,onDisableFilter:oe,filterInfoFields:S,children:o.jsx(We,{items:k,columns:G,selectedItemsUuids:z,onEditItem:I,onSelectItem:O,lastCreatedOrUpdatedItem:Et})})}),(p||!!M)&&o.jsx(dn,{itemToEdit:M,filterValue:r,onHideModal:_,onShowDeleteItemConfirmation:y,onCreateItem:ft,onUpdateItem:St}),!!L&&o.jsx(an,{onHideModal:v,onHideParentModal:_,itemToDelete:L}),o.jsx(ht,{})]})}),ut="moving-entity-class",mt=["uuid","entityType","name","note","image"],vn=wt(mt);function gt(){return[{name:"uuid",isCheckbox:!0},{name:"name",asLinkToEditItem:!0,isSortable:!0,sort:"asc",alignLabel:"left",actionButtons:function({item:n}){const t=lt({movingEntityClassName:n==null?void 0:n.name});return o.jsx(o.Fragment,{children:t?o.jsx(K,{href:t,title:"search by moving entity class in moving entities",children:o.jsx($t,{})}):o.jsx(R,{disabled:!0,noBorder:!0,noPadding:!0,transparent:!0,title:"no data for search",children:o.jsx(De,{})})})}},{name:"note",asLinkToEditItem:!0,isSortable:!0,alignLabel:"left"}]}const Mn=s.memo(function({itemToDelete:n,onHideModal:t,onHideParentModal:i}){const a=T([C]),r=C(c=>c.delete),d=s.useCallback(function(){t()},[t]),u=s.useCallback(function(){i()},[i]),h=s.useCallback(function(){a||(r(n),d(),u())},[n,d,u,r,a]),m=s.useMemo(function(){return o.jsxs(o.Fragment,{children:["Are you sure you want"," ",o.jsx("strong",{children:"to delete"})," ","the moving object class named",o.jsx("br",{}),o.jsx("strong",{children:n.name}),"?"]})},[n]);return o.jsx(Ke,{title:m,onHide:d,onConfirm:h,confirmButtonLabel:"delete moving object class"})});function Cn(){return[{name:"uuid",type:"hidden"},{name:"entityType",type:"hidden"},{name:"name",required:!0},{name:"note"},{name:"image",type:"file",accept:"image/*"}]}const In=s.memo(function({itemToEdit:n,filterValue:t,onHideModal:i,onShowDeleteItemConfirmation:l,onCreateItem:a,onUpdateItem:r}){const u=T([C]),h=C(g=>g.create),m=C(g=>g.update),c=s.useCallback(g=>{const f=h(g);typeof a=="function"&&a(f)},[h,a]),E=s.useCallback(g=>{const f=m(g);f&&typeof r=="function"&&r(f)},[m,r]),p=s.useCallback(()=>{i()},[i]),b=s.useCallback(g=>{if($e(g)){const f=J(g,mt);E(f)}else{const f=J(g,vn);f.entityType=ut,c(f)}p()},[c,E,p]),M=s.useCallback(g=>{if(u)return function(){return o.jsx("span",{children:"Loading..."})};const f=Bt(g);if(f)return function(){return o.jsxs(o.Fragment,{children:["Moving object class named"," ",o.jsx("strong",{children:f?f.name:"(moving object class without name)"})," ","already exists"]})}},[u]),I=s.useMemo(function(){return Cn()},[]),L=qe(I,t);return o.jsx(ze,{humanizedItemTypeName:"moving object class",itemToEdit:n,formFields:L,validateFormData:M,onCancel:p,onSubmit:b,onDelete:l,deleteItemButtonLabel:"delete moving object class"})});function Tn({urlSearchParams:e,setUrlSearchParams:n}){return ke({urlSearchParams:e,setUrlSearchParams:n,getSearchValueFromUrlSearchParams:Tt,searchValueKeyInUrlSearchParams:Y,searchFieldNameInSearchForm:Y,searchFieldPlaceholderTextInSearchForm:"Search by moving object class..."})}const Ln=["name"],Fn=["name"],An=gt().filter(e=>Fn.includes(e.name)),Nn=s.memo(function({urlSearchParams:n,setUrlSearchParams:t}){const l=T([C]),{searchFieldValue:a,SearchForm:r,resetSearchFieldValue:d}=Tn({urlSearchParams:n,setUrlSearchParams:t}),u=C(Ge(P=>P.items())),h=C(P=>P.deleteMultiple),[m,c]=s.useState(!1),[E,p]=s.useState(),[b,M]=s.useState(),I=s.useCallback(()=>{c(!0)},[c]),L=s.useCallback(()=>{p(void 0),c(!1)},[p,c]),g=s.useCallback(P=>{M(P)},[M]),f=s.useCallback(()=>{M(void 0)},[M]),_=s.useMemo(function(){return a?u.filter(z=>!!An.find(X=>{const O=z[X.name];if(X.isSearchCaseInsensitive){const $=O==null?void 0:O.toLocaleLowerCase();return $==null?void 0:$.includes(a.toLocaleLowerCase())}return O==null?void 0:O.includes(a)})):u},[a,u]),y=s.useMemo(function(){return gt()},[l]),{sortedItems:v,columnsToSortBy:N,handleColumnSortClick:U}=Xe(_,y,Ln),{selectedItemsUuids:V,handleResetSelectedItems:S,handleSelectAllItems:j,handleSelectItem:ne,handleShowDeleteMultipleSelectedItemsConfirmation:oe,DeleteSelectedItemsConfirmation:ie}=Je({itemTypeNamePlural:"moving object classes",items:v,searchFieldValue:a,deleteItemsByUuids:h,setItemToDelete:M}),{lastCreatedOrUpdatedItem:G,onCreateItem:k,onUpdateItem:ae}=Qe({itemEntityType:ut,items:v,searchFieldValue:a,resetSearchFieldValue:d});return o.jsxs(ot,{children:[r,o.jsx(Ye,{tableTitle:"moving object classes",tableColumns:y,items:v,noItemsLabel:"no moving object classes",isLoading:l,showCreateItemModalButtonLabel:"add moving object class",onShowCreateItemModal:I,columnsToSortBy:N,onColumnHeaderClick:U,selectedItemsUuids:V,onResetSelectedItems:S,onSelectAllItems:j,onDeleteSelectedItems:oe,searchFieldValue:a,children:o.jsx(We,{items:v,columns:y,selectedItemsUuids:V,onEditItem:p,onSelectItem:ne,lastCreatedOrUpdatedItem:G})}),(m||!!E)&&o.jsx(In,{itemToEdit:E,onHideModal:L,onShowDeleteItemConfirmation:g,onCreateItem:k,onUpdateItem:ae}),!!b&&o.jsx(Mn,{onHideModal:f,onHideParentModal:L,itemToDelete:b}),o.jsx(ie,{})]})});function _n(e){const n=s.useMemo(()=>He(e),[e]);return s.useMemo(function(){return Ft(qt({movingEntityName:n}))},[n])}function jn(){const{urlSearchParams:e,setUrlSearchParams:n}=Lt(),t=_n(e);return o.jsxs(o.Fragment,{children:[o.jsx("title",{children:t}),o.jsx(At,{children:o.jsxs("div",{className:me.Container,children:[o.jsx("div",{className:me.MainTable,children:o.jsx(pn,{urlSearchParams:e,setUrlSearchParams:n})}),o.jsx("div",{className:me.TableGroups,children:o.jsx(Nn,{urlSearchParams:e,setUrlSearchParams:n})})]})})]})}const Qn=vt(function(){return o.jsx(jn,{})});export{Qn as default};
