import{q as O}from"./chunk-NL6KNZEE-Dk3Cym_s.js";const _=e=>{let s;const t=new Set,o=(i,h)=>{const v=typeof i=="function"?i(s):i;if(!Object.is(v,s)){const g=s;s=h??(typeof v!="object"||v===null)?v:Object.assign({},s,v),t.forEach(m=>m(s,g))}},a=()=>s,u={setState:o,getState:a,getInitialState:()=>d,subscribe:i=>(t.add(i),()=>t.delete(i))},d=s=e(o,a,u);return u},R=e=>e?_(e):_,w=e=>e;function E(e,s=w){const t=O.useSyncExternalStore(e.subscribe,()=>s(e.getState()),()=>s(e.getInitialState()));return O.useDebugValue(t),t}const j=e=>{const s=R(e),t=o=>E(s,o);return Object.assign(t,s),t},N=e=>e?j(e):j;function P(e,s){return(...t)=>Object.assign({},e,s(...t))}function x(e,s){let t;try{t=e()}catch{return}return{getItem:a=>{var r;const f=d=>d===null?null:JSON.parse(d,void 0),u=(r=t.getItem(a))!=null?r:null;return u instanceof Promise?u.then(f):f(u)},setItem:(a,r)=>t.setItem(a,JSON.stringify(r,void 0)),removeItem:a=>t.removeItem(a)}}const p=e=>s=>{try{const t=e(s);return t instanceof Promise?t:{then(o){return p(o)(t)},catch(o){return this}}}catch(t){return{then(o){return this},catch(o){return p(o)(t)}}}},F=(e,s)=>(t,o,a)=>{let r={storage:x(()=>localStorage),partialize:n=>n,version:0,merge:(n,S)=>({...S,...n}),...s},f=!1;const u=new Set,d=new Set;let i=r.storage;if(!i)return e((...n)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),t(...n)},o,a);const h=()=>{const n=r.partialize({...o()});return i.setItem(r.name,{state:n,version:r.version})},v=a.setState;a.setState=(n,S)=>{v(n,S),h()};const g=e((...n)=>{t(...n),h()},o,a);a.getInitialState=()=>g;let m;const I=()=>{var n,S;if(!i)return;f=!1,u.forEach(c=>{var l;return c((l=o())!=null?l:g)});const y=((S=r.onRehydrateStorage)==null?void 0:S.call(r,(n=o())!=null?n:g))||void 0;return p(i.getItem.bind(i))(r.name).then(c=>{if(c)if(typeof c.version=="number"&&c.version!==r.version){if(r.migrate){const l=r.migrate(c.state,c.version);return l instanceof Promise?l.then(b=>[!0,b]):[!0,l]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,c.state];return[!1,void 0]}).then(c=>{var l;const[b,H]=c;if(m=r.merge(H,(l=o())!=null?l:g),t(m,!0),b)return h()}).then(()=>{y==null||y(m,void 0),m=o(),f=!0,d.forEach(c=>c(m))}).catch(c=>{y==null||y(void 0,c)})};return a.persist={setOptions:n=>{r={...r,...n},n.storage&&(i=n.storage)},clearStorage:()=>{i==null||i.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>I(),hasHydrated:()=>f,onHydrate:n=>(u.add(n),()=>{u.delete(n)}),onFinishHydration:n=>(d.add(n),()=>{d.delete(n)})},r.skipHydration||I(),m||g},k=F;export{P as a,N as c,k as p};
